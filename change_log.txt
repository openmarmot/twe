TWE Project : Change Log

----------------------------------
July 25 2025
- added top and bottom to new penetration calculation 

some good playtesting of the new armor angle calculations. 
the poor initial detection of what side is hit is becoming a bit of an issue. 

seeing some non-pens due to high angle shots, which is great and was the main point of this upgrade 

todo 
- add passenger compartment armor to vehicle diagnostics 

----------------------------------
July 24 2025
- work on adding horizontal angle between armor and projectile to penetration calculation 

these changes have resulted in the t34-85 turret bouncing rounds on a regular basis 

todo 
- change human armor to have values for each side 
- change human penetration to use hit side calculation 
- add more data to the hit_data 
- reformat vehicle diagnostics ui for hits 

----------------------------------
July 23 2025
- added projectile penetration and calculated armor value to hit data 

troubleshooting HEAT not penetrating when i think it should, it turns out 
80 pen is not enough for the t34 sloped surfaces with calculate out to about 90 armor value.

will have to think about this. maybe it is fine 

----------------------------------
July 22 2025
- added universal switch role code for empty driver and gunner spots 
- misc cleanup and minor updates
- increased the ranged damage on the 37mm AT round a bit 

for the first time ever I saw the soviet 37mm AA gun actually engaging something. 
It took out a sd.kfz.251 by piercing the turret. It was bouncing off the main body due to 
the range. I bumped the range penetration up a bit so it should have less trouble in the future 

i'd like to see more hummel action. it is very outclassed by tanks - mostly because it starts 
with a HE round loaded so it has to reload before it can shoot. Also the base HEAT shell it gets 
isn't really that great. 

I think one of the next things to be added will be a indirect fire weapon.
probably a sd.kfz.251 with a mortar. 

----------------------------------
July 19 2025
- fixed fire grenades no longer damaging humans that aren't in vehicles 
- added new vehicle on fire mechanic 
- updated how fires are created 
- fixed power scaling error in explosion damage 

vehicles can now light on fire, although its not super common. 
a fuel_leak makes it more likely 

todo 
- most crew positions need to check for gunner/driver kills and re-crew intelligently 

----------------------------------
July 17 2025
- added fuel tank hit as a vehicle damage option 
- vehicles also get a fuel_leak flag 

lack of fuel will eventually shut down an engine but that 
will not trigger the disabled flag, so more logic will probably 
be needed so the AI understands how to handle out of fuel conditions.
this logic was needed anyways..

todo 
- add out of fuel logic 
- add explosion triggered by a vehicle hit that has a fuel_leak 
- add vehicle fire mechanic 

----------------------------------
July 15 2025
- minor adjustments to vehicle damage 

my plan was to add % chance but it didn't work out that 
way because the possible things hit are all dynamic based 
on a bunch of criteria 

need to add more damage types 
- electrical ?
- vehicle frame damage 
- fuel leaks 
- fuel fire 

need to add stuff like what happens if something that is already 
damaged gets hit again. 

----------------------------------
July 14 2025
- HEAT projectiles only produce 1 HEAT jet now 

the HEAT change was needed because the old solution spawned 30 jets which would 
unrealistically hit different sections of the vehicle. HEAT should be a single hole.


----------------------------------
July 12 2025
- added 251/9 late (with coax mg42)

----------------------------------
July 11 2025
- split ai_human vehicle control code off into its own class 
- bug fix 
- increased stummel reload speed 

ai_human is too big for current LLMs to parse effectively. I honestly didn't 
mind myself, but seperating out the vehicle stuff might be useful. 
unfortunately ai_human is still 2700 lines by itself, and i'm not sure what 
else I would pull out.. 

did some stummel vs t34 testing and the stummel is capable of taking out 
the t34 but it is unlikely as it has to switch to HEAT first. also the 80mm pen 
HEAT does not penetrate front plates of the t34. this should be fixed 

todo 
more armor effects. spalling. etc 
- heat should be re-done to be one projectile 

----------------------------------
July 10 2025
- added soviet SN42 steel body armor 
- added new soviet assault engineer squad with the body armor, ppsh43, and AT grenades 
- upped rifle penetration at mid range a bit 
- new turret rotation code 
- new vehicle rotation code
- some updates to magic numbers for various distance checks 
- misc updates
- added morale regen
- added support for different weapon velocities - set at the ai_gun level 

the body armor was a little difficult to test because currently human hits are a random choice of several body 
regions. i need to add some probabilities to this so that a hit to the hands or feet isn't as likely as a hit to the 
upper body. 

i think the armor will be somewhat useful. it should repel 9mm and lesser calibers pretty well. 
at the edge of rifle ranges it will probably bounce rifle shells as well. this is probably a stretch - but i am ok with this.

I spent a lot of time reviewing the code with the newly released grok4. among other things 
grok pointed out some issues in the rotation code that was likely causing the odd porpoising 
behaviour that vehicle drivers sometimes exhibited. 

todo 
- maybe change velocity on some guns 
- consider splitting human vehicle code into its own class 


----------------------------------
July 8 2025
- rewrote sd.kfz.251 spawn to reduce duplicate code 
- added sd.kfz.251/9 'Stummel'
- added HEAT tank rounds for the stummel 
- minor fix and updates 
- fixed panzerschreck having wrong magazine 
- some adjustments to human accuracy 

Interesting thing about HEAT tank rounds is they need to have a penetration value on the round so 
the logic that tells the gunner if he can take the shot. however when the round hits it triggers the 
HEAT effect and its those projectiles that penetrate 

I'd like to make all the infantry guns more inaccurate. the current accuracy system is not super useful 
It needs to scale with range 


----------------------------------
July 7 2025
- misc minor updates/refactoring 
- weapons now have a hit counter 
- vehicle diagnostics now displays accuracy (hits/shots) for weapons 
- humans now display weapon accuracy in selection menu when nearby 

might enhance the aigun class to also keep track of round counts fired for various projectile types.
this will help with understanding if tanks are using HE. the overhead is relatively low 

----------------------------------
July 5 2025
- 'miraculously unharmed' damage option for passenger compartment now only possible with 0 armor (no spalling)
- extended '1' penetration of rifle rounds out one extra unit of range 
- remove the cleanup function - objects will self delete instead 
- removed all world object lists from world - these are now fully handled by grid_manager
- added some grid square functionality 
- now some static objects like terrain don't get updated. 

0 armor vehicles bounce rifle rounds towards the end of their range. probably should fix but ehh..

todo 
- need a world_object tag to tag objects that should not be saved (brass, turrets, blood, etc)

----------------------------------
July 4 2025
- adjust reload mechanism to prefer AT if there are any identified vehicle enemies 
- minor updates

----------------------------------
July 2 2025
- projectiles now have a chance to bounce/richochet off a vehicle if they do not penetrate
- added some code to force reloads when a gun has AP loaded but AT available and can't pen 
- fixed ai vehicle reloads not checking vehicle inventory

the richochet is very dangerous but does not travel far. 

todo 
- reload code needs more tuning. i think the gunners are still getting stuck on HE sometimes 

----------------------------------
July 1 2025
- moved self debug to its own file and rewrote 
- fixed a issue with items not properly being removed from grid manager. 
    this mostly effected items that get dropped from inventory 
- grenades have a chance to get stuck on/in a vehicle. they will explode on the 
top armor - which is zero for some vehicles 
- ai should be more likely to throw grenades at vehicles now 

Grenades are now VERY VERY dangerous to the german half tracks at close range. 


todo 
- open top vehicle crew should have a option to expose themselves and shoot out 
- open top vehicles should have a chance to injure crew with fire 
- debug morale check and adjust to be less likely for non-pen from shrapnel 
----------------------------------
June 30 2025
- added HE projectiles for cannons 
- added gunner logic for choosing at/ap/both when reloading
- magazines can now be labeled at at/ap/both 
- projectiles now have a use attribute at/ap/both 
- added some randomness to burst length 
- burst length only increments when the weapon fires now 
- rewrote engagement decisions for vehicle primary and coax weapons 
- fixed radio man who is also a gunner overwriting gunner actions 

labeling the magazine so that searching ammo is faster. 
doesn't really matter for cannons, but eventually machine guns will 
likely get some magazines loaded with AP 

todo 
- likely pitfall with the current code is if HE is loaded and the target has armor the gun will not be used
    correct action is to probably reload - IF there is AT ammo that can pen 
- HE damage needs a boost - probably 

----------------------------------
June 28 2025
- misc cleanup / updates / error handling 
- added new hit_data attribute : result
    for now this is the description of the damage done by the hit 
- rewrite of hit area determination code for vehicles 
    main change is turret hit is based on side hit and high/low shot now 
- added turret vehicle mount position attribute 
- fixed spelling error with min_wheels parameters 
- turret hits now have a chance to penetrate into the vehicle if the turret is not on top 
- fixed missing damage type driver_projectile
- added human morale system 
- humans now react to vehicle hits 
- now some objects only self delete when they are no longer visible (ex brass)

some turrets are now marked as 'front'. this includes hull machine guns and assault gun style turrets. 
being marked front means they will only be hit by shots that hit a front angle. the downside is penetrations can 
then enter and damage the vehicle 

top turrets can be hit from any angle, and are a bit more likely to be hit now. 

there is a general issue with this project where spelling errors on object init can cause parameters to not be set. 
i need some way to check parameters in world_builder to make sure they actually exist in the object -- or rewrite object initialization 

vehicle penetration lethality should be up. Additional error handling has helped me find a handful of bugs with it. 

vehicle hits can now result in the crew abandoning the vehicle - depending on morale checks 

civilians have lower morale, making them more likely to flee dangerous situations (when this is implemented)
luftwaffe ground crew have slightly reduced morale as they were not originally combat soldiers

todo 
- use the morale system for more things 
- more vehicle hit reactions 

----------------------------------
June 26 2025
- minor changes to turret damage 
- removed 'miraculously unharmed' option from damage choices for vehicle body and turret

i'd like damage to be less random, or at least add another layer of modeling and logic 
that happens after a penetration occurs. 

for now removing the no-damage chance from vehicle body and turret penetrations will up 
the lethality a little. I don't get the impression that ww2 tanks shrugged off multiple penetrations well.

----------------------------------
June 24 2025
- turret weapon reloads now use reload speed values from turret class 
- turret reload speeds adjusted from old weapon reload speeds. 

the SU-85 now reloads a bit faster than the T34-85, which makes sense given its 
casemate design with a lot more space than a cramped turret. This gives the su-85 some 
reason to exist / flavor. both are way better than the t34-76.

todo 
- should add more damage options from turret pen 
----------------------------------
June 21 2025
- added a turret rotation function to ai_human 
- working on vehicle HUD 

todo 
-definitely something buggy with turret rotation angles, probably around 360

----------------------------------
June 20 2025
- minor world_menu changes 
- player now faces the direction they are firing 
- if the player is a vehicle gunner, w now rotates the turret towards the mouse cursor 
- if the player is a vehicle gunner, s now fires the coax weapon if equipped 
- minor readme updates

for some reason it took me forever to implement player mouse turret tracking, but it 
ended up being pretty easy. i kept 'a' and 'd' as manual control because i still 
wanted it to feel real - but it is basically impossible for the humans to aim the 
turrets at any range because the rotation isn't fine enough and theres no aiming 
mechanism. 

todo 
- probably need a centralized turret rotation function as its now used by player and ai . 
- would like the ai to rotate the turret back to zero occasionally 

----------------------------------
June 19 2025
- minor logic fixes in ai_human 

spent some time trying to figure out why tanks seems to get stuck reloading sometimes. 
added some code to maybe fix some possible issues. not 100% sure yet what the issue is 
or if it even exists 

todo 
- turret reload speeds should be set as a turret variable to allow for more variation 
- bicycles are hilariously damage resistant. need to add some sort of structural damage. 

----------------------------------
June 18 2025
- fixed self debug code 
- added clutter generation back to quick battle 
- minor changes to mechanical accuracy for some weapons 
- turrets now have their own accuracy variable 
- added some debug checks for vehicle turret reloads failing 
- fixed bicycle driver visibility 

at some point clutter generation was removed from quick battle. this explains why 
i wasn't seeing anyone riding bicycles around 

playtest notes 
- it seems sometimes gunners get stuck reloading. unsure why 
- need more vehicle damage. sometimes vehicles can take a absurd amount of shots 

----------------------------------
June 16 2025
- some gunner ai fixes to attempt to fix issues with getting stuck engaging targets 

did some play testing. i think gunners getting stuck on engaging is fixed. however 
vehicles still probably don't move enough. most matches end up in a stalemate with nobody 
moving. 

t34-85 and t34-76 are winning some engagements now - which is good. 

self debug needs to be fixed.
----------------------------------
June 15 2025
- added the p08 luger in 9mm 
- increased 37mm AT pen a bit at range
- increased 14.mm AT pen at range a bit  

i'd like to add most of the pistols used in the war but the stats are all the same. really 
hard to differentiate. 

----------------------------------
June 11 2025
- bug fix
- work on tactical and vehicle orders 
- squad leader can now take initative and create new tactical orders 
- hit marker menu now lets you open vehicle diagnostics for the hit vehicle 

hit marker menu letting you open vehicle diagnostics is super handy. when a vehicle 
is hit its often very hard to select otherwise because there tends to be bodies and gear 
surrounding it.

play test notes 
- seems like some gunners get stuck on engaging. not sure why 
- saw a nearly full sd.kfz.251 with the driver on waiting and the gunner on 'turret jammed' 
    it was surrounded by enemy troops. that should probably trigger a bail out 

I did a bunch of test launches and the code seems fairly stable and error free. 
the battle dynamic has changed quite a bit. it is more chaotic now with a bunch 
of smaller engagements. for whatever reason there is more infantry vs infantry fights.
 definitely more fun. 

definitely some regressions - especially in exiting vehicles, but i think this is good 
enough to merge. 

----------------------------------
June 10 2025
- work on vehicle orders 

i found that vehicle destination is not really used. that is interesting. rather the best destination is 
recalculated every time the driver thinks. i wonder if this was the cause of the zig zagging.

more thought is probably needed about when it is appropriate to exit a vehicle. might be worth classifying 
vehicles (is_tank, is_transport etc)

at the moment i'm not really sure if vehicle movement is going to work. it used to work with squad 
destination, but now its really dependent on squad leads handing out vehicle orders. 

----------------------------------
June 09 2025
- working on removing destination from squad 
- task_enter_vehicle now checks if the vehicle is further away then when the task started 
- as part of removing destination from squad, it is also being removed from enter vehicle 
- vehicle_orders are now a thing 
- new simpler initial tactical orders 
- (temporary?) removal of ai_faction_tactical giving out orders on a regular interval 

note ! - dev branch will be broken for awhile again 

I wasn't sure whether tactical orders and vehicle orders needed to be seperate, but i eventually decided 
that tactical orders will only be kept in the squad leader's memory. 

In order for the vehicle use ai to work a ai must be able to set a destination when they enter a vehicle 
thus vehicle_orders were still needed as a seperate (and less complicated) thing. 

todo 
- tactical order processing by squad lead 
- what to do when no tactical orders (probably review world areas and move toward one)
- vehicle driver processing of vehicle orders 
    - if none, check if the crew have any 

----------------------------------
June 08 2025
- added walther p38 
- started work on a new tactical_order system 

hard to draw pistols in their correct scaled size. they are too small. 
i'll probably just re-use the same art for a lot of them. 

the pistols don't have a lot to differentiate each other. will have to think about that 

for now tactical orders are only going to be handled by the squad lead. they should replace 
squad.destination. in fact most of the squad stuff should go away. 

tactical orders are given via radio and/or when a unit is spawned. 

----------------------------------
June 04 2025
- bug fix 
- gunner has a new status for when the vehicle needs to rotate
- driver now checks gunner status for engagement/reloading/rotation 

the new driver code implements most of the useful stuff from the removed vehicle 
communication code. importantly vehicles stop to fire main guns and rotate as needed.

this seems good. will merge. from a gameplay perspective there are minimal changes from main branch

----------------------------------
June 03 2025
- more work on implementing crew changes 
- removed vehicle crew communication 
- passengers in low armor vehicles with near enemies will now only bail out of the 
vehicle is moving slowly 
- some pylint and misc cleanup

it pains me to remove the crew communication code, definitely a step backwards. if i ever get 
these crew changes finished it is going to result in vehicle handling that is worse than it was 
before the changes. 

i have some thoughts about creating a general conversation system that can be used both in and out 
of vehicles. the challenges are great though. really a ton of logic for verbal communication between 
two AIs to work. i think i'd liek to shelve this for now and get back to it at a later date 

i did a ton of bug fix work here and the game is back to being more or less stable. 

todo before a merge back into main 
- more play testing to catch any more bugs 
- driver behavior probably needs to pause while gunner is firing/reloading 

todo to fix lost functionality 
- need a generalized chat system - probably with a chat class and bools for common asks 
- gunner needs to be able to ask the driver to rotate vehicle 
- gunner needs to be able to ask the driver to get closer 

----------------------------------
June 02 2025
- more work on implementing crew changes 

probably need to axe crew communication for now. there aren't statically defined 
vehicle roles anymore so the old logic won't work (and wasn't great anyways).
I'd like to move to using speak for everything and have a general conversation queue for each humaan 

todo 
- crew communication had to change. needs further rewrites to accomodate 
----------------------------------
June 01 2025
- more work on implementing crew changes 
----------------------------------
May 31 2025
- more work on implementing crew changes

todo 
- radios need a rewrite because i've removed the radio_operator variable. 
in place of that the radio should just keep a queue or idk something exciting

----------------------------------
May 30 2025
- more vehicle crew rewrites
- some vehicles will no longer have a radio 
- pak40 and soviet 37mm aa no longer have a driver and therefore cannot self move 

after some reading on pak guns i've determined that the pak40 (and likely the soviet 37)
were really too heavy to move with man power. they will have to be towed. 
the pak40 may have to get a driver re-added so it can rotate however. 

----------------------------------
May 28 2025
- minor cleanup 
- doing a rewrite of vehicle roles + vehicle role ai in humans 
- made the sd.kfz.251 gunner visible while i was rewriting the roles

the vehicle roles were too constraining. i need to do a rewrite so i can get closer to 
historical vehicle roles. as part of this target identification and driver destination work 
will move over to the vehicle commander role 

!note that this is unfinished so dev will be broken for a bit 

----------------------------------
May 26 2025
- misc minor changes + fixes
- added a grid square system 
- projectile collision now uses the grid square 
- object visibility on the screen is now checked per grid square instead of per object
- removed some unused object lists from world 
- rewriting a lot of small things to look at objects from the current grid square 
- throwables now use the same collision list as projectile so they will hit a building 
- increased alive time for bullet casings and some other effects 
- rso_pak and sd_kfz_251/22 get the passenger_compartment_ammo_racks attribute 
- rewrote vehicle damage so passenger_compartment_ammo_racks bool is used 
- vehicle body hits can also cause a ammo rack hit now 
- vehicle wheel and passenger compartment hits now have a chance to hit the vehicle body as well
- fixed turrets not being able to be hit 

performance improvements for collision and rendering seem noticeable. I timed the old 
rendering info code and the new grid square based code and there was a noticeable difference. 
the possible downside is I am now rendering more objects, but it is worth it to not check positions 
for every object.

searching for nearby objects now mostly looks at the current grid square. 
this will result in some odd behavior when near the edges of a grid square so 
maybe i'll have to implement a way to check neighbors as well. 

i'm trying to up the lethality of vehicle penetrations while still providing some possibility 
of multiple hits being needed 

----------------------------------
May 25 2025
- added su-85
- change to human accuracy formula to decrease accuracy 
- adjust target spotting to account for new ranges

I added the SU-85 to give the soviets more of a chance against the german panzer iv which 
has been wiping the floor with them, but I didn't really look up the stats first. It's basically 
a worse T34-85 and the the T34 is already struggling. I did give it a reduced reload speed, so that 
should help some

I increased the range on large cannons from 2418 to 4000 and increased the penetration tables 
to match. the new penetration tables have a bit of a curve where 0-2000 in game units are still 
pretty close / ideal penetration data and then it drops off quick >2000. Hopefully this will mean 
most engagements are within the best pen data for the guns, but the germans guns will still have 
and advantage at extreme range.

This change makes a clear seperation betwween rifle caliber weapons and large caliber weapons 
range wise. Rifle caliber weapons still have a max of 2418. This will make towed and low armor 
vehicles more viable, but perhaps make them too powerful. 

----------------------------------
May 21 2025
- left control now takes a screenshot. saved in code/game_screenshots/*
- logs now save in a date stamped folder 
- AAR mode (creates screenshot every 15 seconds) toggle from debug menu 
- in the human menu the throwing weapon now has (AP)/(AT) depending on its use 

i kept forgetting what grenades do what on the soviet side so i added hints to the human context menu. 
very helpful. i think that menu needs to be decluttered a bit as well. should only have essential info. 

the screenshots work very well. i thought there would be some lag when it takes them but I haven't noticed any. 

----------------------------------
May 20 2025
- gunners now request that driver wait while they reload 

----------------------------------
May 18 2025
- minor changes to ai_human 
- bumped up the pen on the soviet 85mm at max range a bit. (probably won't matter)

reviewed the health code to figure out why some knocked out humans stay in vehicles but I didn't figure it out.
I also did not catch this happening in my play tests today, so maybe it is already fixed. 

the current soviet tanks do not match up well against the current german tanks. this is only going to get worse as 
i've basically just modelled the worst german tanks so far. i think this is basically accurate though, what is 
missing is a massive numbers advantage on the soviet side, and the tank gunner/driver ai needs to know to drive around 
to get side shots (which will pen on most german models)

todo 
- vehicle driver should probably wait while the turret is being reloaded 
----------------------------------
May 17 2025
- added armor values to vehicle diagnostics page
- added weapon range circles - toggle with space bar 

noted that knocked out vehicle crew still seem to stay in the vehicle, not sure why. 
i got one as a player character.

----------------------------------
May 14 2025
- added standard kubelwagen with one solider as a squad type 
- more squad cost adjustments 

feels like its time to add a couple more tanks. 

----------------------------------
May 13 2025
- wrote a random battle creater 
- quick battle options are now three sizes of random battle 
- adjusted some squad costs 

i could probably mix and match some things to add some more squad types 

----------------------------------
May 12 2025
- split ai_human targeting system into _human_targets and _vehicle_targets
- ai_human update_think will now look for AT targets if the human has a AT weapon 
- ai_human update_think will now look for human targets if the human has a weapon 
- vehicle gunners will now prioritize vehicles if they have a AT rated weapon 
- removed a excessive log from the spotting function 
- passed out humans exit vehicles now 
- minor changes 

i added 4 more soviet tanks - which is enough to push the balance in the soviets favor.

----------------------------------
May 7 2025
- refactored ai_human visibility calculations into their own functions 
- minor bump in enemy spotting distance 

instead of a combined near_targets I am considering doing near_humans and near_vehicles
that way vehicle gunners can focus on other vehicles as a priority, and other smart actions 
around vehicles can be more easily taken by just checking the length of the near list 

----------------------------------
May 4 2025
- added wait task to ai human 
- minor changes to vehicle diagnostics 
- refactor of task_enter_vehicle 
- added more error catching for world_menu
- added default brake action for drivers 
- adjusted the soviet 37mm so it can move very slowly like the pak40 
- adjusted some reload speeds 

several tasks now go to the wait task for several second when they are done. this is to simulate 
things like the time it takes to pick up a object 

task_enter_vehicle now does a early abort if the vehicle is disabled. 

drivers are on the brake way more. the result of this is the vehicle stops faster when the driver 
is waiting or holding for a engagement. this means vehicles will likely engage at longer distances and 
will reduce the chances that a vehicle accidentally drives past a target they are trying to engage. 

soviet 37mm AA can now slowly move into position. I did three play tests where i followed them 
and in each test they got machine gunned before they had any effect.  they would probably do 
better in a infantry only fight. 

play test notes : 
- i saw a disabled t34-85 with a driver that had its current task set to driving. 
not sure how this happened as a disabled vehicle should cause all the crew to leave
- it seems there are some objects without a name that end up in world. i'm not sure 
what they are at the moment, but i saw them on the self-debug print out 

todo 
- vehicle reactions to threats 
----------------------------------
May 3 2025
- added missing vehicle diagnostics screens 

----------------------------------
May 2 2025
- added vehicle diagnostics turret page 
- misc fixes to vehicle diagnostics 

----------------------------------
May 1 2025
- minor work on vehicle diagnostics 

----------------------------------
April 29 2025
- dead bodies exiting vehicles now have slightly randomized positions
- fixed molotov cocktail world remove error 

looked at the mouse selection code to see if i could prefer vehicles over bodies/weapons 
but did not see a clean solution to the problem. might need a z sorted mouse select. 

the better option is probably going to be keeping dead bodies in the vehicle. 

found some odd behaviour with ai repeatedly entering/exiting vehicles. this might have 
been due to enemies being close.

really need to add some behavior for vehicles when they can't pen something. 
german half tracks will drive up right next to a soviet tank and hang out until they are 
shot.

----------------------------------
April 28 2025
- minor adjustments and fixes 

----------------------------------
April 27 2025
- moving more data over to vehicle diagnostics from the vehicle menu 
- fixed a occasional error in the wheel_hit code 

----------------------------------
April 25 2025
- fixed strategic mode squad data error 
- fixed scaling error when switching modes  
- minor changes 

----------------------------------
April 24 2025
- more work on the vehicle diagnostics page 

----------------------------------
April 23 2025
- rewrite of some stuff in graphics_2d_pygame to accomodate more graphic modes 
- work on the new vehicle diagnostics screen 
- screen center is now computed on load 
- misc minor changes

I think the vehicle diagnostic screen will replace a lot of the vehicle menu data print outs. 
There is a lot more room for text when I am using the full screen, and the white background 
makes it a lot easier to read 

todo 
- noticed a strategic mode error. put it in the issues backlog 

----------------------------------
April 22 2025
- bug fix 
- started work on a new vehicle diagnostics ui

the wheel print out in the vehicle menu can overflow the screen now. 
i need a dedicated vehicle system diagnostics page.
i'm thinking it would be a overlay - game would probably continue running in 
the background. 

----------------------------------
April 21 2025
- introduced a more complicated wheel setup 

there are now 4 sets of wheels 
- front left 
- front right
- rear right
- rear left

each section has a minimum number of wheels. A destroyed wheel 
does not count toward the total. falling below the minimum disables 
the vehicle.

when a wheel is hit only the front/rear set on the side of the hit can be 
damaged. this matter somewhat as each set on some vehicles can handle some damage 

# todo 
- airplane wheels 
- tank tracks 
- tires

# other thoughts 
maybe wheels need to be connected to axles so we can simulate open or locked differentials 
- this would also make it easier to simulate/understand traction 

----------------------------------
April 19 2025
- updated armor value for some wheels 

damaged wheels have to have some sort of effect on the vehicle and eventually disable 
it but im not sure what i want to do yet. german vehicles with skirts also need the 
spaced armor value on their wheels.

i may split wheels into left and right sides so at least the damage hits the correct 
set of wheels - although what would the benefit be?

also need to add tracks 

----------------------------------
April 18 2025
- minor updates 
- large human pickup position offsets are now per object 
- added the burst mechanism used for hand weapons to vehicle weapons 

i updated the offset for dani. the gas can needs to be updated as well - but I think 
i should create some new art for it as well. 

the burst system could be better. for MGs it means pretty much always a 10 
round burst. could probably randomize a bit. working well enough for now though 

todo 
- i noticed a t34 had a penetration on a wheel from a rifle bullet - will have to look into that

----------------------------------
April 16 2025
- player reloads now use the new timing system 

player reloads are grouped now. 
if the player is in a vehicle hitting 'r' either reloads the coax or primary weapon if they 
are in a turret depending on which gun is empty (if any)
if the player is not in a vehicle the primary weapon and at weapon will be checked 

I was able to re-use the ai 'task_reload' code for the player so this conveniently 
also proves that code works correctly. 

when working on this i realized there is still no way for the player to fire the 
coax mg. player turret control is still terrible so it doesn't really matter ... :D 

----------------------------------
April 15 2025
- added a reload task for the ai (covers guns and at weapons)

reloading should be fully implemented for the AI now. 
I will have to do something similar for the player.

I might have to setup some infantry only battles to make sure it is actually working 

----------------------------------
April 14 2025
- vehicle gunners have a reload action now 
- reload speed for turret guns is now in use 
- fixed an issue where a explosion in a vehicle left dead people in the vehicle 

part of me thinks that dead people in the vehicle is actually the realistic ideal outcome
but a lot of stuff interacts with vehicle crews and it all expects them to be alive.. 

todo 
- player reloading timing 
- ai reloading for regular guns 
- ai reloading for panzerschrek 

----------------------------------
April 13 2025
- added some short think pauses after accomplishing some driver actions to make actions seem 
less eratic 

thinking about finally adding reloading, but it seems like it is going to be a bother. 
was originally going to add it to the guns, but it should really be part of humans, so it will 
be an ai action, but that means coding it is multiple places and the player will also need a implementation

----------------------------------
April 12 2025
- filled in placeholder wheels for the rest of the vehicles 

pretty much all the vehicles need to be gone through and have all the variables tuned and customized 

----------------------------------
April 11 2025
- wheel now has tire attributes 
- added wheels to a couple more vehicles 

wheel damage and repairing it is not fully coded yet. 
also need to add tracks 
----------------------------------
April 08 2025
- fix bugs with new mechanic ai role 
- fixed unknown state for think_vehicle_role_gunner_examine_target

----------------------------------
April 07 2025
- more work on mechanic ai
- added mechanic class for soviets and germans 
- minor fixes and updates 

eventually i want repairs to take a decent amount of time, for now 
they are instant -- just to get mechanics in the game. 

i would also like a unique set of items for mechanics. maybe things that are 
required in order to perform repairs 

----------------------------------
April 06 2025
- started work on adding code for mechanics 

----------------------------------
April 03 2025
- gave the rso pak a small amount of vehicle armor 
- added code to fix the turret jitter 

rso pak gets 5mm of vehicle armor but no passenger compartment armor. 
this will protect the vehicle from pistol fire to the vehicle body, but close 
rifle fire will still get through. longer range rifle fire may bounce. 
the passenger compartment is unprotected. 

looking at my angle measurements idk if they make sense or not. I don't remember how I ended up deciding that 90 was horizontal 
and 0 was vertical. really i need to also calculate the angle relative to the incoming shell. 

----------------------------------
April 01 2025
- added the RSO PAK 

The RSO PAK is very unsurvivable. I think I will give it some low hull armor, but it will likely 
still be vulnerable to MG fire. 

----------------------------------
March 31 2025
- fixed player large human pickups 
- player now creates noise when moving 

the player seemed somewhat less likely to be shot for awhile, i bet that was 
because player movement was not generating noise. that has been fixed 

todo 
-dani should be a large human pickup 
- more dani art 
- fix start screen so it isn't so blindingly white 

----------------------------------
March 30 2025
- logs save to .csv in ./logs/ on exit now 
- main human menu has a exit world option that is now enabled in quick battle 
- human death logs redone and now saved in engine.log 

----------------------------------
March 27 2025
- disabled death logs for now 
- minor changes to menu info 
- minor fixes/changes

I want to do something different with the human and vehicle logs but im not sure 
what for now. the info is interesting but it was excessively cluttering up the console log 

----------------------------------
March 26 2025
- bug fix 
- added a debug counter for medic heals 

updated readme screenshot 

let some test games run a long time and caught a couple bugs.
Also was able to verify that the new medic code does work, although its 
more likely that the medic just gets killed 

thinking about removing the kill logs - they are making it hard to find actual 
bugs. there are 500+ humans in the large scenario so that is a ton of logs.
The data is still pretty neat. maybe i can turn it into a csv or something 

there is clearly a bug causing some bullets to fly infinitely as im getting a 
lot of 5000 range max range errors. maybe something with the new disabled vehicle 
penetration mechanic. have not reliably triggered it but I've added more debug data 
so I should have more info the next time it happens. It seems like it should be impossible..

----------------------------------
March 25 2025
- some code refactoring 
- low blood pressure now affects speed 
- added medic ai code 
- added german/soviet medic (one man) squads 
- added a catch for projectiles with range > that what is in the sql data 

medics start off unarmed but they can pick up a weapon like any other human.
they are unlikely to survive long, but its a fun mechanic 
medics can stop bleeding and increase blood pressure 

play test notes 
- i think the panzerschreck is still being rapid fired by the AI
- balance of the large scenario seems to favor the germans again. not sure why 

----------------------------------
March 24 2025
- bug fix 
- slightly darker background color so tracers show up 

----------------------------------
March 23 2025
- human health replaced by blood pressure 

blood pressure acts in a similar way to health, but bleeding drops it 
faster. 

If bp is <30 the human will prone and be unresponsive until bp raises 

this allows us to have a medic in the future that can fix humans 

----------------------------------
March 17 2025
- bug fix 
- added wheel data to 'in vehicle' menu print out 
- changed terrain color again 

i need to come up with a actual terrain tile solution or maybe just create some terrain features that can be added 
as objects to break it up a bit. 

----------------------------------
March 16 2025
- moved rolling_resistance from being a world_object var to a local var in a ai_vehicle function 
- rolling resistance now effected by wheel damage 
- added a chance of wheel hits for left and right hits. 

I keep adding vehicle components and the amount of info that needs to display is getting out of hand 
Also every time I add a component I need to add code so the AI understands it, and that is lagging behind 

wheel hit chance is fairly low now. has to be a body hit from the left or right and then gets a 50% chance 
of being a wheel hit. also added in armor calc so that bullets won't damage tanks.

todo 
- tires/tracks
- ai awareness of wheel damage and repair/replace mechanics 
- test and tune rolling resistance 

----------------------------------
March 15 2025
- minor cleanup 
- added wheel object for vehicles 
- added volkswagen wheel

haven't decided yet how wheels will be incorporated in vehicle physics 

----------------------------------
March 14 2025
- added radios to the german tanks 

todo 
- add a german tank engine 

----------------------------------
March 13 2025
- some pylint style cleanup 

----------------------------------
March 11 2025
- rewrite of a lot of vehicle role stuff 
- added 3000 column to projectile data 
- projectiles no longer collide with disabled vehicles 

somehow i got a projectile hit at 3000. never had that happen before.
one of the weapons must be misconfigured 

empty vehicles blocking shots was getting to be a big issue because the ai can't 
check collision pathing. good compromise is empty vehicles block shots, disabled 
vehicles do not.

the new code seems a lot better and vehicle movement. specifically the s curves 
vehicles were getting into seems to have been fixed. i think this was a rotation 
with too high of a speed that constantly overshot. 

target selection seems particularily bad for vehicles - they really need to know 
how to prioritize.

----------------------------------
March 10 2025
- rewrote a lot of the data display for internal vehicle menu 
- bumped up building check rate - it was being checked super often 
- removed rounding from math_2d.get_distance for a pretty nice performance bump 

noted one issue with the new vehicle damage system is that a tank can be overlapping another 
vehicle and never get hit because the first one blocks everything. 

i experimented with going with a larger game window. the current one is too small to really 
engage in combat easily for humans, you end up having to zoom out too much 

spent a fair amount of time working on performance because im back on a older intel cpu laptop 
that is not great at running this game. surprisingly large gain from removing a round from 
get_distance. should probably remove more rounds - unsure why that is so slow 

----------------------------------
March 08 2025
- finished initial work on squad rewrite

squads are now created based on the templates in the sqlite table. 
squads will also get initial orders to enter the vehicles associated 
with the squad. 

----------------------------------
March 07 2025
- more squad rewrite work 

----------------------------------
March 06 2025
- rewrite of squad_builder 
- started rewrite of squad spawning and general squad handling 

squad_builder now creates squads that match the squad definitions from sqlite. 
this will result in more sane squads both in campaign and quick battle

vehicle handling for squads is being redone. now squads will be aware of their starting 
vehicles. 

I thought about deleting aifactiontactical all together - but i think this will have to wait. 
It is almost not needed..

! note - work is not done so this will break dev branch for a bit 

----------------------------------
March 04 2025
- minor cleanup
- added a squad data printout to the debug menu 

started working on a rewrite of ai_faction_tactical code but 
decided it would be better to mostly delete it and move that over 
to the squad lead - that would be more realistic for these tactical 
battles.

created a github project for TWE. idk if i will use it long term or 
not

----------------------------------
March 01 2025
- more bugfix 

----------------------------------
Feb 27 2025
- bugfix 

----------------------------------
Feb 26 2025
- added vehicle ammo racks
- some adjustment of vehicle ammo loadouts 
- overhaul of vehicle damage simulation 
- vehicles no longer have health and cannot die 
- changes to how ai gunners assess target health 
- turret hits more likely 1/5 to 1/4
- misc minor changes

A ammo rack is similar to inventory but it only has main gun ammo.
This is used for a vehicle damage event where the more ammo you have 
left, the higher possibility of an explosion. 

I wanted to add turret ammo racks but after a lot of time searching I concluded that 
I could not find consistent data on turret ammo loadout. I think it was overall rare 
in WW2 vehicles, with the possible exception of the Tiger II.

passenger compartment hits in vehicles without cannon (no major ammo storage) will likely 
hurt the crew but won't do much else.

vehicle body hits are likely to take out the engine which disables the vehicle and will 
cause a bail out.

In order to help the ai understand the new complex vehicle damage there is now a 
vehicle_disabled bool - which is turned on currently by engine damage and ammo rack 
explosions. This bool will cause the crew to bail when they see it, and will cause the 
AI to not enter the vehicle if they come across it. 

removing health as a variable from vehicles is going to have some weird effects. it will 
take awhile to sort everything out 

gunners are now less likely to stop shooting at vehicles - they only make this decision 
in the think phase - and currently they check to see if a vehicle is empty

no more vehicle wrecks - which is good because they were not a great solution 

I wonder if I can remove health from humans. 

todo 
- add more vehicle damage effects 
- add electric and manual traverse speeds for turrets (with engine on or vehicle electric check)

----------------------------------
Feb 25 2025
- added 'primary_turret' bool for turrets 
- ai gunners will now check this when deciding whether to ask the driver to do things 
- guns can now be damaged or jammed 
- turret penetration now results in turret component damage not health damage for the turret
- turret no longer has health 
- ai gunner is now aware of gun damage, jams, and turret jams. 
- ai gunner can fix gun jams
- mg34 belts and 1 round cannon 'magazines' are now disintegrating and dissapear when empty 

this is a start of a move towards component damage and away from unrealistic health counters.
i'd like to eventually do this for humans and vehicles. 


todo 
- consider adding ammo_stowage to turrets and vehicles and moving ammo storage over to it. 
- add the possibility of a turret hit causing a ammo explosion 
- figure out if turret jams and gun damage should cause crew bail outs 
- was unable to trigger a grenade throw from soviet troops while in a tank - need to look at that further 

----------------------------------
Feb 24 2025
- bumped up rate of fire on all large caliber weapons to around 1 per 30 seconds 
- adjusted cannon smoke offsets for all cannons 

----------------------------------
Feb 23 2025
- added smoke and flash to cannons 

I was lazy and only set the correct position on one of them.
need to go back and fix

----------------------------------
Feb 20 2025
- added range to throwable items. used by ai_human

----------------------------------
Feb 19 2025
- minor cleanup 
- added my cat dani

dani gets a unique ai but i think eventually I will want to add some animals
and birds.

----------------------------------
Feb 17 2025
- updated panzerschreck rate of fire to about 1 per 30 seconds 
- split update_task_engage_enemy() into anti vehicle and anti human functions 
- ai is now aware of the use_antitank attribute of grenades 
- ai now uses the weapon range attribute when deciding whether to fire antitank weapons 
    - previously it had to be within primary weapon range + a hardcoded AT range value 
- minor adjustments and cleanup 

rate of fire for panzerschreck is a bit of a hack around the fact that we 
don't have a reload time implemented yet 

todo 
- throwables should get a range attribute. this should then be used in place of hardcoded numbers 

----------------------------------
Feb 16 2025
- added german radio team
- change to large human pickup position/angle computation to make it more frequent 
- working on standardizing worldbuilder soldier loadouts 
- increased ammo for soldiers with bolt actions 

----------------------------------
Feb 14 2025
- large human pickup gets a computed position and angle 
- minor ai_human updates 

note - i noticed the ai doesn't turn towards what it is firing at anymore. i wonder if 
that got left out in the ai code rewrite. will have to think if it should be added back in 

----------------------------------
Feb 10 2025
- "fixed" pak40 rotation and movement 
- bumped pak40 ammo from 10 to 30
- fixed bug causing altitude to fluctuate while driving in ground vehicles 

reducing the weight of the pak40 to something more realistic and bumping the speed 
was enough to get it about perfect. it can now move very slowly and turn fast. (too fast)

I think I confirmed that the AI will fire all the panzerschreck ammo at once. i need to 
add a reload timer to fix this 

todo 
- reload timers 

----------------------------------
Feb 9 2025
- fixed variable error in the new driver code 
- gave pak40 bike pedals as a temporary experiment 
- misc cleanup
- fixed crew communication so it actually works 

confirmed rotate to target now works. I watched a hetzer do a 180 and nail a t34 that was 
coming up behind it.

more tweaks are needed to the pak40 speed to get it to rotate without moving much. 
might just need some code specifically for rotate but not move. 

the driver rotation response also needs a cooldown once the task is finished. otherwise 
it can oscillate wildly between gunners and targets 

----------------------------------
Feb 8 2025
- removed most of the lru_cache stuff 
- rewrite of vehicle driving ai 
- added some more is vehicle full checks for enter vehicle related tasks 

lru_cache should have helped but i suspect there 
just wasn't enough cache hits. Its hard to say because 
frame rate is so variable but I think overall it was hurting.
It might have been better if i didn't have to convert to tuple first 

there shouldn't be lines of bots walking to a vehicle only to find that it is full anymore 

large vehicle driver ai rewrite. The crew can now talk to the driver and 
ask them to complete several actions 

introduced the vehicle commander role, although it is not coded yet 

todo 
- pak40 needs a engine so it can be rotated 
- vehicle turrets are firing when out of range again. need to fix 

play test notes 
- new driver ai has seemed to negatively affect the  hetzer 
    - rotate request is probably not slowing down fast enough 

----------------------------------
Feb 7 2025
- added auto reload for handheld AT

At the moment the reload only really applies to 
the panzerschreck. eventually I'll probably add the bazooka as well.

the handheld AT auto reloads for now. not worth adding in a new 
manual reload interface just for panzerschrecks.

will have to check if the ai fires them all off at once.

----------------------------------
Feb 3 2025
- more pylint code cleanup 
- general refactoring for code readability

----------------------------------
Feb 2 2025
- turned off bullet cases for panzer iv hull mg 
- added panzerschreck

todo
need to handle reloading for anti-tank weapons 

----------------------------------
Feb 1 2025
- added more caching for math functions 

----------------------------------
Jan 31 2025
- added lru cache to a couple functions in math_2d 
- minor cleanup 

I couldn't tell a difference with the lru cache. 
maybe i should just disable it.
A custom cache for get_distance and some of the rounding functions might 
be worth it.
----------------------------------
Jan 29 2025
- minor cleanup and optimization of graphics_2d_pygame 

ran graphics_2d_pygame through a couple ai models to see if 
there was anything interesting i was missing. best suggestion 
was to replace all the if/else for input with dictionaries - 
which i implemented. 

also rewrote a couple other sections to reduce and clean up 
some of the exessive if statements, but performance effect was 
not noticeable.

i should look into using lru caching with some of the math_2d methods 

----------------------------------
Jan 28 2025
- vehicles now detach any towed object on death 
- minor cleanup and optimization

----------------------------------
Jan 27 2025
- vehicles and humans now have recent_noise_or_move attribute 
- human evaluate_targets uses recent_noise_or_move to determine visibility 
- hit marker menu readout now includes distance 
- added faction vehicle count to debug data 
- fixed a bug with faction vehicle count 
- added a closest_building variable + rewrote building detection to support it 
- added a idle task to move to the closest building 

the recent_noise_or_move change did not have a immediate obvious effect. 
the human ai needs to be updated to use prone more, and to prefer to be in buildings whenever possible 

----------------------------------
Jan 26 2025
- added pak 40
- added sd.kfz.251/22 with the pak40
- adjusted spawn rotation angle for german and soviet vehicles 

The 251/22 is pretty interesting. It has no anti-infantry weapons and only 24 AT rounds.
It has the pak40 which is the best AT gun in the game at the moment, but it has 
paper thin armor that will only stop rifle rounds. 

I probably need to add some way for the crew to fire out of the top of open topped vehicles, 
but it would probably be pretty complicated. maybe a special turret.

todo 
- implement 'signature' variable for humans and tanks 
    this will be sound + visible signature. 
    + when firing gun 
    + when walking 
    + for not prone 
    - for in building 

signature will be used to decide if a human/vehicle gets rendered, and decide if a human or vehicle shows up 
for targeting for the AI 

----------------------------------
Jan 25 2025
- minor ai_human updates 
- adding code for sitting down on furniture 

apparently i had created a whole world objects category for furniture - with 
the only object in that category being the brown chair. The chair was added in 
2023 and I didn't do anything with it until now. There are actually a lot of 
little random bits in the game like that. 

Now the AI has a idle task for sitting down. the AI will travel to the nearest 
chair - but only if one is in range, with the range being shorter for soldiers than 
civilians. 

the new task_sit_down is a good model for a complex task. It has three stages (search/move/sit)
and it can handle switching context to a move task. 

todo 
- test new sitting task 
- add more furniture 
- 

----------------------------------
Jan 23 2025
- minor cleanup
- added think_idle task 

think task was getting too large and complicated. think_idle will eventually include a bunch of new tasks - which 
I need to write first. 

possible idle tasks 
- sit in chair 
- eat or drink 
- merchandising 
- cleanup objects 

----------------------------------
Jan 22 2025
- turret pens also damaging the vehicle no longer happens for remote turrets (no opening to the vehicle)
- fixed game menu faction and quick battle mismatches 
- added wallet readout to player menu 
- ai now only eats/drinks when hunger/thirst is >20

I better do something with the wallet and banking stuff before i forget about it completely 

----------------------------------
Jan 20 2025
- most vehicle weapons no longer produce shell casings 
- retraced the lines on the t34-76 turret with a brighter grey to make it more visible 
- deleted some unused images
- added luftwaffe ground crew with k98k and mg-15

hetzer remote gun is a exception to this as it is fully external and 
would eject shell casings into the environment. same with the sd.kfz.251

thinking about making more soldier art. probably luftwaffe ground troop + luftwaffe with camo smock. 
will also need a waffen ss smock soldier.

need to learn more about soviet uniforms.

----------------------------------
Jan 19 2025
- added rpg43 grenade (heat)
- AFV crew changes, most have pistols now 
- fixed 45 acp projectile name error 
- fixed a (rare) error with switch_task_pickup_objects
- increased chances of vehicle damage 
- adjusted penetration values for most projectiles to give them >=1 penetration out to longer distances
- getting hit in the head now results in a penetration check against your helmet (if you have one)
- rebalanced quick battle - soviets have the advantage now 
- minor adjustments to vehicle steering
- primary weapons in turrets will no longer be fired at humans if they aren't tagged as use_antipersonnel 
- added turret jamming 
- minor turret health changes 
- fixed rare bug with <0 health vehicles 

Not sure on rpg43 distribution. I couldn't find any historical sources on how common these 
were at the squad level. I get the impression that Soviet hand held AT was fairly uncommon with 
the expecption of AT rifles - which were apparently used through the entire war in great numbers 

The german AFV crew now gets a random pistol or a MP40. This is the first time that a lot of the 
pistols that have been created will actually be used in game. 

todo 
- make more pistols 

----------------------------------
Jan 18 2025
- added lead calculation to turret aiming 
- bumped t34-76 ap values up significantly 
- added molotov cocktails 

the lead calculation happens during think phase so the turret gunners will be more accurate 
immediately after thinking, and then less so (for moving targets)

this resolves the issue with thanks shooting thousands of rounds at moving soldiers and missing all of them. 
the downside is that the lead calculation works very well and tanks are now unstoppable 

this also means that firing on a vehicle that is moving is probably less accurate for most shots - which is 
probably ok with the state of ww2 gun equipment 

Adding the molotov cocktails required a lot of additional code. After I was done I did some quick 
research and learned that they really weren't in common use in the soviet army. they were 
historically more of a anti-soviet thing (finnish etc) whoops.

I added molotovs to a couple troops on the german and soviet side but they will remain uncommon. 

the flame mechanism is pretty hard to get a hit with, but if it hits a vehicle and passes the 
dice role it will damage the crew heavily, possibly taking some of them out. 

----------------------------------
Jan 15 2025
- added a driver behavior to angle towards vehicles that are being engaged (50% of the time)

mixed feelings on this after play testing. The soviets seemed to be doing better, but that wasn't 
the expected result as it affects all tanks, but the german tanks have the worst side armor. 

the implementation is not great. I probably need more vehicle crew variables so that the driver 
can better pass state to itself for the next iteration. 

----------------------------------
Jan 14 2025
- faction_tactical now keeps track of faction associated vehicles
- friendly fire is now off for vehicles (based on the faction list)

I should add a stun effect from large pen and non-pen that cause the driver to reverse away a bit.
maybe a morale system for the ai_human that affects both soldiers on foot and in vehile 

----------------------------------
Jan 13 2025
- upped some vehicle and turret penetration damage 
- turret hits now have a chance to also damage the vehicle
- updated evaluate_targets to handle the new gunner roles 
- gunners now consider penetration characteristics of their weapon vs the target (only in think mode )

I've changed the force mix a bit for the large quick battle to be more lop sided in the soviets favor and.. 
it did not help. Ever since the vehicle gunnery and panzerfaust improvements they have been getting wrecked 
crazy hard. Part of it is definitely that panzerfausts are crazy deadly, and part of it is probably that the mg34 
and now mg42 are very very good.

I'd like to replace vehicle health with component health, but i need more components first.
I could probably add in engine damage though. 
With vehicle health it is hard to get a damage model that feels right. In my play testing today 
there were vehicles taking a ton of hits before going down.

todo 
- look at armor pen of rifles at distance. they should not bounce off zero armor 
- need a faction vehicle list for friendly fire 
- damage from rifle caliber rounds to afv should be low and not treated the same as tank rounds 

----------------------------------
Jan 12 2025
- cleanup and standardization in world_builder 
- panzerfaust splits into panzerfaust 60 and panzerfaust 100 
- different HEAT jets are now supported 
- sd.kfz.251 now has a chance of having a panzerfaust 100 in inventory 

panzerfaust rangers were normalized to match subgun and assault rifle ranges 

decided to keep the panzerfaust troops with panzerfaust 60 for now as it is the most common type 

todo 
- add panzershreck 
- add crates back to the world
- find a way to add more random stuff/clutter  

----------------------------------
Jan 11 2025
- added the art file for the ju88 that had been deleted awhile ago 
- minor pylint related cleanup 

went looking for the gimp file for the sd.kfz.251 which i thought was in the 
repo at one point but no luck. I might have to redraw that. 

----------------------------------
Jan 7 2025
- increased the max distance for the tow option from 200 to 300 to make it easier 
- added explosion as an option for projectiles 
- 37mm frag round is now explosive with fragmentation 
- possible fixed a rare bug with vehicle menu erroring out when player dies in a vehicle 
- added a 'out of ammo' state for the gunner so the driver won't stop if the gunner has a target but cant fire

the explosive rounds actually look kinda cool. not terrible 

I need to figure out what effect explosive rounds have on armor. I feel like 37mm HE should probably still 
wreck a 251. but maybe not?? It is actually on the higher end of armor for ww2 vehicles 

I was driving a t34-76 while play testing and noticed that the gunner could not pierce a panzer 4 frontally but 
could from the side. thats probably about right. 

----------------------------------
Jan 6 2025
- fixed crew position not updating on towed vehicles 

If you are playing as soviets you can now tow the 37mm aa guns into good defensive positions 
around the map. They have 360 traverse and a decent rate of fire (should probably be higher) 
but currently HE shells are not modelled yet so they will be of limmited affectiveness. 

todo 
- fix tow distance
- add tow offsets for some vehicles 

----------------------------------
Jan 5 2025
- added mg42 
- adjusted mg34/42 belt length to be a historical 250
- switched some squads to mg42
- added visible crew + positions back to the soviet 37mm

mg42 re-uses the mg34 artwork. all the guns need to be redrawn to scale - and i'm just not feeling 
like doing that at the moment.

added the 37mm aa back to the skirmish battle to keep it on my mind. towed guns SHOULD be a 
big part of this game - but they need some love before they are usable

I'd like some of the sd.kfz.251s to use the mg42, and probably some of the hetzers but i haven't 
decided on how to do this yet. in-game difference between the two is likely minimal. mg42 has a slightly 
faster rate of fire. reliability is not modeled yet - this is where the mg42 is apparently really good 

todo 
- passengers don't move when a vehicle is towed 

----------------------------------
Jan 4 2025
- added 'current_action' to vehicle crew memory as a way of passing info about what the bot is doing 
- driver will now stop the vehicle if the gunners are engaging something 
- fixed bug in code for removing vehicle targets that are out of range or are out of the rotation arc 
- workingn through some of the pylint suggestions for ai_human 

I should run pylint more often. I think it would have theoretically caught some of my logic errors with using == instead of =

todo 
- strongly consider removing the event system and just calling the sub functions directly 
- lots of playtesting needed 

----------------------------------
Jan 1 2025
- added back in gunner hits from turret penetration. 50% chance 

interesting note - the sd.kfz.251 turret is not armored from the back. the gunner can 
be shot out pretty easily 

----------------------------------
Dec 31 2024
- fixed a bug with coax weapon ammo check
- increased chance of ammo rack hit, increased chance of passenger hit, 
decreased damage for non-ammo rack passenger compartment hits 
- bumped up closest distance that triggers an auto engage from 600 to 1000
- bots now update destination occasionally for objects they are trying to reach if the object can move 

closest distance will interrupt other tasks - this is what keeps a soldier from 
walking past an enemy while they are trying to do something else. 

testing notes 
- i have twice seen a tank where all the crew died but the tank was still alive.
if the tank is moving when this happens the dead crew drops out and it (very) slowly rolls to a stop 
this is a neat mechanic 

----------------------------------
Dec 30 2024
- panzerfaust launch now has a smoke trail from the launcher 
- ai driver now cuts down to 0.5 throttle when turning 
- fixed an issue where vehicle gun reloads may not have been triggered 
- caught a logic error with some code dealing with a out of ammo situation 
- fixed a bug with ammo check where it was looking at name not world_builder_identity 
- upped mg ammo for most vehicles (likely still significantly below historical loads)
- updated idle squad calculation to take into account spread out squads 
- misc minor changes


it seems idle_squad identification might have been bugged if a squad lead ends up 
very far away from the destination but also seperated from other squad members, the members 
could end up getting no new orders and just sitting in vehicles waiting.

Some gun magazines had names that were different from their world builder identity
which could have resulted in situations where they were never reloaded 

panzerfaust smoke trail isn't exactly how I wanted it, but its good 
enough for now. the point was to make it a little more obvious when a 
panzerfaust is launched as they are barely visible - and are the #1 
killer of tanks at the moment.


----------------------------------
Dec 29 2024
- added a human accuracy calculation
- guns also have mechanical accuracy now 
- added is_towable to the soviet 37mm
- humans can now have afv training 
- tanks now require afv training 
- added afv crews (can drive afv , but less combat equipment)
- added afv crews to squad builder 
- afv crew have some different behavior for vehicles and are less likely to leave them
- added german afv crew black uniform 
- fixed an error in the dialog that enables you to tell squad members to board your vehicle
- some changes to how vehicle drivers handle being near their destination. 
likely fixed an error where vehicle drivers do not update destinations (less relevant before 
todays code changes)

hard to say how much the human accuracy effects things at the moment. 
will probably take more play testing to make a determination 

the new afv crew mechanic will need a fair amount of debugging and tuning.
the general idea was to reduce the amount of tanks/afvs that get driven to a location 
and abandoned. I wanted a special dedicated vehicle crew type that will stay with the vehicle 

I know the Germans were transitioning away from the black panzer uniform in >1943 as field grey was 
better camo - but it is iconic and would otherwhise be hard to make the AFV crew stand out 

I will make a soviet vehicle crew outfit as well, but im guessing they used the same uniform color 

todo 
- vehicle accuracy 
- stabilization 
- telling the driver to stop 
- soviet afv crew uniform 
- at squad spawn all AFV crew should be given a vehicle to enter if possible 

----------------------------------
Dec 28 2024
- switched vehicle spawn positions to a grid. 
- grid of grids for squads + squad member spawn 

grid spawn for the starts is a nice little visual thing. didn't do 
much in practical terms and may have reduced vehicle usage - some 
might end up being too far away - will have to look into this further.

----------------------------------
Dec 27 2024
- added the DTM - which is just a tank adapted version of the DP28 with a 60 round pan magazine
- cleaned up the white outline around the mp40 image 

Soviet vehicles have all been switched over to the DTM. 

Had a really hard time finding concrete info on the DTM magazine and the gun in general 
This video from Ian was one of the few places on the internet where it is even mentioned 
https://www.youtube.com/watch?v=goLAR1KdqRw


todo 
- panzerfaust launches need a minimum distance to keep the users from roasting themselves 

----------------------------------
Dec 26 2024
- fixed a new error with player weapon reload 
- fixed a new error with player turret reload 
- added MG34 120 round belts as a 'magazine' option 

might have to add in barrel overheating mechanics. the 120 round belt is pretty wild 

I need a better understanding of when a 75 round drum mag for the Mg34 would be used vs 120 
round (or greater??) belts. For now I think I'll move the tanks over to the belts 

The bots fire slower than the max due to a bunch of things like trying to align the turrets. The max 
fire rate on the MG34 is astounding - possibly exceeds the ability of the engine. Will have to look into that when 
I add the MG42..

todo 
- Soviet machine guns need some love. 

----------------------------------
Dec 25 2024
- rewrote reload weapon logic (for ai and for player)
- added reloads for coaxial mgs 
- large rewrite of how turrets are manned by vehicle gunners
- rewrote the player vehicle crew role change menu 
- added a zoom visibility level for the hit markers 

todo 
- remove radio.ai.radio operator, add radio as a vehicle_crew role_object
- remove destination from switch_task_enter_vehicle
- figure out if ai should keep roles as 'gunner' or use 'gunner_1'

----------------------------------
Dec 24 2024
- added Panzer IV Ausf G / H / J 
- fixed issue with gun crew assignment 
- added coax machine guns
- turret gunner logic to select coax appropriately 

A lot of games just seem to to a G and draw it like a H, but for a late war 
game all three models are relevant. 
- G has the L43 gun, H and J have the L48
- H has armor schurtzen, J has wire schurtzen on the body 
- J has a manual turret traverse 

G should be the least common but i need to model availability yet 

----------------------------------
Dec 23 2024
- removed aibase.py and inheritance 
- fixed a new error in the ai_human grenade engagement code
 
I remembered the one thing the inheritance was really used for - setting owner. 
I can just do this in every class that needs it instead 

----------------------------------
Dec 22 2024
- grenadees now use the new explosion function 
- model24 adjusted to be non-frag grenadee 
- rg_42 adjusted to be frag grenade

todo 
- variable smoke and explosion animation length 

----------------------------------
Dec 21 2024
- working on a new explosion mechanic 

when i started out writing this game I was coming from having written a 
c# game a number of years earlier. the c# game relied on inheritance to work 
so there was a base class and then other classes built on it. with python this 
has been largely unnecessary as anything can be anything due to not being statically 
typed. Due to this the ai_base class is basically useless 

todo 
- switch grenade over to new explosion system 
- introduce some different levels of frag grenades 
- HE shells 
- figure out HE vehicle damage 

cleanup todo items 
- remove aibase. it is not needed 
- consider removing the entire 'handle event' system 

----------------------------------
Dec 20 2024
- added checks for armor and speed before throwing a grenade at a vehicle 
- small distance pre-check increase for grenade throws 

grenades need a overhaul. I think they should probably pre-create their shrapnel 
projectiles and store them like a gun has bullets in a magazine. this will allow 
for different types of shrapnel, and a more effective armor pen pre-check 


----------------------------------
Dec 19 2024
- added crew placement for T20 tractor
- toggled bike driver back to visible (with the new code) 
- radio operator is now an optional role 

the t20 went down to 6 passengers. I couldn't find a exact historical loadout but 
from looking at pictures the passenger space looks really tight. 6 has got to be 
about the max. 

note - unlike the sd.kfz.251, the t20 has a completely open unarmored passenger area.

----------------------------------
Dec 18 2024
- added tools/image_tool.py
- large rewrite of vehicle crew handling 
- rewrote ignore lists for turrets - effect should be the same 
- misc minor changes 

image_tool is a stand alone utility that will make it easier to position objects 
and get relative positions 

a LOT has changed here, so there are certainly bugs to workout 

----------------------------------
Dec 17 2024
- minor cleanup and fixes 
- hit markers now get transferred to vehicle wrecks on vehicle death 

noted that bandage/medical usage is automatic for the player 

----------------------------------
Dec 15 2024
- large rewrite of vehicle collision logs to support more data 
- you can now turn on hit markers from the debug menu 
- added a debug option to kill all other bots (very useful for testing)
- fixed new bug in graphics_engine image rotation handling 
- fixed rg42 grenade image size

I've been wanting to do hit markers for a long time. 
I'll add more data to them in the future.

todo 
- vehicle collision logs should be copied over to wrecks 
    - probably about time for wrecks to be custom objects 

----------------------------------
Dec 13 2024
- ai_human now refills equipment slots from inventory when equipment is dropped 
- optimized human menu 
- grenades now have a limited collision ignore list on the initial throw 
- enabled tactical ai tactical orders for civilian squads 
    - not sure what impact if any this will have 
- added more error handling and fall back options to ai_tactical tactical orders 
- per render image center calculation replaced by wo.image_center - which is also rounded to one sd 
- added a try except block to catch a uncommon image rotation exception 

current event_add_inventory will drop your current anti-tank or gun if you 
pick up a new one. I will have to think if it would be better to allow 
multiples of these in inventory. 

grenades now should be less likely to deal team damage as they will pass through 
(throw over) nearby team mates. However with the short throw distance collateral damage is 
still likely. 

getting more errors from tactical ai now. i think it is because civilian ai 
gets tactical orders now - but it has exposed some logic issues that i had to add 
catches for. the tactical ai tactical orders sysem is honestly not bad - i just need 
to add some data explaining wtf it is doing to the human 

made another attempt to rewrite image rotation to not use subsurface, but once again it was not working. 
I had gotten a crash with a image subsurface error. I will have to check the new images, maybe one of them is 
not square. For now a try/except block is a good idea. 

todo 
- tactical orders should only go out over radio 
- squads need a unique name to identify them (this then needs to be incorporated in radio orders)
- using money for transactions 
- human spawning 
- add more functionality to the logging function 

----------------------------------
Dec 12 2024
- grenades now have flight time and fuse time as seperate items 

todo 
- support having/using more than one grenade 

----------------------------------
Dec 11 2024
- work on support for helicopters
- fixed a error with unique civilians that didn't follow the naming standard

the drache can be spawned from the debug menu. the rotors spin when the engine is turned on. 

----------------------------------
Dec 10 2024
- working on adding a FA 223 Drache

----------------------------------
Dec 09 2024
- added 7.63 Mauser projectile 
- added 7.65 Browning (32 auto) projectile 
- added C96 pistol 
- added C96 "Red 9" pistol (9mm version)
- added soviet rg-42 grenade 

i drew the pistol by hand instead of using a diagram or photo  as i've done 
with the other guns. Any new objects (including guns) are done to scale so 
everything is going to kinda look like crap. The small items are just too small.

I tried to research grenade and pistol usage and distribution in WW2 but 
I didn't finy anything useful I generally get the impression that pistols 
would have been fairly uncommon. truck drivers are probably more realistically 
armed with a rifle. I'm unsure on grenade usage. Certainly a ton were produced

----------------------------------
Dec 08 2024
- fixed a possible vehicle wreck duplication bug 
- added human menu dialog for antitank weapon 
- changed render level for blood splatter and container
- gave buildings a dynamic render level 

buildings now cover things that they logically should 

todo 
- make wrecks towable 

----------------------------------
Dec 07 2024
- turrets now stop firing if they are at zero health 
- vehicle penetration logs now include the side that was hit 
- turrets now stay when the tank dies, but their health goes to zero 

In yesterdays playthrough i took a screenshot that appeared to have a turretless tank. 
I thought this was a turret that had reached zero health and been removed from the game, 
but there actually isn't any code to remove turrets, so it remains a mystery.

todo 
- need a way to display dead turrets

----------------------------------
Dec 06 2024
- fix a lot of bugs from the last session
- fixed error with 'climb onboard' dialog action
- fixed campaign load error with bank accounts
- increased the amount of starting campaign forces
- fixed spelling error with kubelwagen destroyed image 


campaign needs so much work.

----------------------------------
Dec 05 2024
- updated map grid to be 12x12 from 10x10
- updates to the strategic map unit movement code 
- vehicles now get a faction prefix 
- a ton of code restructuring 

I made some initial moves to make factions more dynamic and less hard coded. 
This could allow the introduction of more factions. 

specific faction object lists were removed from world along with 
is_[faction] flags from world_object 

realized there is a problem indentifying what a map object is and who it belongs to. 
will either need to add more data to map objects, or keep a list of 
world_builder_identities for soldiers/vehicles/etc for each faction 

todo 
- handle what happens on death when there is no one left to spawn as 
- add campaign specific data table 
- add a permanent faction selection to the campaign 

----------------------------------
Dec 04 2024
- working on save/load for strategic_ai data 
- minor strategic_ai restructuring / updates 
- added a larger variety of squads to the start of the strategic campaign
- strategic ai now has bank accounts 

I'm tending to replace arrays with dictionaries as I rewrite 
code for things where i need to reference a specific item by a key 
word. 

todo 
- add a economy/money growth aspect to ai_faction_strategic.advance_turn
- rewrite world_builder squad_data to use dictionary 
- rewrite ai_faction_strategic.buy_and_place_units to use bank accounts 
----------------------------------
Dec 02 2024
- added a german recon squad with the new kubelwagen 
- added a squad for the RSO vehicle 
- added 'type' field for squads (not used yet)
- added some stuff to the roadmap 

----------------------------------
Nov 30 2024
- fixed a error with table names in campaign creation

----------------------------------
Nov 29 2024
- more save/load work
- started work on a new kubelwagen model 
- added new art for the kubelwagen
- bug fix 

I did a camo and no camo variant for the kubelwagen. 
amusingly there are no squads with a kubelwagen at the moment, so it doesn't
show up unless you spawn it.

NOTE - campaign mode is broken at the moment 

todo 
- faction strategic ai save/load 
- faction strategic ai bank account
- add squads for rso and kubelwagen and anything else im forgetting  
- fix error with new campaign creation
----------------------------------
Nov 28 2024
- working on save/load of the bank code 

----------------------------------
Nov 27 2024
- started work on adding banks, bank accounts, and global exchange rates 
- modified the save file format to hold more data than just maps 

todo 
- saving banks 
- bank ui 
- faction_strategic bank account + interaction 

----------------------------------
Nov 26 2024
- fixed a crash when the player tries to change vehicle roles 
while exiting 
- added a flag for passenger compartment ammo racks 
- minor vehicle damage adjustments 
- minor cleanup

passenger_compartment_ammo_racks is True for tanks. 
This results in a chance of extra damage on a passenger compartment penetration

play test notes 
- confirmation of a 14.5mm hit taking out a sd.kfz.231 
- confirmation of a HEAT hit (panzerfaust) taking out a T34-85


----------------------------------
Nov 25 2024
- added a transmission to vehicles 

gear selection is in the engine menu for now.
I went with a very simple drive/neutral/reverse solution for now. 
this is mostly for the player - reverse would be a tricky thing for 
the ai to handle. 

----------------------------------
Nov 24 2024
- turrets are now deleted when the vehicle is destroyed 
- added the ability for vehicles to tow other vehicles. 

Get close to a vehicle while in a vehicle, click on 
the vehicle you want to tow and choose tow (only shows up if you are close)

towing is pretty crude at the moment. 

todo list
- new kubelwagen 
- reload from loose ammo in inventory 

----------------------------------
Nov 23 2024
- updated vehicle display to show diesel volume 
- turned the terrain system back on. defaults to a slighly different version now 

currently the terrain is a 500x500 image that is mostly transparent with some semi-transparent 
blotches.this image is added about 2500 times in a grid with each one having its location and 
rotation randomized. this is ok but not a lot better than the old system of 1024x1024 solid 
images in a grid. 

not happy with the options for terrain. will have to come back to this

----------------------------------
Nov 22 2024
- added remote_operated flag for turrets 
- added extra human damage from large projectiles 
- added a more complicated armor penetration calculation 
- added support for spaced armor 
- dirt, blood, and shell casings now self remove after a period of time.
- minor bug fix and cleanup
- updates to ai_human target identification 
- added a t34-85 (uses the t34 hull)

the t34-85 turret does not feel like i have it centered right. 
rotation is not perfect. 

added the t34-85 pretty late so it is not play tested yet.

dirt, shell casings, and to a lesser extent the blood sprites were really clogging 
up the engine on large battles. instead now they self remove after 2 minutes or less.
that is still enough time that object cleanup might trigger, but it is less likely. 

remote operated turrets do not result in the gunner being injured on 
penetration. they are pretty rare in ww2, mostly showing up on a couple 
late war tanks such as the hetzer

armor slope has less of a crazy effect on armor now. it probably needs a little 
adjustment up, but now it has an effect without making things invulnerable 

support for spaced armor is now in. vehicles like the panzer 4 h have pretty much 
full spaced armor on the turrets and the sides, whereas the hetzer has the 'skirt' on 
the vehicle body but not the upper part (represented as passenger_compartment_armor)

for now spaced armor just adds to the regular armor, but in the future it could have 
an extra effect on some projectile types.

play-test notes 
- actually seeing a decent number of 251s getting killed by t34s.

----------------------------------
Nov 21 2024
- added jadgpanzer 38t "Hetzer"
- armor now has thickness and slope 
- changed reload code to use world_builder_identity as 'name' 
for some objects is a display name 
- updated collision log data to include projectile type 
- made the background color a little darker 

note - code that looks for things by name should use world_builder_identity 
which is a game engine name, vs 'name' which is a pretty/display name 

armor slope is too effective for some stuff at the moment. 
The hetzer rear 20mm armor sloped at 60 is impenetrable to the t34 

todo 
- schurzen armor pen code 
- remote mg turret code 
- disable shell casings for internal weapons 
- more sensible armor slope effects

playtest notes 
- still haven't seen any panzerfaust launches 
- while driving player altitude is >zero 
- should probably just remove the dirt piles from bullets. they slow the game down for little benefit 
- human damage should be upped for large caliber shells. 
- a unarmored truck bounced a 7.92 bullet at about 1700. need to think about whether we want this or not 
- diesel fuel tanks are not displaying fuel levels correctly 


----------------------------------
Nov 20 2024
- added code to support different background colors for different game modes 
- disabled terrain system for now
- added diesel as a in game object
- adjusted stats and added correct engines for several vehicles 
- added ptrs-41 AT rifle, and soviet AT squad 
- changes to squad builder and world_builder so ptrs-41 is recognized as a AT rifle 

the RSO and t34 are now diesel. I've never run out of fuel but it is possible..

terrain system will make a come back at some point
my thought is to make the tiles semi transparent to add texture 
and color, but with random rotation and placement so it doesn't create a pattern 

ptrs-41 is the answer to the German armored half tracks. It penetrates them easily 
and will destroy them in a 2-3 shots with the current damage system. 

notes
- consider whether fuel needs to be its own object type 
- going to need some code to keep AT rifle soldiers from spending all their ammo on infantry 

----------------------------------
Nov 19 2024
- fixed strategic map square spacing 
- load_magazine now supports specifying a ammo type 
- added a larger projectile sprite for 15mm and up 
- ignore list for projectiles now factors in turrets/vehicles/passengers
- soviet 37mm now has 5 magazines of AP shells 

i think the strategic map got broken by the new default zoom.

the new projectile sprite is not super visibly different from the old one. 
I guess it moves too fast 

I managed to shoot myself while firing a mg turret in a moving vehicle. 
I think this is fixed now 

----------------------------------
Nov 18 2024
- fixed typo in ai radio operator code 
- added explosion and fire sprites 
- vehicle death now has explosion/fire/flash/smoke combo 
- bumped vehicle damage post penetration up significantly 
- upped heat jet penetration. every vehicle will be vulnerable to it.

I had planned on implementing a new vehicle damage model today, but I concluded that the 
vehicle internal components are not finished enough yet. so for now its still a lot of random 
damage. damage should also be based on projectile energy - but this may need some projectile data changes 

----------------------------------
Nov 17 2024
- added a counter for panzerfaust launches
- minor cleanup
- fixed some extra spaces in squad data 
- re-organized the quick battles 

play test notes 
- larger guns need to feel more significant 
    - smoke ?
    - need better effects when a vehicle is penetrated 
    - larger caliber shells should do some actual damage 
- need explosion as an effect 
- need persistent smoke/fire 

----------------------------------
Nov 16 2024
- added t34-76 model 1943 

there is a growing backlog of vehicle stuff to do 
- engines 
- exhaust placement 
- performance tuning 
- specific gun / shell stuff 

----------------------------------
Nov 15 2024
- misc ai_human changes around engaging enemies 
- ai will now do a pen check 
- targetting a human in a vehicle will now switch to targeting the vehicle 

I thought the ai could target vehicles but I guess it was just shooting at humans in 
the vehicles the whole time. whoops. this would explain why panzerfausts are never fired 

I need to research soviet anti-tank weapons, especially hand held options 

----------------------------------
Nov 14 2024
- firing code rewrite to reduce computation and complexity 
- switched the terrain up to a light colored terrain, not sure which i prefer

theoretically the ai should now be able to lead moving targets 
perfectly. haven't seen enough engagements to know for sure yet 

todo 
- soldiers don't seem to be engaging at mid->far ranges 
- soldiers with task_engage_enemy who have run out of ammo just sit there ( maybe close 
enemies causing a decision loop overruling any get ammo function?)
- consider having bullets ignore vehicles if they aren't targeting them to resolve the 
invulnerable vehicles infinitely blocking bullets issue
- consider replacing current terrain system with a flat background color + random distributed 
random rotated semi transparent textures 

----------------------------------
Nov 13 2024
- added in error handling on world load for unrecognized objects 
- added a target health check to the basic vehicle gunner action 
    - this will prevent the gunner from excessive fire in between think turns 
- updated spawn code for when a player takes over a bot in a vehicle 
- minor fixes / cleanup 
- large storage_menu rewrite - now handles infinite items and is 
less confusing 
- you can now add large pickup items to storage 

this update finally gets the storage menu up to the point where it 
is actually decent if you have more than a couple items. 

being able to put large pickups in storage means you can drive around 
with a vehicle and grab a bunch of fuel cans or ammo boxes, which is a 
nice role play feature.

----------------------------------
Nov 12 2024
- added the Raupenschlepper Ost (armored tractor )
- adjusting all in-game speeds to more closely match 
real world speeds 
- projectile flight time is now calcuated (range/speed)
so it should more accurately reflect range 
- adjusted all weapon ranges to match a realistic weapon 
engagement range
- projectile speed way up to 1000. this is about as fast 
 as they can go and still reliably hit things 
- added max_offroad_speed for vehicles 
- made a update to ai_human update order to prevent actions after death
- misc ai_human changes to try and fix any possible memory state bugs around vehicles
- minimum visisble scale is now a per world_object variable 
- most objects are no longer visible past 0.4 zoom 
- added a couple of levels of zoom in and one level of zoom out 
- game now starts at max zoom in 
- expanding the world.run_self_debug code 
- rewrote a lot of ai_human stuff around vehicles and projectile collision handling 
- added 'game_unit_conversions.txt' with conversions for some game units to real world units 

most small objects now have a minimum level to be rendered. 
this means at high levels of zoom out a lot of the small objects aren't drawn, 
which helps frame rate a lot. 

all vehicles got real speeds - but that was way way too fast. 
I realized that in reality offroad nothing is going faster than 
about 15 mph (based on my experience when i had a jeep) so 
everything is capped at 15mph offroad now - and everything 
is currently considered offroad 

I originally upped the rifles to 200 yards, but this range 
exceeds the radius of the viewable area when zoomed out to the 
max, so it would make the game unplayable. 

the new ranges are (imo) practical ranges with iron sites 
based on my own experience. Sure you can shoot with irons 
out to 300 but past 100 or so a man sized target really gets 
covered by your iron sights. Realistically WW2 era iron sights 
were abysmal compared to modern alternatives.
--
rifle and mg : 100 yards 
assault rifles : 75 yards 
submachine guns : 50 yards 
pistols : 25 yards  
--

projectile speed went up from about 300 to 1000. the difference is 
astounding. firearms have a completely different feel now. bullets are 
almost unavoidable and the vehicles with weapons are incredibly dangerous.

todo 
- need to add specific engines for some recent vehicles 
- ai isn't engaging enough with the new distances. especially at mid and far 
    -- this may be fixed with some late edits, need to test 
    -- note seems to be still an issue with mid and far engagement 
- persistent issues with dead humans not exiting vehicles
    -- this may be fixed now. needs more play testing 
- seems to be an issue with world_area control. 
- vehicle gunner does not detect when a target is dead fast enough 
- large amount of friendly fire - consider changing friendly fire settings 
- need to look into what happens when trying to load a map object taht doesn't have a defined world_object 
    -- example 'wreck'
- need to add some variance to aiming. maybe based on skill level 
- need to add bursts to automatic weapons (if that isn't in there anymore)
- check cyclic rate - seems slow? 

----------------------------------
Nov 11 2024
- implemented collision log for humans and vehicles 

----------------------------------
Nov 10 2024
- added the t20 armored tractor 
- modified vehicle armor pen so that only passengers can get 
hit in the passenger compartment 
- added t20 and the 37mm autocannon to some of the quick battles 
- added t20 squad
- started a art folder again for GIMP native files

the T20 armored tractor has a open passenger compartment. 
this is modeled, so the crew will get shot off easily if it gets into combat. 

note - t20 engine isn't modeled yet. its performance needs to be adjusted 

todo 
- vehicle gunners arent checking range enough 
- reduce player steering wheel sensitivity 
- t20 tuning 
- more detailed vehicle projectile hit data 

----------------------------------
Nov 9 2024
- added debug info for vehicle and human angles 
- large collision / armor rewrite 
- vehicle body armor added 
- vehicle passenger compartment armor added 
- turret armor added 
- collisions determine what side you hit
- added self_debug function to debug menu 
- added 'destroyed' art for the truck and 231
- added some dirt shading to the kubelwagen 

the new collision side detection works well enough for now. 

With the new changes there is a chance to hit the sd.kfz.231 turret and 
if you hit it from the rear you will be able to shoot the gunner in it. 

armor is now top/bottom/left/right/front/rear although top/bottom are not 
used yet. armor is also split into vehicle/passenger compartment/turret 
allowing the modeling of vehicles with unarmored passenger compartments 
that still have some vehicle armor. what you hit is random for now.

todo 
- humans need to take into account helmets 

----------------------------------
Nov 8 2024
- reorganized human menu text 

----------------------------------
Nov 7 2024
- switched to a multi layer image cache with a cache 
for each zoom level to increase speed when the cache gets large 
- bumped up human collision radius to 15 for more reasonable bullet collision 
- added faction choices to the respawn menu
- reduced possible wait time for tactical orders to try and speed up the start of the game 

seeing a bunch of absurd misses so bumped human collision up a good bit and 
now things that look like they will hit will hit, and misses will miss. 
Note that prone still has a 50% miss chance 

not sure that the multi level image cache actually makes a difference 
but it was getting up to 90,000 objects on the new ultra large game 
so it seems reasonable to think that its worth having one per zoom level.

I also removed the option to disable the image cache. zero reason to disable 
it. 

todo notes from playtest 
- mp40 has a white outline that needs to be cleaned up 
- saw a kubelwagen with a german and soviet in it. german was a radio officer
    this should be impossible 
- troops firing and bullet proof vehicles should be fixed 
    - i don't want it to be zero because it looks cool, but they should have some 
    armor penetration awareness 
- when you spawn as a bot that is in a vehicle the ai memory needs to be adjusted to the correct vehicle player one 
- human menu text needs some organization and cleanup 

----------------------------------
Nov 6 2024
- reduced the amount of sparks from armor non-penetration 
- increased spark speed 

----------------------------------
Nov 5 2024
- bodies are now large_human_pickup so you can move them.
- passengers should now take over if driver goes mia for some reason 
- fixed a error in the ai turret reload code 
- added the use of medical items back in to human ai 

----------------------------------
Nov 4 2024
- added soviet squad for the new 37mm auto-cannon 
probably need to add 'type' and 'rarity' to the squad list 
- added several choices for the 'Quick Battle' menu option 

The new ultra large quick battle is actually great.
excitement guaranteed 

todo notes from play test 
- if a driver exits a vehicle nobody takes over 
- human bodies should be large pickups - currently they are small pickups (?)
- not positive that the ai turret gunner is reloading. seems like they are not 
- maybe should get an option of who you want to spawn as when you die 
- possibly make a render cache for each zoom level. render cache in my large 
game is 89,000 objects 
- task_engage_enemy with zero ammo seems to be a loop/freeze up.
- need to check if the ai can stop bleeding 
- reduce amount of sparks from hitting the sd.kfz.231 and speed them up a bit 
- squad leader with zero ammo. might not scavenge gun ?

----------------------------------
Nov 3 2024
- bugfix 
- adjusted render levels so turrets don't cover up humans in vehicles 
- added a simple reload to vehicle gunner 
- added two new projectile types for the soviet 37mm

I need to add a couple contact damage types
- frag for AA 
- high explosive 
- incendiary or maybe HEI 

I need a way to give vehicles a mix of ammo types. currently there 
is not a way to specify what ammo is in magazines. also need the ai to 
be able to switch ammo and understand ammo (might be a bit of work)

----------------------------------
Nov 2 2024
- working on adding a Soviet 37mm AA gun 

I figured a towed gun would be a good next step. 

towed guns are going to be a vehicle + a turret 
so that limited traverse without moving the whole assembly 
can be modeled. this also allows them to be crewed with minimal 
changes to the vehicle_crew ai 

----------------------------------
Nov 1 2024
- bugfix from the last couple updates 
- rounding angles for vehicle gunner fire decision to make it more likely
- added a tactical_ai think trigger at the end of squad creation, but it didn't seem to help 
the slow start.
- after some tweaks confirmed that turret gunners now work !!, although more often than 
not it does not fire (angles?)

for some reason it takes the germans a REALLY long time to get started.
The Soviets consistently beat them out of spawn. idk why, it should be the same for both sides 

i triggered a odd error when a mouse select somehow passed in a NONE to generic item menu (or selected_object.name was none),
but that doesn't seem possible. was unable to reproduce 

seeing the sd.kfz MG34 turret in action was pretty neat. the gunner doesn't communicate with the driver 
at the moment, so I saw one sd.kfz do basically a driveby spraying down of a Soviet squad as it drove 
through the middle of it.

I'm not seeing as much turret movement or firing as I expected, I suspect the angle checking is 
wrong in some way. I really need to make a vehicle with a bigger turret so this is visually easier 
to troubleshoot. The sd.kfz turret is barely visible (i could probably adjust the art a bit)

todo 
- check if vehicle gunners can do a reload. probably needs to be added 

----------------------------------
Oct 31 2024
- working on vehicle gunner role 

theoretically all the code needed for vehicle gunners to pick targets 
and fire is in now. the code determining if the turret can actually rotate 
enough to engage is probably wrong. 

this is going to be hard to test and tweak so i'll put that off for future 
andrew to deal with 

----------------------------------
Oct 30 2024
- added some code to have vehicle passengers bail out 
when they detect near enemies. for now driver/gunner/radio stay in 

this one is going to be tough. what is optimal here? 
I put in a armor check - no need to bail out of a half track as 
their armor is rated against small arms (although probably won't stop a .50 
- but those aren't in game yet).

I need to observe more vehicle fights, might have to tune the quick battle 
for that. 

----------------------------------
October 29 2024
- added the rest of the code for sending/receiving radio messages 
with the radio_operator vehicle role 
- reshuffled how world_radio channels are created due to a chicken-egg issue

radio flow is 
if you want to send a radio message drop it in the squad send queue. 
A radio operator will grab it and send it 

if you want to receive a radio message just monitor the squad receive queue 
the radio operator monitors the radio and drops messages there 

note - tactical AI can't receive at the moment. it needs a radio operator i guess 

----------------------------------
October 28 2024
- added radio_operator role for human ai

the radio operator role is fairly close to being done, just needs 
the code for sending/recieving messages. recieving is really just 
doing a bit of sorting and then forwarding on to the squad queue for 
the squad lead to review.

----------------------------------
October 26 2024
- added fuel tank data to internal vehicle menu 
----------------------------------
October 25 2024
- added battery info to vehicle engine menu 

----------------------------------
October 24 2024
- gave faction tactical ai a radio 
- radios discharge battery when turned on now 

puzzling over how to get the factional tactical hooked into 
radio comms and the easiest way was to just give it an actual 
radio object. I have a feeling once human ai can use a radio i'll 
end up just giving tactical ai a human to operate the radio. 

todo
- electric battery charging 
- vehicle electric system info display 

----------------------------------
October 23 2024
- fixed error with player switching to vehicle gunner role 
- fixed errors in player turret reloading 
- added options to change volume and frequency in radio menu 
- added world_menu module to manage radio channels and transmissions

I guess player turret interactions have been broken since the 
AI rewrite. Thought I had tested that already.

did a good chunk of work towards getting radios working. 

todo 
- radio operator job role 
- radio text in world gui 

----------------------------------
October 22 2024
- added hangar art and object 
- added hangars to airfield generation 
- resized runway in airfield generation
- fixed some errors with the airplane controls 

----------------------------------
October 21 2024
- gas and water were AIProjectile for some reason. fixed 

----------------------------------
October 19 2024
- toned down concrete squares a bit to reduce tiling effect 
- added a basic runway for airport tiles 
- changed strategic mode tile decorators back to black text 
- fixed issue with civilian squad list 
- minor cleanup
- added the concept of a budget to the strategic mode ai 

maybe instead of a 'next turn' button in strategic mode, time 
passes when you exit/enter a map. that would make things play out 
at a better pace. 

also instead of battles auto resolving completely they could just partially resolve 
and take several turns to finish 

todo 
- need to create a hangar for the airport 
- need to create some railway tracks 
- check whether civilians will move from rail yards. they should probably move randomly, or 
maybe just migrate to towns 

----------------------------------
October 16 2024
- readme updates
- minor cleanup

todo 
- check/fix civilian squad lists 

----------------------------------
October 15 2024
- adjusted the minimum view adjustment so terrain tiles don't pop in and out of view 
at the default zoom level.
- rewrote the terrain system to just be brute force. no more weird jumps and resets
- rounded cache keys to one decimal point instead of two to increase cache effectiveness 

The terrain ends at about 24000 in any direction currently. I can probably bump that 
out a bit but eventually the engine just has too many objects in it and begins to 
bog down doing simple things. 

At some point I will want to create some sort of oct tree so that I only have to render 
cells that are near the player, although once object count gets up around the 20k range 
I'm guessing even just cycling through a for loop will start dipping under 60 frames a second.

I could also look at splitting rendering and updates into seperate threads, although in python 
I'm not sure if that is helpful or not 

for the cache - i need to look into whether whole numbers are good enough for rotation visually.
the actual numbers are generally two decimal digits - which is probably plenty for rotation calculations 
unless if you are aiming at something far away. i went to one decimal digit and it seems fine, but one 
digit after the decimal still means 360*10 images that need to be cached for each image at each zoom level.

to some degree the cache works just because when a object is moving and NOT changing rotation the image gets 
cached the first time its needed and another image isn't needed until the object rotates, which could be some time. 

so i either need to take the image cache down to whole numbers, or maybe just reset it when it gets too big - but 
how big is too big? idk. It gets over 20k fairly easily 

----------------------------------- 
October 14 2024
- remade small_dirt to make it visible with the new background
- remade panzerfaust warhead to make it visible with the new background 
- fixed error when you reload (r) with no weapon 
- fixed incorrect 80 degree angle for concrete square (should have been 90)

Some of the textures will need to be done now that there is terrain texture - however 
this is not a high priority as the terrain texture system is kind of a hacky placeholder 
and will need a complete rewrite when i feel like it - almost certainly resulting in some 
different ground cover colors.

----------------------------------
October 13 2024
- added a image cache 

the image cache gets huge because there are so many possible rotation angles.
i could cut rotation down to one number after the decimal instead of two, but I play tested 
for a bit and the image cache got up to 50,000 without any noticeable negative effect. 
I imagine the key hash search even at that size is still a lot faster than reszing and rotating 
an image.

the image cache does fix the lag issue with large images, and it seemed to smooth out frame rate a bit.

i tried a couple different ways to rotate and scale images, but none of them worked right so 
i'm stuck with the clipped corners of the current setup for now. 

i noticed that the terrain still bugs out a bit at the closest zoom level. terrain needs some love,
and probably the zoom levels need some love as well 

----------------------------------
October 11 2024
- fixed a bug with the grid spawn system 
- added a concrete square 
- working on a column spawn for runways 
- improved the code that finds optimal column counts 
- added some concrete squares near warehouses with a random chance 
- towns are now generated at a 90 degree angle 
- minimum view_adjust is now zero
- added a really hacky ground_texture system 
- updated menu text to white in world mode 

need to maybe add another z level to differentiate between the concrete and buildings 

todo:
- write a better texture system
- zooming in and out has a huge lag spike now. I'm guessing resizing the large ground textures must 
be slow. this needs to be optimized. can probably do one and re-use 

----------------------------------
October 9 2024
- minor code cleanup 
- fixed civilian names being overwritten 
- added back in a chance to spawn unique civilians big_cheese and shovel_man
- added a civilian squad so civilians can replenish if there happens to be a 
neutral square with a rail head 
- fixed repeating text bug with human storage_menu
- added random consumables crates back into clutter generation 

----------------------------------
October 8 2024
- fix for possibility that there is no squad data 

----------------------------------
October 7 2024
- working on buying and placing new units in the strategic turn 

----------------------------------
October 5 2024
- added advance turn on strategic map 
- added auto resolve battle 
- added in some dynamic invisible world areas so that there is something to fight over on 
empty maps. 

empty maps are an issue. i need to start adding some plants and terrain so maps without towns aren't so boring.

the algorithm for strategic map moves isn't very interesting. it probably needs to be smarter, and 
we might need more map squares. it is a good start anyways 

the auto battle ressolver is terrible. it is just a place holder until i get around to making something 
that makes sense. 

once i add in the ability for the strategic ai to buy and place new units the map control will probably 
get better. 

----------------------------------
October 4 2024
- working on loading saves 
- removed extra spaces from save data 
- added turrets to the list of things that don't get saved 

saving and loading campaigns technically works now as far as i can tell. 
save/load is turned off for quick battles. i think eventually the quick battles will be just 
a pre-baked campaign saved at the point where a fight is going on, but for now it is different 
enough that it is not worth setting up save/load for it. 

todo 
- rewrite how objects exiting the map are handled (currently they are removed from wo_objects, so they are not saved)
- 'turns' on the strategic map 

----------------------------------
October 3 2024
- working on the world -> strategic map transition
- added some options to exit the game
- started work on campaign loading 

the transition between world and strategic map now 
works in both directions.

----------------------------------
October 1 2024
- fixes for edge cases where the ai could accidentally take control of the player 
- randomized spawn position a bit to reduce clumping 
- randomized the squad destinations a bit so squads aren't stacking up on each other
- set squads initial destination to the spawn point, fixing the odd [0,0] battles that were happening 

turns out the squads all has a default destination of [0,0] which wasn't being updated, so they all 
went there which is why everything was walking/fighting/dying in a straight line.

civilians used to be in squads of 2-3 and are now in squads of around 6. will have to think which i prefer. 
also need to look at the code again and see how much civilians use the squad system 

----------------------------------
september 30 2024
- fixed debug text issue on death
- minor code cleanup 
- added 4000 to all starting positions to give a little more spacing 
- some town generation tuning 

had fun playing in tactical mode again. i'm not 100% sure why but battles always start with both sides 
bee-lining for the town that is usually at [0,0], resulting in a huge mess as they robotically walk right 
into fire. i think on the previous quick battle setup there were a bunch more objectives and the germans didn't 
get vehicles at the start so the action was more gradual. 

I do need to do something to randomize the coordinates that squads go to a little. otherwise it looks silly.. 
also needs to write in some code to early eject from vehicles when the enemy has already taken a point. driving direct in 
if you have a unarmored truck is a disaster. the armored half tracks have other issues as they are one of the few things in the 
game that is bullet proof to small arms. 

todo 
- need to fix issue where the ai sometimes controls the player character 

----------------------------------
september 28 2024
- working on 'quick battle' mode 
- general bug fix 

well quick battle is now working. It is similar to the the old 'quick battle' option, which was really 'load test scenario'.
However now it is using the auto world_area generation which seems significantly worse than the old town generation, and 
town placement. 

town generation needs to be tweaked heavily, and it seems there needss to be more world_areas for the tactical ai to work 
properly. Right now the battles are not good at all, just a pile of troops basically colliding with each other. 

it has been about two weeks since i last merged into main, and now that the new campaign mode and quick battle options both 
"work" i think i will get this merged. 

note - campaign mode isn't playable as there is no way to advance between maps. just available as a preview

new bugs 
- sometimes the player character is ai controlled for unknown reasons 
- death screen has issues with the debug text scrolling

todo 
- update town generation so the buildings are closer together 
- add more world_areas 

----------------------------------
september 27 2024
- working on strategic mode -> world mode transition 
- created squad_builder.py 
- fixed bugs 

unfortunately the carefully researched squads I had created have mostly been replaced 
with the old auto squad generation system. squads just didn't make sense past the world 
level because you would wnat to rebalance them after every fight, and it would have been 
complicated to jam it into the map_object saving system. The old squads are still used for 
placing initial troops, but once the world is loaded the troops will be auto-sorted into new 
squads.

you should now be able to start a new campaign, choose a map with units, and spawn as one 
of the units now (in dev branch). 

A TON of code has changed so the world doesn't look like it used to. Town generation has 
changed for the worse - I created a new grid system which means buildings aren't overlapping 
anymore but it looks terrible. needs a rework. 

the campaign maps are pretty empty and dull right now. that is one area that needs a ton of work. 

the campaign also can't progress - there is no way for troops to move maps - so there will never 
be any conflict. this needs to be fied but its a big feature - will probably wait for a bit.

I'd really like to merge this but I think I need to create a 'quick battle' system first to 
mimic what we have in main.  

----------------------------------
september 26 2024
- working on saving to sqlite
- bug fixes
- updated *Grenadier to *grenadier 
- strategic map menu updates 
- working on world loading
- rewriting worldbuilder code to work with the new world loading 

----------------------------------
september 25 2024
- working on civilian spawn generation
- working through all the code needed for starting a new campaign

I kinda underestimated how much of a slog it would be to get to the point 
where the strategic layer was working. I feel like I've done a lot but there 
is a lot more to do. 

----------------------------------
september 24 2024
- more work on map feature generation 

----------------------------------
september 23 2024
- work on world_object save/load to map_object 
- work on map feature generation
- added towns as a 'big deal map feature' and to map as 'T'
- world_build.grid_spawn -> math_2d.get_grid_coords

todo next
- finish feature generation
- work on saving mechanism
- work on loading mechanism
- remove the old squad system and shift over to creating squads on world launch 
- have the strategic ai pick random squads to put on the map
- rewrite world.process_reinforcements
- rewrite world_menu.debug_menu -> spawn squads 

----------------------------------
september 22 2024
- finished squad data to the sqlite database 

----------------------------------
september 20 2024
- finished world_builder.load_sqlite_data (for now)

----------------------------------
september 18 2024
- set inital map square faction ownership 
- started working on replacing the pre-build squad system 
- started creating squad_data database table 

realizing that saving pre-build squads is not really going to work. 
they would have to be reformed after every battle to balance out losses so i 
really just need to organize squads AFTER everything spawns into the world.
This means going back to the old squad creation method.

todo next
- finish writing world_builder.load_sqlite_data
- finish populating squad_data table 
- remove the old squad system and shift over to creating squads on world launch 
- have the strategic ai pick random squads to put on the map

Note - lots of changes here. dev will probably be broken for a couple updates 

----------------------------------
september 17 2024
- added random initial assignment of rail_yards and airports 
- rail_yards (R) and airports (A) get a letter on their map square
- flipped the x/y of the grid so letters are columns

Amusingly I noticed that letters are rows when I envisioned them to be columns.
Fortunately all I had to do was flip the x/y coordinates. This is not the first 
time this has happened - I think there is something fundamentally backwards about my 
game engine.

currently rail_yard and airport don't actually do anything. I'm thinking they will be origins for 
reinforcements, as well as having a lot of unique map objects 

todo next 
- assign initial faction squares
- make squares the correct color for their faction 
- initial unit assignment (this is a big task)

----------------------------------
september 15 2024
- starting work on ai_faction_strategic 

I always pictured strategic mode as being really really big, but 
at the moment it is shaping up to be kinda smaller feeling. I guess I haven't measured 
the relationship between in game units and distance yet so I'm not sure how big a map is. 

I think the maps will be pretty large, but if they get too big it is going to be super 
annoying to travel to the end of them - maybe fast travel is needed 

----------------------------------
september 14 2024
- more strategic map work

got the map grid created and loaded from save games.

next step is to spawn the initial units. 

I feel like I should have a central database utility file instead of scattering 
functions all over the place.

----------------------------------
september 13 2024
- working on new save creation 

----------------------------------
september 12 2024
- work on getting the map tiles displayed 

still trying to figure out how this all will work. not much progress

----------------------------------
september 10 2024
- work on adding strategic mode 
- fixed bug with new 'quick battle' menu option 
- added some colored square images for the map 

color scheme is going to be 
grey-german 
red-soviet
blue-neutral 
----------------------------------
september 07 2024
- work on adding strategic mode 

graphics_2d_pygame is becoming the central class whether i wanted it or not (i didn't).
it was meant to be independent but it is the one thing that needs to touch everything.

Note - dev is going to be broken for awhile first. I want to get the strategic map interface 
up and running 

----------------------------------
September 03 2024
- added game_menu
- rewrite/refactor of a bunch of stuff to handle game state changes better 
- finally got rid of the fake player object that is spawned at the start 

realized that player screen position being a calculated value with the world coord->screen coord
translation value was a cause of a lot of the weird lag/jitter in player movement. 
changing this to be a relatively static value that is just the middle of the screen massively 
smoothed out movement. this was a big quality of life improvement 

I decided to keey graphic_engine as a class. I figure anything that has a lot of state might 
as well stay a class. otherwise you have to know about how python modules keep class across a project. 

----------------------------------
August 29 2024
- more work on seperating graphic_engine from everything else 

----------------------------------
August 28 2024
- started working on the strategic map. 
- working on moving graphic_engine out from world to stand on its own, and removing calls to it

still thinking about how the whole strategic side works. for now i realized that i need 
to decouple graphic engine from world, so working on that. graphic engine is the new top level, 
and will eventually have/use a new top level menu. world menu will be for in-world stuff only 

todo 
- finish removing references to graphic_engine from everything 
- maybe rewrite graphic_engine so it is no longer a class ? 

----------------------------------
August 26 2024
- bodies now have names 
- fixed a bug with removing dead humans from vehicles from the last update 
- made a SIGNIFICANTLY better mouse select function 
- minor cleanup
- fixed an error with the medical menu thats probably been there forever 
- gave blood the can_be_deleted attribute so it will be cleaned up if necessary 
- fixed vehicle HUD 

I think most of the functionality is fixed and is relatively back to the level it was 
at before the AI rewrite. The new AI seems significantly better at being aware of danger - 
which was one of the biggest issues with the old system. 

I think I want to do something different next. possibly add a animal.

I'd like to work on the strategic layer because the 3d version of TWE never got there and 
it feels like althoug i've done a ton of work in the last year or so, the game is still basically 
just a small skirmish when it is meant to be so much more. 

One thing that would probably help would be to come up with some sort of documented roadmap.

----------------------------------
August 25 2024
- maybach hl42 engine art for the sd.kfz 251
- maybach hl42 engine object and switched sd.kfz over to it
- fixed two possibilties where the player could accidentally switch to ai control 
- added code to remove dead humans from vehicles (this was missed in the ai rewrite)

i'd like to leave dead bodies in vehicle inventories , but would need to handle opentops like bicycles.
need to add some things to make bodies tell more of a story. probably bring over more details 

----------------------------------
August 21 2024
- lots of tweaks to ai driving 
- fixed a pass by reference logical flaw 
- fixed player reloading
- added some weight to the buildings so they can't be picked up 

there was a large issue with driving that i think was caused by world_coords 
accidentally being passed as a reference - a mistake that i'm likely making in other areas.

I also made some other adjustments to make it less likely for a driver to be paused/stuck, 
and fixed some drifting vehicle rotation glitches. 

vehicle use is a bit more odd with this new ai. i'm not sure what is happening. possibly vehicles are 
getting people from different squads. i need to give squads names to be able to identify when this is happening.

i think i'm more or less at feature parity with the previous ai version so i think i can move on to some new stuff 
and leave the ai tuning to another time. next up may be rewriting squad so that it is a memory. 

some todo things 
- finally add a german half track engine 
- add back in badage usage (if its not there)

----------------------------------
August 20 2024
- fixed position jump when a vehicle you entered moves for the first time 
- fixed a bug where you could end up with a None object for a enemy if 
everyone in your enemy list was dead
- some world menu updates to add debug data 
- added weight to containers for dead humans/vehicles which should mean you 
can't pick them up anymore. 

notes to follow up on 
- player altitude goes >0 when in a accelerating vehicle 
- sometimes vehicles stop when they are full. waiting on someone who is far away??
    - need to add some sanity checks 
- driver destinations need to be sanity checked every once in awhile. especially when the driver changes 

----------------------------------
August 19 2024
- a ton of bug fixing with the new ai code 
- fixed squad vehicle spawning (broken since july 16th ?)
- updated mouse select code to reduce the effect of the massive ju88 collision circle. had 
 negative effect of making tiny things harder to select 

things that need to be fixed 
- when you enter a vehicle there is a screen jump as soon as the vehicle moves - like you have been repositioned.
    - this seems to be new as of the new ai code.
- bicycle riders occasionally go prone and appear to surf when under fire. no idea why 

general todo
- rewrite mouse select to just be a closest distance of all objects on screen 

i might need to look at a way to make movement more precise. there is an issue with small movement being < the fuzzy threshold 
where a movement is considered 'done'. kind of a tolerance stacking issue 

i am real close to just deleting ai_squad and making it a memory instead. 

something happened with small blood spots, they are much more of a trail now. I think I'll leave it for now. 
--
I'm going to go ahead and merge this. There are certainly some bugs waiting to be discovered but it seems to be mostly 
stable, and the new AI seems to be at least as amusing as the old one was. There seems to be some regression in vehicle 
use but on the flip side enemy awareness seems to be a lot better from the couple fire fights i've seen. 

----------------------------------
August 17 2024
- more world_menu compatibility changes 
- added event_speak to replace the 'react_to' functions
- lots of bug fixes 

the new code seems to be more or less working - for a couple minutes at least. 
it needs more debugging to understand if its roughly up to par with the old ai code or not. 

on the positive side the new code doesn't seem to have hurt the frame rate. 

i encountered a new bug where if the kubelwagen and the ju88 were both on the screen the mouse 
would always select the ju88, but when i zoom in so the ju88 is offscreen i can then select the kubelwagen.
not sure what that means - maybe a inherent flaw in the selection code?

things that need to be implemented
- a way to ask ai drivers to wait 

----------------------------------
August 16 2024
- making world_menu compatible with the new human_ai 

----------------------------------
August 14 2024
- added basic support for antitank and grenade throws to the new ai
- added eating as a random action 
- wrote more of the engage enemy task 
- sprinkled in some prone/not prone decision code 

I was planning on doing away with primary_weapon/throwable/antitank but will keep them for now 
and save that for a future re-write. 

main todo items before trying to run this mess 
- need a way to have the vehicle drivers wait for close passengers 
- review what (if any) 'react to' functions need to be recreated 
- world_menu is probably hilariously broken. probably need to go through it line by line and reimplement stuff

----------------------------------
August 13 2024
- more ai rewrite 
- started world_menu updates for the new ai 

old ai stuff that isn't implemented yet 
- eating 
- react_to* system 
- most prone/un-prone decisions 
- grenade throwing 
- anti-tank weapon usage 
- panic state

I think the ai rewrite is within a 2-4 updates of being playable so i'll switch 
back to detailed change logs in the next update. 

----------------------------------
August 12 2024
- more ai rewrite

still making progress i promise 

----------------------------------
August 11 2024
- more ai rewrite

----------------------------------
August 10 2024
- more ai rewrite 

----------------------------------
August 08 2024
-yup more ai rewrite

----------------------------------
August 07 2024
more ai rewrite

----------------------------------
August 06 2024
more ai rewrite

----------------------------------
August 05 2024
- starting massive human ai rewrite 
- guns no longer need to have their update function called 
- vehicles now update the passengers positions (rather than the other way around)
- added a logging utility

the game is going to be broken in the dev branch for a pretty long time I think. 
i'm doing pretty much a complete ai rewrite

----------------------------------
August 01 2024
- added radios to the kubelwagen and sdkfz251
- minor adjustment to the kubelwagen loadout

----------------------------------
July 28 2024
- added spark and flash effects 
- panzerfaust projectile hit has sparks and flash 
- failing to penetrate armor results in sparks 

----------------------------------
July 24 2024
- fixed bug where reload was called twice when player pressed 'r'
- minor restructuring of the reload code to leave a empty magazine in, if there is no replacement
- added panzerfaust_empty art 
- added code so the panzerfaust switches to the empty image when fired 

A decent amount of the german troops spawn with a panzerfaust and there maybe some spawning on the map. 
Theoretically there are a couple code paths that could result in one being fired but I can't say I've 
ever seen it happen. Might have to add a counter or something to see if its being used.

----------------------------------
July 23 2024
- mouse select uses collision radius now instead of a static number 
- fixed a function call error with the panzerfaust launch 
- fixed squad spawning from the debug spawn menu 
- updated the body and dead vehicle spawn so it now has the correct 
    collision radius and volume 

notes 
- noticed a possible reloading oddity as the player. seemed to be unable to 
reload yet the stats from the player menu said I had 20 rounds in inventory 
----------------------------------
July 19 2024
- turrets are no longer selectable with the mouse 
- changed menu text a bit but its still a pain to see 
- reload (r) now works when in a vehicle turret (get in the sd.kfz and change role to gunner)

if you get in a vehicle and switch to gunner it seems pretty common that a team mate will hop in and 
drive you somewhere, which is kinda fun. You will then jump out when they do automatically. 

----------------------------------
July 16 2024
- ai_gun equipper can now be a turret or a human 
- misc code changes for turret gun integration 
- rewrite of the firing code to bring human vs ai code back into ai_human from ai_gun
- guns now fire bullets in the direction the gun is rotated
- bullet spread mechanic removed as the firing code no longer uses position 
- code style cleanup in world_builder 
- large rewrite of a lot of the spawning code 
- removed scenarios 2 and 3 rather than rewriting all of the spawn code for them. will create 
more interesting ones in the future 
- the player can now fire a gun in a turret. it is hard to aim however 

guns now basically fire a bullet down the heading of the actual gun, following how they work in real life 
this opens up the possibility of having guns displayed in the world while in use however most guns 
are not drawn top down 

I ended up doing a large rewrite of the spawning code because with the new turrets we have issues if the 
turret spawns significantly later than the vehicle. this was happening with the old reinforcement system.
While rewriting it I removed the spawning code from ai_faction_tactical and ai_squad 

todo 
- come up with a new bullet spread mechanic 
- some sort of turret aiming gui - maybe similar to how the map works 


----------------------------------
July 11 2024
- working on vehicle role related code 
- minor vehicle menu changes 
- working on turret rotation code 

kind of hard to see it but turret rotation actually works now if you change role to 
gunner in the sd.kfz.251

I don't have the turret firing yet, that is going to be a bit more involved than I initially thought. 
It is the first thing that fires a bullet based on how the gun (well the turret) is aligned.
Also getting the bot to aim turrets might be a bit tricky. 

I need to figure out if i can get more zoom in. i think i was hitting some sort of pygame limitation but need to check again 

----------------------------------
July 09 2024
- removed primary_weapon from vehicles 
- removed gunner role from vehicles 
- added gunner role to turrets 
- rewrite of how ai handles vehicle gunner roles 
- player no longer auto takes over driving if the driver seat is occupied

notes
- consider adding a option for the ai to boot civilians from vehicles 

todo 
- rewrite bot vehicle ai to handle turrets and new ai_vehicle_role string 
- vehicle menu needs to be rewritten to understand the current role and give 
role specific data 
- turret probably shouldn't be selectable.

----------------------------------
July 08 2024
- tweaking some parameters so ai with one spare
magazine doesn't repeatedly try to refill ammo
- added some checks to make sure the obj exists in the world to think_move_close 

----------------------------------
July 06 2024
- made a significantly better angle normalization function 
- started working on turrets 
- added rounding to some vector math, and some angle math 
- fixed a vehicle issue where accelleration could be slightly negative with the engine off
    this made sense but was unintended. brakes should be re-done to counteract and this should be 
    re-enabled 
- deleted deprecated 'art' folder 

i think the rounding and angle normalization changes likely fixed a lot of odd quirks and bugs. 

turrent positioning has a bit of wobble when vehicles are moving. could probably fix by having the 
vehicle update the turret rather than having turret do it itself (potentially before the vehicle updates)
but that would cause other complication.will think on it. should turret really be in the world ? 

notes 
- need to add more mg34 ammo container options like belts 

----------------------------------
July 04 2024
- updated helmet armor values 
- minor updates to wearable variables 
- rewrite of the magazine loading function to hopefully fix a bug 
where magazines occasionally end up way over capacity
- misc cleanup and refactoring in ai_human 
- fixed what i think was causing a replenish ammo loop 
- bumped up the 'can't move because personal enemy' check from 400 to 500 distance
    - this check seems important but also causes a ton of issues when movement is critical

# need to fix this 

debug : getting ammo

  - weapon: mg34
  -- ammo in gun: 50
  -- ammo in inventory: 50
  -- magazine count: 1
debug: big cheese replenishing ammo


now that vehicles are small arms immune this causes issues with excessive blocking of bullets
especially of troops that just disembarked 

the bug with vehicles getting stuck weaving back and forth when the angle is near 360 still exists 

----------------------------------
July 03 2024
- added penetration data at 500 increment ranges to projectile_data
- added armor values for vehicles and wearables 
- rewrite of collision handling and projectile collision decision tree 

I was going to rewrite the projectile passthrough code but decided to keep 
it for now - with the difference that now a projectile has to penetrate in order 
to hit the passthrough check. I think passthrough chances are likely too high overall.

did a hack job on human damage as the armor saves are now calculated in penetration_calculator.
need to think about and redo this section.

----------------------------------
July 02 2024
- updated sd.kfz.251 weight

thinking about creating penetration data in the same way as 
projectile data but didn't get far. 
probably have distances rounded to the nearest 100 and provide penetration 
data out to 1500 or so. 

distances present a issue as the zoom only goes out so far.. 

----------------------------------
July 01 2024
- added the Sd.Kfz.251 half track 
- 'meeting engagement' scenario now has the german reinforcements 
changed from fallshirmjager to panzergrenadier with sd.kfz.251

the sd.kfz.251 is incomplete. for now it basically is a copy of the US GMC truck 
stat wise. It is going to be the test bed vehicle for turrets and the armor system.

----------------------------------
June 30 2024
-added is_pilot skill so the bots stop stealing planes
- added properly positioned startup exhaust for all combustion vehicles 
- added a bool for particle effects so they can have a specific render level 

working with chatgpt to figure out the offset math and i was getting 
nonsense results until i swapped x for y. i must have used something nonstandard 
when i started writing the movement system. interesting 

next 
- model a vehicle that has a turret 
- add a special rare civilian pilot 

----------------------------------
June 29 2024
- radio menu fixes 
- vehicle and radio and radio menu integration 
- misc code cleanup 

----------------------------------
June 26 2024
- added radio menu 

----------------------------------
June 25 2024
- added radio stuff to debug->spawn->misc for testing 
- vehicle gets a (single) radio object slot 
- rearrangement of some vehicle code 

todo 
- ai should probably check vehicle inventory when they dismount to see if 
there is anything they need. ESPECIALLY large pickup objects as those get dumped in 
inventory when they board.
- world_menu vehicle->radio code and/or a seperate radio menu 

----------------------------------
June 23 2024
- radio class 
- feldfunk b and feldfunk battery charger objects

might be best to have some 'pool' of electric capacity that 
electrical systems can use, and then have this topped off by the battery or 
external power. this would be similar to how engines currently work 

todo 
- electrical system updates 
- more radio work 

----------------------------------
June 22 2024
- feldfunk and charger art (german backpack field radio)

----------------------------------
June 19 2024
- added a little variation to world coords when exiting a vehicle to prevent stacking 
- made several changes to how ai_vehicle_destination is set 
- fixed a new bug where a grenade hitting a vehicle would cause a crash 

so i think some of the vehicle oddity was caused by drivers hopping out and being 
replaced by passengers who weren't really sure where they were going. the function that 
kicks off moving towards a vehicle would reset the vehicle destination to whatever the 
destination variable was. I think they were driving to the destination they were walking 
to when they entered the vehicle.

i observed soviet and german bots with no squad lead. one did eventually get a lead so 
that mechanism works but it is maybe rarer/slower than expected. this is fine i think 

todo 
- civilian squad leaders should probably not move towards squad destination 

----------------------------------
June 18 2024
- added expanded vehicle death function with death message

ended up not being sure what stats to give the vehicle death message, but 
I added last hit tracking so we will at least know what killed it. 

launched a ton of panzerfausts. very hard to hit people with them for whatever reason.
damage seems like it needs to be tweaked - i suspect most of the projectiles miss. 

----------------------------------
June 17 2024
- rewrite of the main collision check in world to be more versatile
- throwables can now collide with vehicles and check miss roll against prone humans
- humans in vehicles no longer get direct collisions, the vehicle gets hit first 
- humans in vehicles have a 25% chance of getting hit if a vehicle gets hit 
- minor cleanup
- fixed a bug where the auto render level was not really being used because 
it was called before variables were set

that render level bug has been around for a LONG time - ever since i rewrote the render level system. 
can't believe I didn't catch it until now. this was causing stuff like shell casings rendering on top 
of humans instead of under them. basically everything was the same render level

vehicle damage is extremely basic right now. I need to incorporate armor, component damage, etc 

I am slowly changing function parameters from caps to non-caps to follow standard convention

vehicle collision changes should be a big improvement. it used to be pretty common for the passengers 
to get hit and not the vehicle, now the vehicle should always get hit. 

vehicles (that aren't dead) seem to offer a large advantage to recently disembarked passengers as they 
have the possibility of soaking up damage with their larger collision radius. this is OK i think - but 
is probably too large of an advantage. Soviets that are exiting a truck seem to have a large firefight 
advantage. 

todo 
- vehicles transporting team mates need to be added to the ignore list 
- vehicle death log similar to the human death log 
- spread out disembarking passengers a little 
----------------------------------
June 15 2024
- world tracks gun magazines now 
- add reset_ai to human_ai and try to standardize on using it 
- add check_if_object_exists to world and try to standardize on using it 
- when picking up a gun the ai will make some attempt to find magazines 
- panicking humans now reliquish squad lead position 

I think in the current game a gun magazine will never end up 
in the world, but its easy enough to add it in while i'm working on 
other stuff. I also set it to check a very near container if one exists, 
this should theoretically be the body of whoever dropped the gun (if that happened)

fairly large amount of changes trying to standardize some ai_state handling and 
object checks in ai_human. probably low actual effect, but might clear up some bugs 
or at least make ai states more standard 

I think a rewrite of the ai state system is probably in order. thats going to be a large task

panicking humans no longer being squad lead should stop some odd behavior that was likely caused 
by a panicked squad lead leading the squad off the map. 

more should be done with the panic state. 

----------------------------------
June 12 2024
- removed squad from vehicle - vehicles don't have a concept of faction identity
- more work on vehicle electrical systems 
- minor cleanup 
- added a new screenshot to the readme 

interesting thing about ampere hours is its in hours. 
most of the time affected values in the game are relative to a second 

decided to abstract alternators for now. want to model them and may come back to this 
but i've got a lot of other vehicle systems to implement yet.

----------------------------------
June 11 2024
- started working on defining ai_battery
- started work on vehicle electrical systems

so i think batteries are reasonable to simulate. it will add some processing but not much.

however i realized i need alternators - but do i create objects for those? should they be part 
of the engine class? maybe just a float value? idk 

----------------------------------
June 09 2024
- repositioned the smoke spawn for vehicle start so its closer to the tail pipe 
- fixed a situation where a ai may incorrectly flee if it needs to reload while in combat 

----------------------------------
June 08 2024
- bumped up the aim lead on moving targets a bit.
- bumped dodge truck from rotation 30 to rotation 40
- fixed squad menu bug (trying to display nonexistent info)
- minor human menu info changes 
- menu self close time bumped from 15 -> 25
- moved debug text further right 
- human ai now correctly flags ai_want_ammo when out of ammo 
- slightly incrased ammo load for some troops

bumping up the rotation speed on the truck seems to have fixed the occasional 
behavior where the ai gets stuck driving circles or alternating half circles. 
need to look into this further sometime and find a better solution. 
Also possible that I just haven't observed it but it seems fixed. 

----------------------------------
June 07 2024
- aiming now differentiates between humans and vehicles and uses vehicle data for computation
- added smoke cloud on panzerfaust launch

the aiming code is hard to test. I basically have to observe it in action, and humans 
engaging vehicles is very rare at the moment. I think with the current code they won't 
target vehicles on purpose, but at least now if they target a bot that is in a vehicle they 
will switch to targeting the vehicle 

still issues with steering vehicles (is it getting worse somehow?)

----------------------------------
June 04 2024
- added world add_queue and remove_queue (fixing two for loop bugs)
- set world_coords to [0,0] instead of None to fix a bug with how map pointers are initalized 
- added more data to human menu when debug is on 
- added advanced weapon aiming when a target is a moving human 
- maybe fixed the bug with bots not exiting vehicles (for loop that removes objs from itself.. again!)
- added a possible fix for vehicles doing figure 8s

the previous add/remove process was objects adding and removing things as part of the update cycle.
this likely resulted in weird behavior as it changed the size of the wo_objects array while it was 
in a for loop. theoretically this could mean some objects towards the end of the array did not get updated 

I tried to go through all the for loops looking for other instances where the array it is looping through 
can change size during iteration, but I got bored. I probably got them all.

The new advanced aiming is likely quite a bit better than the previous situation where the AI absolutely 
could not hit moving targets. This will take play testing and some luck to confirm. somehow i always miss 
the battles lately. All the new tactical changes mean battle locations are less predictable.

Figure 8 driving in vehicles may be due to the transition from 360->0 and 0->360. added a bit of code to 
catch when that situation may happen and just hard set the vehicle rotation 

bot vehicle behavior seems even crazier than usual.

I'm seeing bots walk around with fuel cans. that is new (i think??). they may be getting them from vehicle wrecks. 

todo items from playtesting 
- bots need to grab nearby magazines when they pickup a gun 
- try to set smoke spawn location using the same method i used for aiming at moving targets 
- human ai should detect when a human it is targeting is in a vehicle, and use vehicle velocity and rotation for aiming 
- collision on humans in vehicles should be passed to the vehicle -- or something. vehicle and human in vehicle damage needs 
to be handled. 
- personal enemies need to be shared with the squad for civilian and military interactions. otherwise the military just ignores 
you if you are killing them if you are civilian. 
- look at out of ammo code. add more details to debug statements for it. try to debug/fix actions that get more ammo 

----------------------------------
June 03 2024
- added a ai_data printout when humans exit the map to help with debugging 
- when vehicles exit it will cause the passengers to exit the vehicle 
- added primary_weapon data to death message 
- updated several debug messages to add more data 

I think vehicle passengers would have already been in the exit queue because 
they are still in the world and they get their position updated, but there are 
probably some edge cases. 

battles seem pretty wild and unpredictable lately as a result of the new squad code, tactical_ai, and vehicle code. 
thats a good thing !

The death message text is getting interesting, really telling a story. might have to store that data in a sql table and 
chart/visualize it. 

saw some vehicle figure 8 from the dodge truck. the destination was >1k not sure why its not able to steer 
to the correct angle for that distance. maybe a floating point issue? 

----------------------------------
May 29 2024
- added stalhelm for the Germans 
- added helmet v ssh-40 for the Soviets
- adding a helmet to inventory will equip it if one is not equipped 
- projectiles now record starting coordinates so a distance can be calculated 
- added more complicated damage model for ai_human 
- helmet now gives a save role for bullet and shrapnel hits and possible reduced damage

now that the distance the bullet traveled before it hit something can be calculated we can 
start thinking about creating some penetration tables for various bullets against various objects 

I want to start tracking human damage at a body part level - will have to think about this more. 
Unfortunately besides the helmet there isn't really much in the way of armor in ww2, and with the new 
system, getting hit in the head is a 1 in 5 chance. So most of the time the armor does nothing..

maybe i need a crouch mode where the chance of a head hit is increased, but overall chance of hit is 
decreased. 

I think towards the end game the surviving early squads are out of ammo and get wiped out by reinforcement 
squads. Need to look further into this - out of ammo is not being handled well 

in play testing there were at least two large groups of Soviets that exited the map. 
maybe the leader was panicked, or it could have been a vehicle bug. needs debugging

----------------------------------
May 28 2024
- ai_human changes for wearables (clothes, helmets, etc)

starting to think about clothing. eventually the same system could handle backpacks 

spent some time looking at german helmet designs, but ran out of steam before implementing one. 

wearables are getting their own ai class, so they will have their own variables and theoretically 
could have a update function referenced by the wearer (although idk what the use would be)

the reason i started all of this was i wanted to take helmets into account for penetration/damage 
on humans and start working on a more complicated human damage model.

----------------------------------
May 27 2024
- added data.sqlite 
- loaded name data into data.sqlite 
- converted name_gen to pull from data.sqlite 
- fixed a bug with the start menu where the key wasn't being zeroed out
after scenario selection 
- enabled vehicle passthrough calculation (it was set to always true)
- loaded projectile data into data.sqlite
- converted penetration_calculator to pull from sqlite 
- rewrote and massively simplified image loading. also moved to graphics_2d_pygame
- renamed a couple image files to reflect their in game name 

turns out sqlite3 is built into python. that is super nice 

for some unknown reason vehicle bullet passthrough was set to always true despite 
the fact that a calculation function existed. I'm not sure why that was 

note - i no longer have a mac, and need to re-test on windows. 
the new image loading needs cross platform testing 

----------------------------------
May 26 2024
- added 6v vehicle battery + art
- added 24v vehicle battery 

from what i researched it seems most ww2 vehicles would be 6v, and most 
ww2 airplanes would be 24v

currently electric systems aren't really modeled but that will probably change 

----------------------------------
May 24 2024
- added smoke and smoke clouds. 
- updated animated sprite to handle self removing sprites
- added vehicle functions to start/stop engines 
- engines now differentiate between internal combustion and not 
- internal combustion engines in vehicles will now smoke on startup 

the new start_engines function opens up the possibility to check the ignition system 
or electrical system first. 

----------------------------------
May 23 2024
- added bullet casing animation.

the animation code was originally meant for smoke - that is next. maybe 
----------------------------------
May 22 2024
- converted penetration_calculator from a class to a standalone module
- added full support for different case types. projectiles are now a mix of brass and steel cases
mostly depending on when the projectile was introduced

ideally I think projectiles need to be split into the actual projectile and the bullet as a whole 
so I can handle edge cases like a US Chrysler plant manufacturing both steel and brass case 45 ACP.

I am also in general having a hard time finding good information on World War 2 ammo. 

----------------------------------
May 20 2024
- added small_smoke image 
- removed a lot of old comments and descriptions that weren't used/accurate 
    and general code cleanup 
- added a couple names to the name generator before losing interest
- started working on ai_animated_sprite to animate smoke and bullet casings 
- added option for projectile to be either steel or brass cased but projectile init doesn't support yet 

name generator probably needs a rewrite to just pull names from a text document. writing it in list format is tedious

todo 
- penetration_calculator - rewrite into a static function. shouldn't be a class 
- add casing type to bullet data. incorporate into projectile init 
- finish ai_animated_sprite 
- add smoke 

----------------------------------
May 19 2024
- rewrite of the spawn menu - much more options 
- turned off friendly fire as I was noticing a TON of it as squad numbers go up
- fixed a incorrect indent on a if statement that was causing incorrect 'not in squad' warnings on death 
- removed some print statements for things I wasn't activelly debugging 

The new spawn menu has some new stuff - like squad spawns. Remember you can hit '~' to get to it. 

----------------------------------
May 15 2024
- added a menu to load a test environment at the start 

added a couple different test scenario options. none of them are particulariy interesting.
this will be more useful for testing specific things in the future 

----------------------------------
May 13 2024
- ai_faction_tactical rewrite

I completely rewrote the tatical orders system. It is quite a bit more advanced than it used to 
be and probably won't just constantly move squads around like it used to - but it probably needs 
more like 8 squads per faction to really be effective. world areas probably also need to be spread 
out more 

----------------------------------
May 12 2024
- driver ai slows down to 0.5 throttle when near its destination 
- misc small vehicle related changes 

I think at least part of the vehicle issues can be explained by the squad orders changing by the time 
they get to their destination - causing everyone to jump out of the vehicle and then immediately be 
told to jump back in 

----------------------------------
May 08 2024
- added some debug text to menus and some debug print outs 
- when a bot searches for a vehicle the range will now be <the max walking distance 
    - this was to prevent needing a vehicle to get to a vehicle 
- when switching role to driver the ai now checks to see if anyone is trying to get into 
    the vehicle and if so waits for them for a bit. 
- get_closest_vehicle will now not return vehicles that have a driver of a different faction 
- when getting in a vehicle the ai now checks if the driver is a different faction
- several small tuning changes 

seeing way more debug statements showing that a bot is trying to get a vehicle to get 
to a vehicle (because it is now too far away) than I was expecting. I think what happened 
is these were bots that were trying to enter a vehicle with no driver (so no one to ask to wait)
and then a driver jumps in and drives off before they get to it. 

idk whats going on with vehicles. I think the wait system is causing some unexpected behavior 
and also the turning circle of the truck might not be tight enough and it may be overshooting. 
I'm having trouble getting the bots to actually exit the vehicle. 

might help to get the bots to go to half throttle when they are within 600 or so of the destination 

----------------------------------
May 06 2024
- detected and partially fixed edge case where the bot tries to enter 
a vehicle that moves too far away to walk to. 

----------------------------------
May 05 2024
- added 'waiting' ai_state. mostly affects vehicle drivers now 
- vehicle passengers will now exit if someone in the vehicle reached their destination
- fixed bug where vehicle was added as a squad member, not a starting_vehicle 
- misc vehicle related bug fixing
- fixed target evaluation bug where lists were not being cleared 
- misc bug fixes 

the current code is stable. it feels vastly different from it used to due to the 
large changes with squads, vehicles, and enemy selection.

I let it run for about 15 minutes. after awhile almost every ai in the game was in 
a long line apparently attempting to get into the same distant vehicle. this needs to 
be reviewed 

----------------------------------
May 04 2024
- misc changes to how bots enter vehicles 
- squad_leader can now ask the squad to enter vehicles

----------------------------------
May 02 2024
- added far_east spawn at 10k units vs the original 4k for east to test vehicle use 
- soviet initial spawns are now far_east 
- rewrite of ai_squad, moving a lot of functions into ai_human 
- introduced squad.squad_leader concept 

!! note - this was a large rewrite. probably broke a ton of stuff. ai behavior 
has changed quite a bit with the squad changes  

realized that ai bots in squads will almost never use vehicles because they are most 
often just moving to get closer to the squad position, which is almost pretty close 
to them so it doesn't trigger vehicle usage. squads are going to need a squad order 
system to get around this. 

I am rewriting squad_ai under the general guiding principal of this project that 
actual ai thinking should all be done under ai_human. other ai classes should 
just have minimal logic that simulates physics and mechanisms. 

squads now follow a leader instead of having a squad world_coordinate that was 
determined with a chunk of code. 

some possible next steps 
- implement some sort of squad order system where the squad lead can issue 
commands to bots that are in range (600?)
    - main one needed at the moment is 'get in vehicle' 
- vehicle drivers need to determine if anyone is trying to get in a vehicle and 
wait a reasonable time for them. 

----------------------------------
April 29 2024
- added squad starting_vehicles concept 
- added soviet rifles 1944 motorized squad 
- starting soviet squads in the test scenario are now motorized 

the motorized squad is a test concept. not sure if that will stay long term 

----------------------------------
April 27 2024
- added chrysler flathead engine for the G505 
- misc small things related to the g505 

some things todo next
-i think i need to simulate a vehicle gearbox, at least to some degree. 
-might also need a acceleration tuning variable. 
-need to think about how vehicles are going to be integrated with squads and how they will 
be spawned in with squads
- need to review how passengers can or cannot get shot/damaged (i think this has been broken for a long time?) 

----------------------------------
April 26 2024
- added Dodge 'Weapons Carrier' G505 4x4 1/2 ton truck

I read the world's longest wikipedia article on Dodge WC trucks 
https://en.wikipedia.org/wiki/Dodge_WC_series

As best as I can tell the 1/2 ton was sent over to the soviets 
as lend lease.

I'd like to add a ton more vehicles but I'm hopeless at 2d art. 
Amusingly I think 3d was actually easier. 

It will be useful to get at least a couple representative types for 
each side

----------------------------------
April 20 2024
- added a vehicle search function that only returns vehicles that aren't full 

not 100% on letting the ai auto figure out if a vehicle is full or not, but the 
new function should clear up vehicle choice logic immensely 

----------------------------------
April 19 2024
- bots now apply the brakes on vehicles if they are close to their destination
- bots now wait to exit vehicles until they are nearly stopped 

----------------------------------
April 17 2024
- ju88 is now a vehicle as well as an airplane 
- added brake_power return to zero on vehicles (i think all vehicles would want this - except for trains maybe)
- airplane now brakes with s when on the ground (works fine for now, may need a dedicated key later)

bots will probably try to fly/drive the plane now that it is a vehicle. i'll just leave it for now, should be 
amusing. 

rate of climb calculation doesn't work well for going down, and loss of altitude in general is handled poorly.

ai ridesharing needs to be handled better. seeing a ton of debug messages around full vehicles

need a 'exit vehicle' mode for AI where they slow the vehicle down to zero or near zero 

----------------------------------
April 15 2024
- added some horrible rate of climb calculations 
- added a zero to map size (now 100,000 "units" square) as 
    otherwise airplanes get off map very quickly 

map size needs a rethink now that airplanes are (barely) usable. 

airplane physics need a total rewrite but i can probably kick that can 
down the road awhile.

----------------------------------
April 12 2024
- added some debug info on world and player scale level 
- fixed bug where gravity change was not being saved 
- added a function to set render level 
- render level now auto adjusts to highest when altitude is >0 (done poorly)
- fixed a bug with world scale where floating point precision could cause unintended scales
- removed some rounding from displayed data and started adding rounding in the math that creates the values 

scaling is kinda half working. 

after realizing that some of the goofy high decimal count on some values was cuased 
by floating point math funkyness I've started adding rounding to some of the math functions.
For now I'm going with two significant digits on most stuff -which seems to be working fine.

gravity needs testing. for now it seems to have negated airplane lift. 

----------------------------------
April 11 2024
- added pickle jar to debug spawn menu 
- fixed bug with ai container event add inventory 
- fixed pickle jar world coords on spawn issue 

----------------------------------
April 10 2024
- added jar art
- added jar object 
- added pickle jar 

pickle jar is a container and has pickles added. 
this will be the new method for food and beverage containers 

----------------------------------
April 9 2024
- added cucumber art 
- added cucumber and pickle objects 

want to make a pickle jar but that will take some thought and will 
have to create a appropriate jar. moving towards simulating things 
like jars and glasses seperate from their contents - which will eventually 
require redoing the beer and wine and possibly other things 

----------------------------------
April 8 2024
- reversed aileron controls 
- ailerons now affect rotation when in the air 

----------------------------------
April 6 2024
- temporarily fixed the ju88 mg so it can be fired by the gunner 

----------------------------------
April 5 2024
- added mg15
- adjusted mg34 drum mag from 75 to 50 (more common)
- switched ju88 over to mg15 and added a couple drum mags
- added a poor rate of climb calculation to ai_vehicle 
- flipped elevator up and down values 
- fixed bugs in world_object.update_scale
- doubled ju88 frontal area 
- ai_human now can turn on multi engine vehicles 
- added a simple gravity calculation to all objects 
- re-enabled firing guns in airplanes (not working atm)

I thought the MG15 would have more going for it but stat wise it is 
very similar to a MG34. It does use a 75 round drum instead of the 50 
round mg34 drum so that is something I guess. It looks like the MG34 
had a early war 75 round drum, so might add that as well.

The acceleration calculation that works great for the kubelwagen and bike 
does not work for airplanes. I need to take into the account the differences between 
a engine moving a propeller and a engine directly moving wheels 

I accidentally jumped out of the ju88 after taking off. I could no longer see 
the player. I think the relative altitude or something was not reset. idk 

vehicle weapons need to be redone. maybe need a weapon_stations object array


----------------------------------
April 3 2024
- updated ju88 to a hopefully historical 4 fuel tank setup
- added stall speed variable to vehicles 

adding fuel tanks is awkward currently. One fix would be to make 
a unique fuel tank object for each plane type - but the Ju88 would need 
at least two types and probably more. At some point I have to stop creating 
unique objects and share some resources. otherwise it just gets too complicated

in game speed not having a real world conversion value is 
going to be a challenge. will probably have to figure that one out 

----------------------------------
April 1 2024
- added multi fuel tank readout to vehicle menu 

----------------------------------
March 31 2024
- added a engine menu 
    - for now lets you turn multiple engines on and off 
- vehicle HUD now correctly shows multiple engine status 

note - it turns out the vehicle physics already accounts for multi engine 

probably need to do some work on fuel tanks next 

----------------------------------
March 29 2024
- added jumo_211 engine 
- ju88 now has two engines (jumo 211 type)

need to rewrite engine start menu for multi-engine 
need to handle multi engine power in vehicle physics 

----------------------------------
March 28 2024
- added requirement of weight<50 kg for world_menu pickup options 
- adjusted weight of JU-88
- added german sc250 bomb (aprox 550 pound)
- made second layer optional on spawn_aligned_pile

getting back to aviation a bit. i think. maybe.

bombs probably need their own AI class. we also need better support 
for explosions in game, along with some fire and smoke graphics 

----------------------------------
March 26 2024
- if a human is carrying a large pickup when entering a vehicle 
it will be put in the vehicles inventory 

----------------------------------
March 25 2024
- changed text color to a dark grey. 

some play testing. fueling seems to be working maybe? no errors at least

red text was hard to see. i put in some random numbers and got dark grey. 

----------------------------------
March 23 2024
- fix syntax error in ai_human 
- fixed storage_menu bug 
- fuel_menu fixes 

bug fix and cleanup from last update 

----------------------------------
March 22 2024
- ai_container no longer removes from world when adding inventory 
    - this probably only triggered recently 
- ai_container now merges liquids 
- lots of code changes for fueling vehicles

! note - did not test these changes as i am tired. will test and bug fix in the next commit 

i was going to delete ai_container but the liquid merging code works well there. 
I don't think there is anywhere else where it would be needed. Something that holds 
a liquid should have container ai.

fueling vehicles should work now but probably has bugs. it is a lot more complicated 
than you would think. 

multiple fuel tanks is not well supported atm 

wine and beer should be rewritten as bottles containing wine and beer 
instead of one object 

----------------------------------
March 16 2024 
- if you choose to spawn as civilian, your squad will be auto disbanded
- added code to handle the possibility of a large_human_pickup being a inventory item
- fixed a index error when attempting to split a zero member squad 
- removed player, players large_human_pickup, players vehicle from mouse selection 

disbanded the initial player civilian squad as they are SUPER ANNOYING.
You can always click on civilians and ask them to join your squad if you 
want them following you around 

removing the player and the objects they are using from mouse select was a huge 
QOL improvement. If you need to pull up a player context menu just hit [tab]

----------------------------------
March 13 2024 
- added 'add items' to storage menus (really transfer)

the storage menus are pretty bad because there are only 9 number 
keys to choose objects from. This needs to be fixed - but i think the 
fix is to go to a gui system -- and that is something I'm not interested 
in tackling at the moment 

encountered a unique situation where a kubelwagen has a fuel can - which is a large pickup, but 
it is in inventory - which is a unusual state for a large pickup. 
If you remove the fuel can you cannot drop it - and its not showing in the world 
like a large human pickup is supposed to. this will have to be fixed.  

----------------------------------
March 11 2024 
- bumped up max size of storage objects that can be picked up to 20
- minor fixes and changes to storage_menu 
- storage_menu now lists contents 

----------------------------------
March 07 2024 
- fixed a bug with human menu where the text wasn't clearing right 
- fixed a issue with the storage->remove menu where nothing was displaying
- human menu now displays if you have a equipped throwable 
- fixed several other issues with storage->remove
- german_fuel_can and 55_gallon_drum now filled with gasoline 
- [b] key for bandage is now disabled. you have to use the menu and have actual item now 

need to check if adding fuel still works after the storage and engine overhaul - assuming it doesn't

probably need to add oil - including oil tanks on vehicles and simulating that as part of the engine mechanics 

----------------------------------
March 02 2024 
- added a bit of code to spawn a couple bikes if there are no other vehicles 
- added some panzerfausts to german squads 

damage for humans in vehicles needs to be sorted out. 
the current situation is bullets collide with humans or vehicles depending on whatever it 
runs into first in the list of objects its checking 
----------------------------------
Feb 29 2024 
- added distance check before firing anti-tank in think_engage_far
- added a anti-tank launch option for think_engage_close for distances >100
- added a check to ignore targets >1500 with a printed warning - uclear how often this is happening 
- reordered engagement code a bit. hopefully leading to less random firing but we will see.. 
- bumped the check that blocks movement if there are personal enemies from 300 to 400 as the max movement allowed 
- think_move now checks whether a vehicle is full before trying to enter it (probably a rare issue)
    - this may keep the ai from chasing bikes 
    - also added this check for the function that actually adds the bot to the vehicle 

----------------------------------
Feb 26 2024 
- added unique civilian spawn "shovel man"
- added some civilian reinforcement spawns 

the new unique 'shovel man' has both (!) types of shovel in the game. Shovels are tagged 
as throwable so he should throw them if provoked. I think at the moment this is the only 
place the shovels show up in game - but that is likely to change in the future 

i'm not 100% sure how civilian squads are influenced by their ai_faction_tactial
I think if theoretically they will just wander from site to site as they cannot hold territory. 
However the civilian max squad distance is very large so they don't really appear to follow the group 
- i may consider tightening this up 

note - this reminds me that i need to tighten up the behavior around going to a vehicle 
- the bots need to understand when vehicles are being driven away from them + when they are full 

----------------------------------
Feb 24 2024 
- several small changes to remove the ability to pick up containeres that 
shouldn't be picked up (humans, large containers, etc)
- added eat/drink menu for player 
- added first aid menu for player 
- cleaned up storage menu a bit 

rewrote the code for array selection style menus and it is a lot more compact now. 
the downside is it is still limited to 9 items 

First aid isn't super meaningful at the moment. this stuff needs more detail and reasoning 

----------------------------------
Feb 23 2024 
- moved debug text over so it doesn't clip over the vehicle menu text
- added map bounds (10000 each direction). objects that exceed exit the map 

now objects that wander off too far will get removed, and it also provides a 
method for objects to intentionally exit the map.

I'm not sure about what a good map size is. I think 10k in each direction is 
probably too small, but its still bigger than you would want to drive in a kubelwagen 
without getting bored. walking that far would be a huge pain. 

I recall from my 3d game that there were some odd behaviors near the edge of the map 
caused (i think) by floating point in-precision. I think that game was quite a bit 
larger though. Also worth noting that the previous game was C# so floats were single 
precision compared to python floats that are double precision - so this may not really 
be an issue..

also noted that now that you can pick up containers you can pick up .. yourself. 
amusingly the game doesn't crash but you can no longer control anything.

I accidentally left a test session from the last update running for about 20 hours. 
- 1 soviet survived the entire time, with about 7 Germans surviving 
- I didn't see any bikes, and general civilians were less visible than i would have expected 
- I'm guessing that all the vehicles were ridden far off screen 
- my character had about -14,000 stamina for some reason 

----------------------------------
Feb 22 2024 
- fixed a empty list error in squad ai that was exposed by the previous update 
- some small changes to civilian spawn loadouts 

----------------------------------
Feb 20 2024 
- ai_faction_tactical no longer issues orders to empty squads 

squads stick around after all the members die/leave mostly for record keeping. 
not sure this is really necessary - will have to revisit at some point 

squad asssignments need a rewrite to take in consideration the squads current location 
relative to the world_areas 
----------------------------------
Feb 17 2024 
- bumped cleanup threshold to 4000
- gave reinforcement spawn times some bigger ranges to keep it interesting. 
- added steel_case sprite - will be used instead of brass 

After doing some research I concluded that by late war most small arms ammo is going to 
be steel case - at least on the eastern front. Added a steel case sprite and switched everything 
over for now. In the future I may revisit and find a way to make this per bullet 

----------------------------------
Feb 13 2024 
- ever object now has a spawn_time in world.world_seconds
- added a cleanup function 

cleanup function should start removing groups of unnecessary objects once the unnecessary 
object count gets > 2000. Will have to think on that number - I need to add a performance options ui 

I saw some performance issues at >6000 a couple days back in play testing, but note that was 
RENDERED objects, not total objects. I could switch the cleanup routine over to only activate 
for rendered objects - but that is going to be really variable depending on your view zoom level. 
Either way - it only cleans up brass from guns and dirt piles from bullets hitting the ground at 
the moment - no reason to have thousands of those things. The function cleans up items oldest to 
newest in chunks, so hopefully it won't be super jarring for the user. 

----------------------------------
Feb 10 2024 
- added a timed reinforcement system 
- added german and soviet reinforcements to the test map 
- rounded some numbers in the debug menu for easier viewing

the german reinforcements spawn two squads from the west at the same time.
the soviet reinforcements spawn squads from north,south, and east each at random times. 
should add some variation to who wins the battle (probably soviet now?)

going to need to add a process to clean up bullet impact craters. 
maybe add a spawn_time every time something spawns and clean it up if its been around for a long time
----------------------------------
Feb 07 2024 
- rewrite of how squads get spawned in 

spawn points are now removed. 
tactical ai no longer decides where things spawn, instead this is decided when 
the squads are created in world_builder 

i was thinking about how to add a time based reinforcement system but i ran into 
a issue with the squad spawn system and had to rewrite that to be more flexible first. 

a near term step will be to add in a ability for squads to retreat / remove themselves from the world map. 
- as part of this I will have to think about how big a map should be - it is not currently a defined size. 
interestingly i think this is one of the last features that was in the old 3d game engine that hasn't been 
added here yet.

----------------------------------
Feb 05 2024 
- barrel has 50% chance of being filled with water 

need to research 40s coffee makers next. probably also need a stove 
----------------------------------
Feb 03 2024 
- working on a squad menu 
- some world_menu cleanup 
- fixed a new bug where clicking on bots would cause them to join your squad 

mostly doing a squad menu because having civilians around annoys the 
heck out of me and i want to be able to tell them to disband 

note - barrel should have some liquid added 

----------------------------------
Jan 28 2024 
- made ai_coffee_grinder instead of putting the logic in world_menu 

coffee grinding works now. 
1. find a coffee tin. 
2. remove the coffee beans from the tin (some tins may contain grounds, you need beans)
3. find a coffee grinder 
4. coffee grinder context menu allows you to turn beans into grounds 

i need a density measure, or some way of determining the weight of something given the volume 
----------------------------------
Jan 28 2024 
- added an option to pick up storage containers that are <5 liters in volume 
- rewriting some of the menus to remove the overly complex menu state system
    where it was not needed
- some work on coffee crafting. more needed 

the fact that your inventory can contain containers now causes a bit of a 
recursion issue. i was thinking about writing a function that searches inventory 
and containers in inventory for items - but if an object gets removed that 
gets a bit complicated 

----------------------------------
Jan 25 2024 
- working on a coffee grinder menu 

this is the introduction of 'crafting' to some degree. 
Wasn't sure whether to have a central menu - decided to make it a specific
object menu per specific object/action

----------------------------------
Jan 21 2024 
- rewrote mouse select to consider all objects within 10 distance from the mouse
    - uses a three pass method to pick the most likely objects
- fixed spawn bug with wood pile 
- created new empty interior for the house 

I guess I should ponder if every object should be selectable. If the 
answer is no - then I need to come up with more bool labels as I'm 
creating a lot of basic objects lately to fill in the world details 

I had to remove all the furniture i had painted into the house interior 
because I am starting to actually model that stuff with real objects. 

I need to make a building placement function that is able to place objects in 
buildings - it should correctly align the objects 

----------------------------------
Jan 20 2024 
- added coffee_grinder object
- added barrel
- added water
----------------------------------
Jan 17 2024 
- added coffee_beans sprite
- added coffee_beans and ground_coffee as objects 
- coffee_tin is now filled with either coffee_beans or ground_coffee
- wood pile has a chance to spawn (probably in a house.. lol)

----------------------------------
Jan 14 2024 
- added wood_log and wood_quarter (quarter log) art and objects 
- added function to create piles of things 
- added large_human_pickup items as a mouse selection 

----------------------------------
Jan 11 2024 
- more container work 

mostly bug fixes 

noticed that there were 5 people in my kubelwagen at one point. 
better let osha know 

let the game run for awhile and no fatal errors so this is good to merge for now. 
bots picking up things from containers is probably broken in some interesting ways 

----------------------------------
Jan 10 2024 
- more container work 

----------------------------------
Jan 09 2024 
- more container work 

----------------------------------
Jan 08 2024 
- more container work 
- added small_clear_spill sprite
- added gas as a world object

I've renamed some things now that there is only one type of container. 

world_menu will have to be re-done to handle the new system. basically everything that can hold other objects that isn't a special 
thing is a container - including the old ammo containers, liquid containers, and object containers 

once i'm through with this I should do the same for ammo_container. 
A ammo_container is just a container with ammo in it. No reason to have its own class  

----------------------------------
Jan 07 2024 
- added coffee tin 
- world_object gets volume
- world_object gets state of matter (is_liquid/is_solid/is_gas)

it made sense to move volume from liquid container to world object.
Not sure how much it will be used at the moment but it adds flexibility 

started rewrite merging liquid_container code into container 

NOTE - this is a breaking change

----------------------------------
Jan 06 2024 
- added cupboard
- added blue coffee cup 
- added some random spawn to cupboard at 50% chance 

I think liquid containers are going to have to change a bit. you should be able to put a solid in a liquid container if you want. 
maybe regular containers get a volume and the code is merged with liquid container code 

----------------------------------
Jan 01 2024 
- added a warning if throttle_zero is enabled and a throttle_up/down function is used 

controls going back to neutral over time is something interesting to think about. 
I think in a car and to some degree a plane you expect controls to kind of go back to zero. 
In a car the gas goes to zero and the brake goes to zero, but in a airplane you set the throttle 
and expect it to stay. this will come up again when i program flight ai.

vehicles coast for way too long when throttle is neutral. need to add more friction 

----------------------------------
December 31 2023
- added arrow keys in as recognized keys 
- airplane wheel steering on the ground with [a] [d]
- airplane throttle [left arrow] [right arrow]

----------------------------------
December 29 2023
- some more vehicle code 
- added vehicle text readout for airplane controls 

----------------------------------
December 28 2023
- some more vehicle code 

----------------------------------
December 24 2023
- minor ai_vehicle changess that i forgot to commit last time 
- added some aviation related variables 

----------------------------------
December 20 2023
- added rate_of_climb (meters/second)
- general fussing about with vehicle class 

the general lack of units in this game is starting to be a challenge..
i think my last game engine had some concept of the relationship between a square 
meter and the game units that equaled it - but I don't remember any specifics 

decided to use metric values going forward for units whenever possible. 
this makes sense given the setting.

some variables like speed and acceleration are not in real world units. 
that will need to change at some point I imagine. 

One interesting thing is that this game is currently 2d so altitude is going to be 
made up in a different way from x/y changes. It kinda makes me think that this really 
should have just been a 3d game engine with a top down perspective or something - but 
that might have been odd looking 

----------------------------------
December 17 2023
- moved some specific key down handling from world to ai_human 
- input handling rearrangement to differentiate between airplane/not airplane 
- created empty functions in ai_vehicle for all the common control surfaces

I bought a steam deck. I will test TWE on in it in the future 

----------------------------------
December 15 2023
- all objects now have altitude
- all objects now have a scale modifier based on altitude
- objects under a minimum visible scale will no longer be rendered 

starting to work on changes to zoom that are necessary to flying. 
this was a challenge as im adding a 3d element to what was a 2d world. 
ended up deciding that each object will be capable of setting its own 
scale modifier relative to the global scale that is set in graphics_engine 

ran into the question of whether altitude should be in vehicle ai or world_object. 
decided all objects will have altitude -- perhaps this should be the case with a 
lot of vehicle variables. -- i think to some degree a lot of the physics stuff may 
drift over to world_object 

----------------------------------
December 11 2023
- ai will now grab up to 2 compatible magazines when looting 
containers. 
- rewrote event_add_inventory for ai_human to fix a bug where 
when picking up a gun when you have a gun you would drop your gun but not 
pickup the new one (item duplication issue i mentioned in previous notes)

remember a body is classified as a container, so the ai should 
have a reasonable chance of grabbing magazines when they pick 
up a gun now.

perhaps they should search nearby containers when grabbing guns
- this may require work on an ability to chain tasks 
- and/or bots need a sort of short term memory 

In play testing I saw a duplicate object warning when a bot tried to grab a magazine 
- the bot also had a ton of other mags. 

I need to add a bot routine to clear out its inventory of unused stuff 

----------------------------------
December 10 2023
- added a generic beer
- added beer to debug spawn for testing 

beer/wine/beverages are due for a full rewrite. not sure if i will tackle 
that soon or not.
- i want to come up with some fictional brands (concerned about copyright/trademark)
- maybe need bottle ai 
- would be nice to have bottle upright and on its side art.
- would like to have bottles self organize in a box 
- how much do you drink when you drink? 1/5 of the bottle or so? (this will require more code)

----------------------------------
December 9 2023
- added green_bottle which will be used for beer and possibly other things 

going to introduce some beers. wine will also become specific wines instead of being generic 

would like to use the actual beer names but a lot of these breweries are still in operation 
so probably have to create some fictional names 

----------------------------------
December 7 2023
- modified handle_check_ammo so it also gets a magazine count from inventory 
- some gun type changes 
- semi auto rifles will now be preferred over rifles and pistols 
- ai should now be willing to drop their gun for another if they are low on ammo 
- ai will not attempt to refill ammo if they do not have magazines 

several changes to how the ai handles getting a gun. still a lot of room for improvement here 

I need to think about what the FG-42 should be classified as. I guess its a light machine gun , 
but that is not currently a category that I recognize. This is important as the AI will generally 
not pick up machine guns as they are considered too unwieldly and require special skills

noticed that bots will pick up multiple weapons. they are meant to only have one - will have to 
look into 

----------------------------------
December 6 2023
- added handle_replenish_ammo  to ai_human 

for now handle_replenish_ammo just fills the mags in the bots inventory 
by spawning new bullets. this restores the previous functionality -- 
basically the bots have infinite ammo but they have to walk somewhere and 
pretend to get it. this function can be modified later to actually transfer 
ammo from whatever ammo source they found 

found there are circumstances where the bot is now stuck trying to get ammo forever.
this is a consequence of the new magazine system.. a bot will pick up a new gun but 
have no magazines - and thus the get ammo action will trigger as they have no ammo 
for the gun -- but without magazines they cannot get more ammo 
will have to solve this in the future..

----------------------------------
December 5 2023
- added a check and warning if a large_pickup is already picked up by someone else  
- some changes to the debug menu spawn options 
- cut the size of the grenade in half because i realized it was ridiculously huge 
- made some tweaks to grenade and uh 'throwing shovels' speed and distance. 
    - still don't feel right 

weapons were all 20x20 but now i'm leaning more towards sizing them in a way that 
makes a bit more sense. maybe long weapons  with be 20x20 and small ones will be 
10x10 

throwable ai code probably needs a re-write. 
the shovels are amusing. I need to add collision damage and think of a better 
ai reaction to that sort of event. 

maybe a shovel should be its own equipment slot? It is fun having it be a 
throwable, but realistically you would rather have a grenade.in that slot 


----------------------------------
December 3 2023
- added ammo count for primary weapon back to human menu 

----------------------------------
December 2 2023
- added some magazines to the fg42 spawn from the debug menu 
- added magazines to the list of things you can mouse select
- added a check to stop the start menu from timing out 

I think I need to add magazine carriers and ww2 style web gear 
mostly because magazines are really too small to spawn in the world 
and be manipulated easily by humans.

----------------------------------
December 1 2023
- minor polish changes 
- projectile data gets 'contact_effect' and 'shrapnel_count'
- projectile data added for panzerfaust_60
- projectile code enhanced to handle HEAT jets on contact 

I think grenades will eventually just be a projectile instead of 
their own unique thing 

panzerfausts are working again (that change took a month!) so 
this will get a merge. note - when you fire the panzerfaust you 
drop the empty - but currently it does not look empty

note - in the play log i saw a 'already in inventory' pickup 
error. odd as i thought I had that resolved. 

----------------------------------
November 30 2023
- added player reload (hit r)

player reload may need some tweaks. for now it is 
the same as bot reload where it should theoretically pick 
the mag with the most bullets

note that magazines and bullets are fully simulated. 
This isn't a mainstream video game where reloading just tops up 
your mag from a bullet pool. If you shoot half a mag and 
reload the half full mag goes into your inventory

----------------------------------
November 29 2023
- work on magazine/gun rewrite code integration 
- bug fixes 

found a bunch of errors in ai_human.take_action_get_ammo.
This means this function was never triggered before - at 
least since whenever it was rewritten. very interesting..
one possibility is i unknowningly fixed a logic error that was 
preventing this code from ever running. Another possibility is 
a bot has never run out of ammo - this is possible- engagements 
tend to be short, but the bots are heavy on the trigger. hmmmmm

todo 
- i need to add a function to reload existing magazines/weapons 
from ammo cans/stashes/whatever.
- humans need a reload button (this used to be automatic)
- rewrite panzerfaust 

this seems stable enough, so i'm going to merge it into main. 
- there are likely still some bugs 
- there are some regressions (reloading, others?)

----------------------------------
November 28 2023
- more work on magazine/gun rewrite
- added is_gun_magazine because the ai needs to understand them now 
- some basic code for handling reloading 
- new ai_human code for checking ammo in gun and in inventory 

wrapped up most of the init code for the new magazine objects.
now working through all the new bugs / code changes to handle the new 
magazines 

need to remember that panzerfaust still needs to be rewritten to use ai_gun 

----------------------------------
November 27 2023
- more work on magazine/gun rewrite

----------------------------------
November 25 2023
- updated Fedora 37 install notes -> Fedora 39

----------------------------------
November 22 2023
- more work on magazine/gun rewrite

note - need to add a bullet type for the ppk (32 acp?)

----------------------------------
November 19 2023
- work on the new magazine objects

----------------------------------
November 16 2023
- minor gun rewrite work 
- added image for stg44 magazine 

I wonder if I will get to a point where inefficient sprite (image) loading is an issue. 
I believe in professional games sprites are generally loaded as one image with each sprite being a small 
section of it. This isn't something I've ever looked into much, but the number of images has really 
started to explode -- however they are all pretty tiny. 

----------------------------------
November 14 2023
- moved ignore list creation from ai_gun to world so it can be re-used 
- general work on the gun rewrite 

guns no longer auto reload. will need to add in code to ai_human for the reload sequence 

----------------------------------
November 13 2023
- fixed a odd tabs/spacing alignment issue in math_2d 
- started work on gun and projectile overhaul 
- created ai_magazine 
- ai_projectile can now explode
- ai_panzerfaust deleted. functionality will be split between ai_gun and ai_projectile

note - code is unfinished. breaking change.
Every gun init needs to be rewritten 

panzerfaust is broken so i spent some time looking over the code. 
At first I decided I want to rewrite it in two parts with a ai_rocket_launcher and a ai_rocket_projectile 
but the more i thought about what ai_rocket_launcher would be the more i thought that it is very similar to 
ai gun, and at the moment ai_rocket_projectile could be the existing ai_projectile with some small changes 

the next logical thought was that it is really time to model magazines as arrays of 
projectile objects instead of just being integers modeling a number of projectiles.

note - ammo containers should probably be ai_magazine instead of whatever they are now 

----------------------------------
November 11 2023
- added spawn menu under debug menu (hit ~)
- minor menu changes/fixes 
- fg42 type 2 was using the wrong image. fixed
- added pygame double buffering. on by default. 

something is very broken with panzerfausts 

review of the bot item grabbing code suggests that it should still be good

double buffering seems to really clear up the ghosting and choppiness. Not seeing a 
performance impact but i'm on a apple m2 air which is very vast hardware compared
to previous dev machines 
----------------------------------
November 7 2023
- added distance check to vehicle external menu 
- fixed event handling in liquid container ai 
- ai_container no longer adds removed objects to the world 

note - need to review how ai grabs objects from storage next

liquid container ai had the wrong function names in its event handler. 
kinda odd that i didn't notice this before -- bears further review/testing 

inconsistencies with inventory management between ai implementations continues to be an 
issue. part of the problem is i have changed my mind several times on whether the object that 
owns the inventory should add the removed object back to the world or not (currently no)

bike riding feels oddly good. a bit slower before but more like i think it should be 

grrr menu code so bad. 

----------------------------------
October 30 2023
- removing invalid vehicle menu variables 
- updates to vehicle hud 
- added some variables to ju88 so it didn't crash 
- misc updated to vehicle physics code to work with the new acceleration calculation 
- small updates to kubelwagen and bicycle variables so they work 

I was shocked to find out that the new acceleration calculation basically worked 
out of the box with no tuning. this is clear evidence that we live in a simulation. 

kubelwagen and bicycle basically work now. I bet there are a lot of misc bugs though so 
I need to do some more play testing 

apparently getting into vehicles doesn't have a distance check anymore. odd.
need to fix that. 

watched two ai bike rides and a ai kubelwagen drive that all seemed to work correctly - so 
I guess that is still good. 

there are probably some lingering issues but i think this is worth a merge. 

----------------------------------
October 24 2023
- additional work on new vehicle physics 

not super enthusiastic about working on vehicle code at the moment 
so this is probably going to be broken for a bit

----------------------------------
October 21 2023
- added parts and variables for a physics engine 

vehicles keep getting more complicated. hopefully this doesn't hurt performance 

----------------------------------
October 20 2023
- decided that all vehicles will have a engine if they want to move 
- therefore added uh.. bicycle_pedals 

having to handle vehicles that could move without an engine added 
excessive complexity. easier to add a 'engine' to the bike 

----------------------------------
October 18 2023
- fixed fuel consumption so that it works again (kinda)

after play testing a bit i think ai vehicle exiting is ok. 
- ideally they should bring the vehicle to a stop before bailing though..

I need to write a vehicle function to propogate throttle adjustments to the engines throttle_control
also need a engine function to kill the engine at throttle_control zero 

----------------------------------
October 15 2023
- fix a bad path in image loading 
- misc small hacks to get the game playable with the new vehicle code 
- added some (bad) apple install instructions from my (bad) notes on what i did 

some bugs 
- engine on is not consuming fuel as far as i can tell 
- maybe an issue with civilian coordinates not updating when exiting vehicles 
- bots should maybe not chase vehicles that are in motion 
- possible funkyness with engine on/off from menu 

game is back to working..ish so this will get merged into main 

----------------------------------
October 13 2023
- work on integrating vehicles with engines and fuel tanks 
----------------------------------
October 9 2023
- added vehicle_fuel_tank art and object 
- added some stuff to ai_liquid_container, which is re-used for fuel tanks 
- fuel tank vehicle integration (somewhat)

hmm is seperately simulating the fuel tanks going too far?
where does the madness end? haha 

----------------------------------
October 8 2023
- a bit more work around engine integration 
- decided to add fuel tanks as well 

note ! vehicles are going to be broken for a bit 

----------------------------------
October 7 2023
- started work on ai_engine framework
- started work on engine object creation 

----------------------------------
October 5 2023
- created art for volkswagen type 82 engine 

decided I am modeling engines. engines are cool.

they are going to be full world objects. 

----------------------------------
October 1 2023
- modified projectiles so they check collision about every 0.1 seconds instead of every loop  
    - this did not seem to matter 
- increase air time for grenade a bit as it was exploding a bit early 
- add more error code to prevent objects from being added to various lists twice 
- removed code that self-erased squads if they had no members. this caused a rare 
crash where a gun was fired by someone not in a squad (were they dead?? ) causing the 
squad to be none which caused the friendly fire code to crash 
- human ai remove inventory was still adding objects to the world. I forget where I landed 
    on that question, I think I did NOT want this. removing it (it may have been causing duplicaates)
- removed the error text for changing vehicle roles as 'none' as this is used to clear out of all roles 
    and is not an error 

I think I fixed a lot of issues by removing the world add from inventory removal. 
I think this was resulting in double object references, which meant double physics updates 
among other things. As a result thrown object are probably back to normal speeds and will 
need a readjust. 


the squad code in general needs a revisit. ai_faction_tactial should ignore 0 member squads 
and maybe react when they are wiped out 

I think its clear that eventually I need to pivot to a universal physics model for every object 
but I'm not ready to tackle that.. 

Short term I may switch to airplane stuff for awhile. I'd like this to be a game where you can 
have fun flying planes and not really do any of the other stuff if you don't want to. 

----------------------------------
September 29 2023
- created a new german_military_equipment list 
    - only the two shovels for now, need some other stuff 
- kubelwagen gets a random german_military_equipment

I definitely need more 'stuff' modeled. just random stuff to fill out the game a bit
- however i think stuff should have some use. I remember when I played Oblivion there 
was a ton of junk that had no purpose.

I need to rewrite projectiles to not check collision every loop - its excessive.
It occurs to me that may be why projectiles/grenades got weird with the frame rate 
increase 

----------------------------------
September 23 2023
- added is_throwable attribute 
- event_add_inventory now checks for is_throwable instead of is_grenade 
- fixed a add_inventory bug that could have resulted in double items (i think?)
- picking up a grenade while holding a grenade will no longer cause you to drop one 
- changed ai_grenade into ai_throwable and made it more generic 
- slowed grenades down a bit again. not sure why they feel so fast all of a sudden 

did upping the frame rate do something to grenades in flight ?

so shovels are throwable. not much else to do with them at the moment. 
They also don't do damage at the moment. 

i found a bug where objects are sometimes not picked up but are still in your inventory. 
so you see them on the ground but when you throw them they disappear or move as they should 

thrown objects seem super goofy. at times they seem way faster than they should be. i'm not 
sure what is going on there 

----------------------------------
September 21 2023
- moved the throw code from grenade to ai_human
- removed world.check_collision_bool too similar to the other collision function 
- minor cleanup 

I think what I need to get to here is anything should be capable of being thrown. 
The current state is grenades have a lot of special code to handle that 

currently everything that moves has custom code - but we might need a universal physics for every object.
maybe a update_physics as a world_object base class function.

the trick here is instead of say bullets traveling for a defined length of time i would instead 
have to model air density slowing them down. that would be a lot harder 

----------------------------------
September 18 2023
- added german field shovel art
- added german folding shovel art

shovels are going to be melee among other things - but i want 
most things to be melee. need to figure out the mechanics first 

i think the best thing about making a 2d low art quality game 
is how much random goofy stuff i can add, like multiple types 
of shovel 

----------------------------------
September 16 2023
- added code to human ai to handle going prone and standing up 
- being prone gives a 50% chance of projectiles missing you 
- reorganized input handling, moving more of it out to the world class from graphics_2d_pygame
- realized player wasn't using calculated speed (takes into account a lot of stuff).. fixed
- hit 'p' to go prone as the player character 

50% bullet misses while prone is probably excessive. 
----------------------------------
September 04 2023
- changed my mind on add/remove inventory 
    - added custom methods for picking up and dropping objects from the world 
    - misc rewrites from this 
- added some rotation and position randomization when objects are dropped 
- added some in game text for reloading and reloading complete 
- possibly fixed a bug where you get an error if your vehicle dies before you do 
- large pickups are now dragged along with you and never leave the 'world'
- some menu changes for large pickups 
- added probable kills to the death message in the console 
- removed the second screenshot from the readme as it was excessively violent 
    for a public page. 
- slowed down the hand grenade a bit. it was crazy fast 
- bumped the max fps to 60 from 40.
    - this seems to have smoothed things out immensely. not sure what all it 
        will affect 

I don't remember why max FPS was set to 40. I think it has been that way forever. 
It might date back to the original book or tutorial that I read on pygame. AI thinking 
is generally time based so FPS won't affect it, but it may have some other effects.

while i was playtesting i saw 9 death messages of troops killed by a mg34 gunner 
but when the gunner died he had zero kills. I'm not sure if this is because his 
bullets were in flight when he was killed or what. 

----------------------------------
August 31 2023
- rewrote some code that handles large_human_pickup items 
- redesigned inventory flow (large change)
    - add_inventory now removes the obj from the world 
    - remove_inventory now adds the obj to the world 
    - this cleans up a bunch of other places where this is done
- world.remove_object error handling is a bit better 

thought - instead of dissapearing from existence, should projectiles 
get added to inventory when you are hit?

more work on large_human_pickup tbd 

note - this probably breaks some stuff 

----------------------------------
August 28 2023
- added 'furniture' as a concept 
- added brown_chair 
- some updates to the 'big cheese' unique spawn 
- switched one of the soviet rifle groups for a submachine gun group in the test map 
- moved several items that were always spanned to the clutter method with a chance to spawn 
    - this will reduce interesting stuff on the map for now 
- human will now exit a vehicle on death 
    - maybe fixing a null error when you die in a live vehicle 
- upped menu timeout to 15 seconds from 5. 5 was too short and annoying 

some thoughts of things to add in the near future 
- prone 
- backup/secondary weapons (when primary is out of ammo consider switching)
- ai behavior seeking out chairs to sit on 
- flavor text to tell the player when they are hit / reloading / etc etc 
- vehicle gunner ai 
- make large pickups stay in the world and just get 'moved' with the player instead of 
being an inventory item 

while play testing I saw a german soldier get shot off a bicycle by a soviet squad. 
the bike continued forward in a straight path riderless for a bit. it was a pretty
good unintentonal emergent scenario. 

----------------------------------
August 22 2023
- even more distance based menu changes 
- come cleanup and style updates in the menu code
- menus now auto-close after 5 seconds of no activity 
- vehicle ui text is now OFF by default (you can turn it on via the internal vehicle menu)

----------------------------------
August 19 2023
- more distance based menu changes 

----------------------------------
August 18 2023
- added in some distance requirements for human menu 
- removing objects from storage now puts them into player invetory 
    instead of dropping them on the ground. exception is when player is 
    looking at their own inventory
- misc menu improvements 
- fixed bicycle inventory so it no longer has a mg34 

menus still need a lot more distance based modifications and other stuff 

in play testing i did catch one bot making figure 8s with a bike. 
rotation to destination was 358 - so i think it was always overshooting that (rotation wraps to 0 )
will have to think how to deal with those situations. maybe slow down rotation speed when you get 
near the upper angles ?

the vast majority of vehicle usage seems to be working 

I did see a horde of ~30 civilians chasing after a bike - decision logic around trying 
to grab a vehicle needs to be tweaked. especially when it starts moving away 

----------------------------------
August 17 2023
- temporarily removed the distance check when you click something 
    - it will return later 
- added faction to the human menu so you can tell who is who 

I'd like the menus to display more data/options when you are up close vs far away
this functionality should be in world_menu (distance check used to be in world)

It is pretty hard to tell the germans apart from the russians. I'm not sure if that will change 
the colors of their uniforms are not THAT different. To get around this when you click on them 
it will say their faction now. 

----------------------------------
August 15 2023
- fixed spelling error preventing building awareness from working 
- added additional debug text to various menus - especially driving 
- fixed bug that causes cars to circle (hopefully)
- lots of bot driving code changes 
    - most of this was troubleshooting but it should be smoother now 

while play testing I jumped on a bike. 
- i was suprised to find the bike had a mg34 
- i was suprised to find i could drive and fire when i switched to gunner position 

i drove around on my bike machine gunning troops until Yuri popped me 
with a mosin nagant. 

I was able to confirm that vehicle hits are passing through 
to occupants - i need to review this and maybe tweak 

bots driving vehicles in circles ended up being caused by the get_rotation function 
from math_2d occasionally returning a negative number. this wasn't an issue in the rest 
of the code (apparently??) but the driving code could only make positive angles.

I fixed that and also introduced a neutral steering for when the bot neither wnnts to 
steer left or right. I also increased the speed of driving decisions significantly 

From what I can tell driving is probably the best it has ever been now. 

----------------------------------
August 14 2023
- buildings you are in now get added to the ignore list for bullets you fire 

not sure the building bullet collision avoidance is working. shooting from 
inside a building seemed intermittent like it was still getting blocked. 

also hilariously saw a bot biking in a circle - probably around his destination
might need to bump bikes to 100 - or better write some code to detect conditions 
where reaching a destination is impossible
----------------------------------
August 12 2023
- reconfiguring how the ai interacts with buildings 
    - added new in_building bool and related detection code 
- minor menu updates
- very minor misc clean up 

I've switched development work to a apple m2 mac. the game feels the same.
I'm pleased to see that pygame is very cross platform. No issues with the ARM M2 processor. 

----------------------------------
August 03 2023
- added two 7.62x54mm bullet types 
- updated soviet weapons to use 7.62x54 as appropriate

long overdue on adding 7.62x54mm although this is currently 
doesn't make much of a difference to the player. 

I think in the near future ammo storage really needs to be by bullet type 
instead of being generic. This would generate a real burden once ammo runs 
out though. 

----------------------------------
July 31 2023
- tuning bike performance characteristics 
- removing some unneeded debug statements 
- small amount of misc cleanup 

----------------------------------
July 25 2023
- added rotation to passengers when riding in open top vehicles 

----------------------------------
July 15 2023
- big change to how passengers are handled in vehicles 
    they are no longer removed from the world 
- added another render level and bumped humans a level above 
    vehicles so they can be seen in open top vehicles 
- minor code reshuffling in ai_human 
- graphics_2d_pygame.renderlevels now supports dynamic expansion 
- graphics_2d_pygame now obeys world_object.render bool 
- passengers now render if the vehicle is open top (just bikes at the moment)

this change probably breaks/changes a lot of things. 
It is going to take some time to get back to normal 

passengers do not rotate with the vehicle or assume a position relative to a 
vehicle seat - will have to add that stuff in the future

note: need to be careful about copy.copy and copy.deepcopy 
copy.copy is still a linked copy if there are any mutable objects.
I briefly used copy.copy to reset the render lists and this created a 
exponential expansion as it created accidentally permanent internal lists.
I looked through the rest of the code and I didn't spot anywhere else where 
I think this will be an issue 

mouse object selection needs a rewrite. I probably need to make it 
more of a intelligent select. Also it needs to understand object 
collision circles 

render levels probably need to be more dynamic. its a challenge to 
place everything at the right level - perhaps objects should dynamically 
change their level ???

I should possibly add a optional sanity checker that i can turn on and off.
it would comb through the game objects and maker sure all parameters are within 
expected sizes and levels

----------------------------------
July 11 2023
- added open_top variable to ai_vehicle for bikes and other 
open top vehicles  

realized to add riders to the bike i need to 
solve the turret rotation/position problem. I didn't get 
far but did decide on the concept - the human_ai will NOT 
remove itself from the world if its entering a open top 
vehicle 

----------------------------------
July 06(?) 2023
- minor readme.md updates
- minor ai_human refactors 
- bumped a distance check slightly form 200-300 when determining 
    whether to keep moving when a bot also has personal enemies 
    (this is overal a fairly broken area of code)
- bumped 'arrived at destination' distance from 50 to 150 for bots in vehicles 

----------------------------------
July 06 2023
- added a bike 
- rewrote vehicle code a bit to handle vehicles without engines 

i've been wanting to add a bike because gas vehicles should 
be somewhat rare. although germany is credited with inventing 
lightning war it wasn't motorized to the degree people think.

guess i should really add horses. hmmm 

bike is hacked in for now. will refine later 

also the art is hilariously bad. won't fix. probably 
I do need some sort of bike + passenger drawing but the code doesn't 
currently support that 

--
saw what seemed to be a successful vehicle ride by an ai followed 
by circling behavior from another. hmm i wonder if the circling is just turning 
around a spot without ever getting close enough to exit??

-- 
i exited a vehicle and it drove off! turns out i must have had a stowaway 
----------------------------------
July 03 2023
- added reload speed 

reload speed will need tuning 
current thought 
- stripper clip bolt actions around 10-11
- magazine fed guns around 7
- pistols around 5ish
- drum mg > bolt action slightly 
- goofy soviet wheel drum >> because its huge and ridiculous 

this will help differentiate the weapons
----------------------------------
June 26 2023
- minor cleanup/updates with ai vehicle handling 
- ai can turn on vehicle engines now 
- ai will now never run out of fuel. 
    - will have to fix in the future 
- ai now hits the brakes if it exits the driver position 
- tightened up ai think interval when driving for 
faster reaction speed 

AI driving seems to work now. 
I think the major issue was that the think update interval
could be seconds so the steering would tend to over 
steer and then over steer the other way. 

i think im near a local maximum of what i can do with the current 
ai structure. i really need to move to a list of actions so i can 
string moves together. interesting i did add self.missions at one 
point but never used it 

----------------------------------
June 24 2023
- squads now self remove when members go to zero

I thought squads already went away when all the members were 
dead but i guess not. this will have an effect on faction_tactical 
decision making as it considers squads, not individual members 

realistically there aren't enough squads for how the AI works
not sure what to do about that. either smalle squads or 
spawn more men

also confirmed that the ai still drives in circles 
(it stole my car with the engine running)
need to teach it to turn the engine on itself 
----------------------------------
June 19 2023
- fixed/finished code for adding fuel 

currently only fuel can -> kubelwagen is supported. 
other flow directions/options can be added but there 
is no need at the moment. 

----------------------------------
June 14 2023
- resorted some of the functions in math_2d 
- added function to math_2d to calculate numbers for transfering amounts of things 
- added handle_transfer function to ai_human to feed data into the math_2d function 
- updated fuel menu to use new transfer calculator 

once again i remember how much of a mess world_menu is 
----------------------------------
June 10 2023
- started working on code for transferring liquids between 
two objects 

need to fix adding/removing gas from cars but its a bit more complicated 
of a problem than i first thought.
----------------------------------
June 06 2023
- added svt40 
- added svt40-sniper
- added fallshirmjager squad 
- changed one of the soviet 43 squads to a soviet 44 
    squad in the test environment (more firepower)

the svt40 got added to a couple russian squads so it 
will show up in game.

realized that soviet rifles and mg are set to use german bullets. 
i need to add some soviet bullet types 

I need some ways to differentiate some of the different groups better, 
probably need more uniforms 

----------------------------------
May 28 2023
- fixed word spacing in death notes
- added g41 (walther variant)
- added k43 (g43 was renamed to k43 after being introduced)
- added FG42 type 1 and 2
- modified gun loot tables a bit 
- fixed a bug on a unused german squad type
- standardized civilian squad spawn 
- 10% chance of unique civilian bot 'big cheese' spawning 
- changed kubelwagen spawn so now its a 1/3 chance to get the mg
    - if you get the mg you also get a ammo can 
- kubelwagen now spawns with a medical item instead of food 
- fixed bug when driver position isn't cleared when exiting vehicle 

guns need a stat for reload time as that is the main thing that 
will seperate the g41 (fixed mag) from the g43 (removable mag)

I'm not sure how to deploy the new weapons yet. g41/43 are considered 
uncommon but ~400k of each was still made. only about 7k fg42 were made 
so those will probably only show up in random loot 

----------------------------------
May 26 2023
- randomized fuel load on the 2 kubelwagens that spawn at the start
- set the kubelwagen from the debug menu to max fuel 
- added fuel consumption to vehicles (doubles when throttle is pressed)
- rounded (in the display) some vehicle menu floats that get silly
- bumped max distance to interact with something from 60 to 90 
- added option to ask squad member to enter your vehicle if you are in one 

----------------------------------
May 18 2023
- added world.friendly_fire_explosive and friendly_fire_explosive_squad 
    - this is getting complicated quickly 
- small change to ai_human personal enemies will now only be created if they 
are NOT in your squad (this probably needs a rethink/reorg)
- fixed a bug where the first personal enemy got added to the squad near enemy list , 
not necessarily the personal enemy that was relevant in the context 

want to note an issue where you a bot can get hit by shrapnel 
which creates a personal enemy that is immune do to friendly_fire settings 

I spent some time in ai_human trying to figure out how to sort out 
potential logic issues with the new friendly_fire settings but did 
not figure out a good approach. will have to revist this. I think the 
answer is it needs a new function to think about adding personal enemies 

current friendly_fire settings should mimic how the game was prior 
to the previous update (although squad level may not have worked previously) : 

        # True== get hurt, False== don't get hurt
        self.friendly_fire=True # complete friendly fire
        self.friendly_fire_squad=False # only at the squad level
        self.friendly_fire_explosive=True # grenade shrap clouds
        self.friendly_fire_explosive_squad=True # only at the squad level

friendly fire off on bullets is easier to swallow than friendly fire 
off on grenades. I may just have to add some code to make the bots 
more careful about throwing grenades - although they don't currently 
know the position of every bot on their team - so hmm that would be 
a costly calculation 

There is a strong chance that squad level alerting of near dangerous 
enemies works quite a bit better now. 

----------------------------------
May 15 2023
- vehice engine will now turn off if it doesn't have fuel 
- added fuel data to internal vehicle menu 
- added world.friend_fire which is set to false currently 
- added friendly fire code to shrapnel and projectiles 
- also added world.friendly_fire_squad which is squad level only 
    but this is superceded by firendly_fire 
- added a ref back to faction_tactical for each squad 
    - didn't end up using it yet but maybe soon 

note - the existing squad level friendly fire code probably did 
not work. it has been rewritten. however as the bots can't really 
avoid shooting each other i think a wide ranging friendly fire 
check is better at the moment.

note in regards to fuel - you can pick up a fuel can and 
use it to fuel the kubelwagen 

----------------------------------
May 07 2023
- added engine_on bool for vehicles 
- added vehicle internal menu for toggling the engine 
- made some changes to the vehicle text menu and re-enabled it 

----------------------------------
April 30 2023
- added a function to handle switching vehicle roles 
    - removed similar code from world_menu 
- added in code to handle firing vehicle weapons
- fixed vehicle update so it now updates the primary weapon 
- small updates to a lot of the human - vehicle interaction code 
- you can now fire the kubelwagen mg34 if you are in the gunner position
- rewrote some projectile handling to take vehicles as a source into account  

now that you can fire the gun, vehicle interaction is more or less back 
to where it was before i ripped out vehicle ai. 

the bots still can't fire vehicle weapons but that should be easier to add 
at this point. 

----------------------------------
April 25 2023
- hacking in some weapon code into the vehicle ai 
- added world_menu for changing vehicle role (seat)
- misc updates to vehicle menu 
- minor updates to ai_human enter/exit vehicle code to handle 
    gunner role 

thinking about vehicle seating. 

I think eventually it is going to need to be a class 
with a ton of attributes. 

for now i think there will just be a couple static roles 
driver - drives 
gunner - controls all vehicle weapons 

ai_human probably needs to keep track of current vehicle role and update it 
occasionally so it doesn't have to check it every update. 

ai_human needs code updates to handle firing
- if no primary maybe use a personal weapon if possible? 

while working in world_menu i realized that i have a whole fuel menu 
coded up that I never tested. 
- trigger by picking up a fuel can and then clicking on a vehicle 
- it needs work 

----------------------------------
April 19 2023
- added small_crate 
    - used for crate spawns of smaller objects 
- added a debug menu option to display collision circles 
- added a debug menu option to smooth_jitter
    - basically converts screen coords to a int. not sure it helps
- added collision radius to a couple items. probably doesn't matter  

small crate was a lazy chop in half of the regular crate 

noticed that most objects don't have a collision radius and are just 
using the default of 5. i think this value isn't used  a ton for things 
that bullets don't collide with at the moment 


explored some different options for rotating/resizing images but 
wasn't able to get anything else working. 
I found out that the current implementation is responsible for 
the corner clipping that i occasionally see 

----------------------------------
April 17 2023
- added debug info to the vehicle menu (turn on debug mode first)
- added a very simple name generator 
    - civilians are now polish for no reason 
- rewrote ai_human bot vehicle ai a bit 
- fixed a bug where vehicles would not move until you turn the steering wheel
    - this was amusingly working as theft protection against bots 


in the future civilian names could be chosen based on whether the map 
area is in germany/poland/soviet area/etc/etc

ai now has some ability to use vehicles again (its been awhile)
initial playtesting suggests that ai vehicle handling is worse than it used to be. 
the ai tends to circle with the vehicles. I think this is a function of the 
distance at which the ai would exit the vehicle being less than the vehicle's 
turning circle. either that or the ai vehicle maneuvring is just bad 

----------------------------------
April 07 2023
- more ai_human refactor 
- added back in food pickup 
- added back in medical pickup 
- updated grenade pickup code 
- updated antitank pickup code 
- rewrote ammo pickup code 
- added ammo top off option when ammo is low 
- finished container looting code 
- caught and added code to handle error situation
     where ai target is set to None but it is 
     trying to move towards it. need to fine 
     how it got into this state. 
- added gameplay_instructions

I had to look at ai_gun to do some ammo stuff and i'm not super 
happy with the state of things. I am leaning towards thinking that 
guns need to be overhauled and magazines need to actual wo_objects 

the ai soft cheats on ammo in that it can refill ammo by going to a 
squad mate or a ammo_can without actually removing any ammo from the object. 
this may be changed once ammo is simulated in more detail 

with the current engagement sizes and current gun code I don't think 
ammo consumption has been a huge deal except for pistols (which by design are low ammo)

-- 
playtesting 
watched an engagement. soviets were doing well for once. 

all of a sudden a bot said it was going to 'check that body' .. !!
I forgot that bodies are classified as object containers, so bots 
will loot bodies with the new code. its a bit alarming but i'll 
keep it in.

the civ bots especially are really enthusiastic looters because 
they don't tend to have anything better to do. this means a lot 
of containers will end up stripped if you don't get there first.
--

----------------------------------
April 05 2023
- working on adding ai code for container looting 
- adding some ai_want_[thing] parameter to help retain mind state 
- temporarily removed ai action to pickup food off ground 
- temporarily removed ai action to pickup medical off ground 
- centralized panic code and added more triggers 

!! note - code is unfinished and probably not working with this commit 

note that when the ai eats something the implication is that it 
is from inventory, but obj menu allows you to eat something from 
the world - therefore you get a warning text. this needs to be 
fixed probably by an overhaul of the menu system so you can 
eat an object from your inventory w/o dropping it first.

----------------------------------
March 28 2023
- bodies are integrated and used.
    - weapons will still drop 
    - everything else is in the body 'container'
- prone art is integrated but not used yet 
- fixed container inventory spawning (wrecks and bodies)

uncovered a selection order issue where bodies are 
covering anything you remove from them. need to make 
containers a lower priority than everything else. 

might just change remove to put the object in your inventory 
and add another menu option for drop 

bodies are kind of horrifying but they make the fights 
seem a lot more serious. pretty happy with the artwork. 
maybe a little big but .. shrugs.

now that you can actually see where people died its kinda 
crazy how many civies can get caught in the cross fire.

new brown civilian clothes look great. that yellow was 
awful.

asked alpaca about the russian/soviet question.
Q: In world war 2 were soldiers from the soviet union referred
 to as russians or soviets?
A: The Soviet Union was a multi-ethnic state, and its 
armed forces included both Russian and other nationalities.
So during World War II they would have been known 
collectively as "Soviet" rather than just “Russian”.


need to figure out what happens to the player object 
after the player picks a spawn type 

----------------------------------
March 25 2023
- added art for prone humans 
- added art for dead humans 
- civilian clothes got switched to a tan jumpsuit

not sure if ww2 russians should be referred to as soviet 
or russian. going to need to pick one as its getting confusing

----------------------------------
March 12 2023
- small rewrite of the crate code 
    - actual crate spawn now under spawn_object
- added german_drop_canister
    - modelled after a fallshirmjager parachute drop 
    supply canister 
- removed kubelwagen image from the inside of the 
warehouse building. it was confusing because you 
couldn't interact with it. 


I think the supply canister came out pretty good, although 
the spent parachute could use a rework. I think in the future 
I might make this a two stage object with the first stage 
being it coming down on the parachute 


----------------------------------
March 10 2023
-added 'take_action_*' functions to ai_human to 
combine code for common actions 
- rewrote logic around getting a gun 

the fail safes in think_move that prevent movement 
when the ai has personal enemies may be a mistake 
- might be preventing the ai from getting a gun or 
running away 
- added a print statement to check how often this 
happens 

in my play testing i found a mob of civilians 
following my kubelwagen around, no doubt intending 
to steal it. I wonder where they were all going..
they still can't drive (need to look into that)

I also remembered that firing from a vehicle 
needs to be re-implemented 

----------------------------------
March 06 2023
- redefining types of container 
    - renamed is_container to is_object_container
    - added world lists for liquid,ammo,object containers
- world.get_closest_ammo_source update 
    - now it is aware of ammo cans and prioritizes them
    - options are 1. ammo can, 2. team mate 
    - fall back choice is get_closest_gun 
    - building removed from choices 

need to add some ai code to inspect the object when 
it travels for getting ammo and treat if different 
if its a soldier/ammo can / gun / ??

realized the tactical ai is more screwed up than usual as 
i added some new world areas and it doesn't have enough 
squads to defend them all. I need to add in a concept of major/
minor victory location priority 

need to think more about ammo resupply mechanics 
- should ammo cans supply any ammo, or only a specific ammo 
- how do we keep track of what ammo is good for each gun 

- I need to remove the kubelwagen from the factory inside image 
    - it is confusing now that you can interact with kubelwagens 

----------------------------------
March 01 2023
- bumped up spacing on ammo dump grid spawn to try and fix sprites 
- added a couple new crate types to take advantage of the 
consumable rarity list
- adjusted crate spawning to use the new crate types 

noticed that the german mg ammo can looks clipped rotated in 
the grid spawn. i think this is the square edge of a rotated 
image overlapping another image. it seems like in this case 
the transparency does not work as expected and what is 
under the overlapping image blocks the other image. 

----------------------------------
Feb 27 2023
- cobbled together some code to spawn crates 
    near buildings. its not great 

crates needed for upcoming 'crate interaction' ai 

note - crates look super bad rotated. 
need to 1. check crate png dimensions 
2. make a right angle rotation code thingy. 

----------------------------------
Feb 17 2023
- added a civilian generator
    - basically random civilian squads for each building 
    - adds a civilian spawn point for each building 
- spawn_point is now spawn_points[]
- modified squad spawning to take into account multiple spawn points 
- had to write new code for the player spawn because i had accidentally 
    deleted something it used. now the player takes control of a random 
    bot of the faction of their choice. 

at the moment only default civilians are spawning, and 'american' 
is no longer a valid spawn option 

multiple spawnpoints is a big improvement for civilian spawning. 
it looks a lot better now 

now that fuel drums and cans are in-game i should modify 
vehicles to require fuel, and add a way to fuel them 

I should also add an AI goal to explore near by crates 

----------------------------------
Feb 11 2023
- a little code cleanup in world_builder 
- started working on loot tables
    - currently have common,rare,ultra rare for some categories 
- added a type for world_area 

starting to think about world_areas 
- there will probably be significant and less significant ones 

----------------------------------
Feb 04 2023
- turned the fuel drum spawn algo into a reusable grid sort function 
- created a math function to determine an optimal number of columns 
    for grid sorting 
- enabled grid spawning for towns 

amusingly I like the grid spawning for towns less than when it was random 
with a broken collision sorter. 

part of the issue is i have all of two models for the town at the moment, 
and that really stands out when they are uniformly spaced. 

Also need to add collision against other objects check for the grid spawning system.

----------------------------------
Jan 29 2023
- added 55 gallon (fuel) drum
- made some small changes to the building spawn code but its still terrible 
- added 'fuel dump' world area type 
    - has a neat little bit of code to order the fuel drums 

for now there is a fuel dump in the center of the map for testing. this will probably go away soon 
----------------------------------
Jan 11 2023
- updated squad spawning to make it more automatic 
- very minor changes to worldbuilder test world creation code 

----------------------------------
Jan 11 2023
- fixed some bugs in the new squad creation code 
- moved squad creation in the test world over to the new code (except for civilians)

play test hightlights 
- in the first meeting engagement german mg34s wiped out the entire russian squad with no losses 
- two germans were killed by civilians with ppks (this is fairly rare. they must have been hit by stray fire and returned fire)


I need to either come up with a unique name generator, or ditch the names. 
I think I like having names but i have no idea how to come up with unique names for infinite soldiers

----------------------------------
Jan 09 2023
- started adding some standardized squad definitions

----------------------------------
Jan 03 2023
- minor updates to install notes 
- found that the game works fine on pop!_os. added to install notes 

----------------------------------
Dec 24 2022
- minor update to world_area code to randomize timing of update code 
to spread out the cpu load of the updates 

looks like their may be issues with ai getting into vehicles now and 
i confirmed they can't seem to drive. I saw a kubelwagen with 5 
passengers but a civilian still drawn on top of it. 

----------------------------------
Dec 22 2022
- minor code reorg in world_builder 

----------------------------------
Dec 16 2022
- moved debug_info text queue to world class 
    - this follows my plan to keep the graphics class to JUST the graphics engine 
- added squad count to debug info 

----------------------------------
Dec 03 2022
- added notes on fedora 37 install 

----------------------------------
Nov 29 2022

- added a bit more data to the human menu when debug is on for troubleshooting 
- added an option to take an AT shot at a target if there is no primary weapon
 and if its a far engagement

was not able to trigger a panzerfaust shot by the AI. pretty sure the code is good 
but its a very specific set of circumstances that would result on it triggering 

a bit of play testing. need to look at whatever mechanism causes enemies to be 
forgotten do to bursts now. its fine for real enemies but personal enemies who 
are close by shouldn't be forgotten 

----------------------------------
Nov 16 2022
-  work on ai vehicle control code

need a way to assign roles in a vehicle (driver, gunner?, passenger?)

for now i think the human ai will still cheat and directly change vehicle rotation. 
will probably have to learn to steer in the future though 

----------------------------------
Nov 13 2022
- added enough control code that vehicles work for the player again 

vehicle control is back. everything works slightly different.
I think it is perhaps a bit better. now there is a concept of throttle vs brake 

no reverse yet

might be awhile before the ai can control vehicles. nut sure 
what happens currently if the ai gets in one. probably nothing

----------------------------------
Nov 12 2022
- moved speed and rotation_speed out of base world_object and into ai_* 
    where they are actually used 

----------------------------------
Nov 03 2022
- bug fixes with vehicle ingress/egress

----------------------------------
October 18 2022
more minor work on vehicle stuff

----------------------------------
October 18 2022
some work on vehicle stuff

----------------------------------
October 17 2022
- deleted ai_airplane. all vehicles will now use ai_vehicle
- removed most of the code from ai_vehicle. pending rewrite 

breaking change - vehicles will be broken until they are rewritten.

I'm going to go a different route with vehicle ai - something i've thought of before 
but never really attempted. basically I want vehicles to be dumb with no real logic 
other than possibly some physics code. 

human ai will have to interact with vehicles with the exact same interface the player does 
- by moving the throttle, wheel, etc 

----------------------------------
October 16 2022
- [tab] now closes whatever menu is open 
    if no menus are open it still opens a context menu for the player or vehicle 
- moved some logic from world_menu and graphics_2d_pygame into world. ideally graphics_2d_pygame 
    should have as little game logic as possible. same with world_menu to a lesser extent 
- increased time before bot takes over from player (AFK) to 3 minutes 
- decreased distance at which menu activates to 30 (pretty close)
- if you are too far away from an object you clicked on the bot will take 
    over and walk there. (this seems a bit buggy)
- added the ability to fuel vehicles if you are carrying a gas can. (very basic at the moment)

we probably need a different mouse selection radius for small objects and for large objects. 
currently the plane is very hard to select as you have to know the middle of the sprite.

i am wondering if vehicles and airplanes should share the same ai. otherwise there will be a 
lot of duplicate code. 
- to some degree i almost wonder if they could just use ai_human 

thinking that instead of a int for fuel amount, vehicles might be better with a 
liquid_container object to handle the math around adding and removing fuel.

the distance at which you can use a menu should be variable depending on what the object is 
- for example you can be further away from someone you are talking to compared to a 
object that you are picking up.


----------------------------------
October 12 2022
- the ai will now take over the player character if there is no input after awhile 

tha ai does not do anything particularily interesting as the player. 
this is probably because the players squad does not get orders.

----------------------------------
October 04 2022
- minor changes to world_menu 
- found that the health effects of consumables and medical were set incorrectly. fixed 
- added health effects to liquid_container 
- fixed bug where thirst rate not thirst was changed by eat/drink 

pro tip : don't drink gasoline. you will die 

----------------------------------
October 01 2022
- added a simple check to make sure the bot doesn't repeat speach 
- added drink option to liquid_container menu 
- added consumable menu with eat option 

you can now drink gas 

wine is currently a consumable - but maybe it should be a liquid container (wine_bottle instead?)

----------------------------------
September 29 2022
- added more dialog. eventually i want dialog to be a bit more 
random but this works for now 
- added method to support drinking liquid 

i think the new burst fire system has the unintended effect of 
removing personal enemies if the inital burst doesn't kill them. 
will have to think about that one. 

the speak system gets overwhelmed really quick. need to do something 
to speed it up when the queue gets too big (actually i think this is 
already implemented? hmm)

----------------------------------
September 21 2022
- finished initial work on liquid container menu 

----------------------------------
September 20 2022
- small changes to german_fuel_can spawn properties to fill out 
    some ai_liquid_container variables 
- working on a liquid_container menu 

once again reminded how much i hate the menu system 

----------------------------------
September 17 2022
- added a gun crate that has a random amount of one random type of gun 
    - more realistic than just a random mix of guns 

----------------------------------
September 14 2022
- added random gun crate
- minor code cleanup 

i would really like to have some sort of loot table with a level of 
rareness for each item (drop rate?)

I really need to teach the AI how to use crates 

----------------------------------
September 13 2022
- implemented a really basic burst fire system for the ai to 
    keep bots from just dumping all their ammo at one target

inital play test suggests the burst system works really well. 
lethality seems to be up as the target info resets after each burst 
allowing the ai to rethink and potentially choose a better target 

----------------------------------
September 12 2022
- minor changes to ai_gun 

----------------------------------
September 10 2022
- added max_distance to world.get_closest_object
    - this simplifies some code that would have otherwise re-checked distance 
    - also may reign in some of the crazier behavior where distance wasn't considered
- made chance of panic from no medical in think generic 1 in 25 instead of 1 in 5
    - this needs to be rethought in general as it is happening a lot
- added a chance to stop bleeding with a makeshift bandage (not requiring a medical object) 
- remove some unneeded debug messages 

a unintended consequence of the introduction of medical objects is that bots can no longer 
easily heal wounds and are very prone to panicking. this is compounded by medical objects being 
generally unavailable to pick up 

i should add a bullet spread modifier based on fatigue 

need some way to have the bots fire bursts - maybe shot counter and after 10 or so 
go to sleep mode and reset counter ?

----------------------------------
September 08 2022
- minor changes to vehicle information display
    - speed now shows correctly when in the kubelwagen 

----------------------------------
September 06 2022

- using a medical object stops bleeding now 

----------------------------------
September 05 2022
- added a bandage to the inventory of all soldier types 
- minor changes to medical item usage so that attributes are applied correctly 

noticed there is still a lot of out of range firing. i thought this was fixed 
but i guess not. 

watched a german soldier walk past a soviet soldier to pick up a wine bottle. 
the german picked up the wine bottle and then turned around and shot the soviet dead. 
the soviet never reacted. yup - the ai still needs a lot of work. 
 
 ---------------------------------
September 03 2022
- resized fuel can image which was not square (causes occasional crashes)
    - also modified the image a bit. still pretty bad though
- added art and basic object code for bandage and german officer medical kit 

---------------------------------
August 30 2022
- added scho-ka-kola (german caffeine chocolate)
- added schokakola and wine to the consumables list so it will show up in random loot 

initially meant for schokakola to be in the medical (stimulant) category,
but will probably just be a consumable 

schokakola art was goodish at 20x20 but rather poor at 10x10, however it is a smaller item 
so needed to be 10x10. may redo at some point but not a huge priority.

---------------------------------
August 25 2022
- added wine bottle art and wine object 

---------------------------------
August 22 2022
- added some effects to the consumable spawns
- added is_medical to the list of world_object attributes 
- added simple functions for eating and medical obj usage to ai_human
    - eating and medical are now different. among other things this 
    means that eating no longer has a strong health effect 

no medical objects at the moment although the engine supports them now. 

I will have to whip up some art for some stimulants, bandages, etc 

consumable effects are going to take some balancing. 
currently the cheese has quite a large hunger reduction compared to the other items 

currently hunger/thirst don't have any real effect. 
maybe extreme hunger will decrease health ??

---------------------------------
August 17 2022
- added hunger and thirst attributes to human ai 
- added hunger and thirst to human context menu 
- added some rounding to the human context menu 
- added new ai_consumable class to give food some unique attributes
- added random rotation to a handful of spawns that didn't have it
- disabled zoom in/zoom out debug messages 

some todo items 
- add specific attributes for food types 
- add food consumption code 
- add menu for food object interaction 

---------------------------------
August 15 2022
- added some handle_event error handling 
- new ai_liquid_container for gas/diesel/whatever cans 

---------------------------------
August 08 2022
- changed human menus to make it context sensitive based on whether you have
    the player, a squad mate, or a non squad mate selected. some menu options 
    have changed because of this. 
- squad members can now be asked to upgrade their gear 
    - among other things this will trigger civilans to pick up nearby guns 
    - at the moment this is fairly likely to happen automatically anyways if 
        the ai is bored. 
- found a huge bug in the ai engagement code where < was supposed to be > 
    - it was dropping personal enemies that are close, when it was supposed to be 
        dropping personal enemies that are far 
    - this might explain the long standing bug where the AI will occasionally fire 
    at out of range targets 
- added concept of very_near, near, and far enemies to squad enemy list 
- made some squad ai changes so it resets its virtual position and speed
    to match the squad lead on a regular interval  

---------------------------------
July 27 2022
- changed up ai_human idle options a bit so that they sometimes just sit around 
    - this will allow them to regain stamina and make the zip around less 

---------------------------------
July 14 2022
- added some speak triggers for ai_human 
    - they can now scream. because that is important
- added fatigue stat to human menu when debug is on 

the bots really need to be able to aim ahead of things that are moving. 
they dump silly  amounts of ammo at moving targets without hitting a thing 

I think the AI tends to get super fatigued because they almost never sit still 
- i need to add a idle mechanic where they stay in one place 

---------------------------------
July 02 2022
- made some changes to ai_vehicle and kubelwagen spawn code so that 
    the inventory showed up correctly 
- updated ai_airplane inventory code to match ai_vehicle (not that airplanes are very functional anyways)
- added control [tab] : activates context menu for player or vehicle if you are in one 

realized its a total pain to click on the vehicle you are currently in to bring up a context menu. 
If the menus are going to used to do more stuff than using tab to bring up the current menu is the way 
to go. i forget if i was saving tab for something else - maybe make your weapon safe?

messed around with the ju88 a bit. its hard to get into because the current mouse select has a fixed selection area.
i wonder if i will ever get around to making the plane more of a actual plane. currently its just a bad car 

---------------------------------
June 24 2022

- rewrote mouse selection algo to favor selecting objects over human/vehicle/storage 
    - this is a work around for when bigger objects cover up objects you want to pick up 

did some play testing. noted that for germans, the kar98k soldiers 
often had a kill, whereas the mp40 soldiers often had shot a ton of 
rounds without any kills. 

I think this suggests that the range calculation might be wrong for mp40s 
-- however - when i playtest it the 700 range seems to be dead on. hmmm. not 
    sure what is going on here.

---------------------------------
June 22 2022
- added remove inventory event to ai_human to handle special inventory handling 
- added a couple bits of error handling here and there 
- rewrote world_menu storage menu to use remove_inventory. 
    - for now objects will just be dropped on the ground 
- small changes to ai_vehicle add and remove inventory events 
- added inventory events to container ai 

storage menu is still a terrible hack. just a slightly better terrible hack.
I kind of like dropping items instead of auto transferring them to the player inventory

stuff dropped from the vehicle menu is covered up by the vehicle - needs an offset 

note - the bots are thieves. awful thieving thieves. 

---------------------------------
June 17 2022
- found that the fuel can in the kubelwagen also spawned in the world. fixed
- noticed that using the storage menu on yourself is pretty broken as it removes 
    inventory from yourself, and then adds it to yourself 

storage menu is generally broken. needs to be rewritten. 

probably need to add a event_inventory_removal to handle all the oddball 
special case inventory 

---------------------------------
June 09 2022
- added a fix so you can't accidentally click out of the start menu 
- added mouse select for ammo containers and liquid containers

---------------------------------
June 04 2022
- added jerry can to kubelwagen spawns 
- added 'is_large_human_pickup' to world_object 
    - these will be large awkard objects that you will only be able to carry one of
        - like a ammo can or gas can 
- added liquid_container and ammo_container classifiers 

---------------------------------
May 23 2022
- jerry can artwork
- jerry can placeholder code 

jerry can artwork sucks. needs to be redone 

---------------------------------
May 08 2022
- added calculated_speed for human ai 
    - based on fatigue level. cumulative effect 
turn on debug data to see your speed and fatigue 

---------------------------------
April 25 2022
- added fatigue system 

---------------------------------
April 16 2022
- added squad count to menu 
- added text identifying the player when you click on yourself 
- made it a little more likely that friendly ai will shoot back if the 
player shoots them 
- changed some misc squad functionality - hard to tell what all was affected 
- squad min/max will actually be applied now
- added a human_ai function to react to being asked to join a squad 
- removed min menu distance when debug mode is enabled 

Note that the menu option to ask bots to join your squad more or less 
works now. For now they have to be a member of your faction. They don't 
do a great job of following you but they will generally be around, and 
they may attack other bots that have shot you do to the squad enemies 
mechanism. This will probably get better in the future. 

---------------------------------
April 15 2022
- some small changes to world menu 
    - when you get a human menu it will say if the bot is in your squad 
- added a speak function to ai_human 
    only works if in earshot of the player 
- bumped up the max distance for a menu to appear a bit 

---------------------------------
April 09 2022
- some adjustment to min/max distance for civilian squad 
- added a minimum distance of 150 for the world menus to pop up 

---------------------------------
April 07 2022
- added squad min_distance and the ai_human code to handle it 

---------------------------------
April 06 2022
- some changes to ai_squad mostly around specific following distances for 
    certain modes 
- adjusted human_menu distance from squad to always show a value now 
    this used to be soldiers only (note you have to turn on debug mode)

realized that with the current human_ai the squad max_distance basically causes 
a rubber band effect where the ai will get out to the max distance and then close to 
whatever the set min is. I think I need a squad min_distance and also some more ai 
code to handle that. 
---------------------------------
April 02 2022
- some changes to squad ai so they will detect if the player is in or not 
    in the squad and activate the correct ai mode 
- fixed a new bug where ai_faction could crash if a squad hits zero members 
- increased grenade and panzerfaust speed

now that the squad ai follows around the player when they are in a squad there 
isn't much of a point to the new squad map pointers, so i'll have to use them for 
something else.

---------------------------------
March 30 2022
- rewrote the inital player spawn from the world_menu, shifting most of the 
    code to the faction and squad classes 
- fixed some squad behavior bugs that i introduced in the last update 
    squad behavior should be more or less how it was now 

---------------------------------
March 29 2022
- randomized squad enemy list refresh rate 
- added a 'ai think' function for squad 
- added 'add_to_squad' function that i really need to rewrite some of the spawning to use
- added some squad ai modes, only default and player work at the moment.

I think squad ai will evolve in a similar way as ai_human. 
The original idea for squad_ai was that it was dumb, it was only really a 
collection of human_ai that had a shared world_coordinate, but im starting to see 
the need for more logic in squad rather than just dumbly moving the world_coord 
towards a destination. 

didn't playtest / bug test this yet as it got too late in the evening
squads needs more work anyways 

---------------------------------
March 19 2022
- changed a lot about spawning at the beginning of the game
    - most noticeably the game is now running when you are in the start menu 
- added blue map pointer that points towards your squad world coords 
- added orange map pointer that points toward your squad destination 

the new map pointers don't work very well. I probably need to add map pointer 'modes' so they 
can have some update logic 

note the player starts out in a squad by themselves. when they die they will take over a random bot who 
is probably in a bigger squad.

thinking about adding squad modes to add some different behaviors 

---------------------------------
March 03 2022
-moved debug_mode bool from graphics_2d_pygame to world 
- made more text dependent on the debug_mode and made it False by default 
- renamed player to 'player' from 'klaus' to distinguish from the generic german_soldier name 
- fixed a bug with panzerfaust explosions that caused a crash due to a missing parameter 

thinking about making the human names more generic instead of having custom names 

---------------------------------
Feb 26 2022 v2
- fixed a crash/bug in ai_human.think_engage_far
- added min and max zoom at the engine limitations 
- added a description of the last collision to the human ai menu 
- added death descriptions to console output
    - this has been useful to get a better picture of the overall action 

i really need to come up with a name generator.

"Reginald Thimblebottom out of ammo for ppk Rounds fired 63"
I wonder what he was firing at. He would have had to get more ammo three times.
---------------------------------
Feb 26 2022
- update to world_menu to prevent player from accidentally clicking away from the death menu 
- added panzerfaust crate 
- expanded the area where the beginning item drops will spawn as they aren't really needed for testing anymore 
- fixed a world_menu bug where going into the storage remove menu would auto remove the first item 
- update to personal enemies - they will now only be engaged if they are within weapon range 
    - they will be forgotten if out of range. this will help keep the personal_enemies list from getting out of control 
    - also makes it less likely the civilians will follow you across the map to shoot you 
- some refactoring in ai_human. hard to tell the effect as the code is getting absurdly complicated
- made max distance from squad a squad variable so the squad can adjust it
    - default is 300, civilians will get 1000 so they don't move in a group as obviously
- added a couple catches to prevent the ai from going on long trips when they have personal enemies 
- added a smaller blood sprite for blood trails 
- added a ammo count to the human menu and a function to ai_weapon to return ammo count 
- added some logic to human_ai to prevent collisions on a already dead bot from counting as a kill 

while play testing i ran across a german bot with a mg34 who has 8 confirmed kills and 2 probables. 
That is the highest kill count that i've seen yet.

I'm noticing a lot of firing before getting into range. may have been a accidental consequence of 
todays code changes, or may have already been there. 

---------------------------------
Feb 23 2022
- squad creation changes 
    - added 'pistols' category 
    - added unarmed_humans to squads so they get a squad 
- moved the kubelwagen spawn from the debug menu so that it is next to the player instead of on top of the player 

I hadn't realized until now that unarmed and pistol armed bots were not getting assigned squads.
I thought units that didn't have a squad would have errored out by now. kinda interesting

honestly the squad behavior is not great for the civilians, i think I might have to add an option for them to 
ignore squads, or go rogue 
---------------------------------
Feb 03 2022
- fixed image scaling issue when bots die and drop objects 
- added some comments and function descriptions
- added a screen shot from a battle 
---------------------------------
Jan 27 2022
- created spawn_crate function with a couple preconfigured crate options
- started work on missons 

I came up with the idea of missions for the ai. Basically this is a list of lists. 
Each child list will be in this syntax ['action',target]
The missions will be done in sequential order and will take precendence over squad affinity.

This has the effect of creating a simple programming language for the ai.
For example after a big battle the world AI could spawn a civilian bot with the following mission list :
- pick up gun/equipment from battle area 
- move to a building 
- despawn (thus removing the items it grabbed from the world)


---------------------------------
Jan 13 2022
- some minor fixes to make the debug menu easier to open (~)
- added two panzerfausts to spawn west for fun. 

did some playtesting and saw a lot of soldiers taking shots while they were out of range. 
that will take some pondering as i thought that was more or less fixed and had been for some time. 

soldier awareness of surroundings still seems poor and firefights often seem one sided. 

I also need to think about a way to keep every soldier from firing at the same enemy. 
Theoretically this shouldn't be happening but maybe the personal enemy system is basically 
overriding normal enemy priority. 


---------------------------------
Jan 08 2022
- added a function to switch menus. found that i can basically re-use 
the container menu for other objects that have internal menus 
- vehicle storage menu enabled
- airplane storage menu enabled (had to add inventory)
- renamed container menu to storage menu
- bumped up random spawns in containers 
- added random spawn into vehicle inventory 

the whole world_menu class is a completely insane mess. I feel like it needs a total 
rewrite at some point. It also needs a code cleanup to meet the standards i am using elsewhere

i need a random loot adder thingy 

i'm still going back and forth as to whether every ai_* should have an inventory

---------------------------------
Dec 31 2021
- minor changes to world_builder
- added random consumable spawns to crates
- built out container menus so you can now list and remove objects 
- added a inventory list to human menu 
- updated german_mg_ammo_can to have AIContainer
---------------------------------
Dec 30 2021
- added turnip

---------------------------------
Dec 28 2021
- added potato

---------------------------------
Dec 26 2021
- added the airplane back into the mouse selection list. I'm not sure when it fell off the
list but its back now 
- minor refactoring/reorganizing

---------------------------------
Dec 03 2021
- moved the kubelwagen images into their own folder 
- started creating code to support turrets

did some play testing. AI definitely needs a short distance limit when 
deciding to pick up healing items 

---------------------------------
Nov 28 2021
- added in a chance to throw grenades back. this works automatically for the 
    player and the AI 
- added back in the ability to click on grenades with the mouse 
- rewrote some of the ai code around health to try and make the AI care more about self preservation

getting the grenade throw back mechanism working was WAY harder than I was expecting. 
I ended up having to change a lot about how grenade collision works. 

part of the issue is that collision checks are probably happening too often. this 
should be re-visited for grenades and bullets
---------------------------------
Nov 27 2021
- rewrote ai_human.think_generic to be more dynamic. 
    - it should now remove dead enemies from its list faster
    - consuming food no longer prevents the ai from taking other actions 

---------------------------------
Nov 22 2021
- added green apple, but its kinda too small. i guess it will be mostly in containers 

verified that AI can pickup and use panzerfaust

---------------------------------
Nov 20 2021
- added AI ability to pick up anti-tank 
- added AI ability to pick up guns when idle 
- minor text changes to external vehicle menu 
- rewrote ai close engagement code to handle not having a gun or being out of ammo 
- added ai ability to fire panzerfaust
- started adding support for melee weapons 

For the AI to both have a panzerfaust and be engaging a vehicle at >300 is going to be rare
I bet I will forget about adding the code to do this and then will get surprised

with the close combat ai I now see a need for melee weapons. I think melee is going to be automatic 
if you are close enough to a target. perhaps melee damage will have a dodge check 

this means the weapon slots are now as follows 
primary_weapon - machine gun/ assault rifle / submachine gun / pistol / rifle 
throwable - grenade
antitank - panzerfaust 
melee - in development ?

---------------------------------
Nov 19 2021
- added panzerfausts back to the list of things you can click on 
- grenades are now removed from inventory when you throw them, fixing the 
    bug where humans drop exploding grenades on death 

---------------------------------
Nov 18 2021
- changed select_with_mouse function to only use objects that are in renderlists (actually visible)

figured out the massive issue with mouse selection. it was looking at screen coords for objects that were 
off screen and therefore the screen coords were out of date 

noticed a civilian ai that seemed stuck trying to engage without a weapon - that seems to be a new bug 
---------------------------------
Nov 15 2021
- added 'spawn_container' which is really used to spawn static vehicle wrecks at the moment 
    so kinda not a great name - but vehicle wrecks are basically just containers 
- added vehicle_ai code so that it can die and spawn a static wreck when it does, it also 
    boots out any passengers 
- fixed a bug in the debug menu where debug text could be disabled but not re-enabled

I'm pretty happy with my low effort destroyed kubelwagen art in game. maybe i will make a more 
destroyed version and make this a 'weathered' skin instead 

currently the kubelwagen dies pretty fast - especially to multi part explosives like grenades and panzerfausts
eventually i will have it use the damage modeling that I had started to work on for bullet pass through 

---------------------------------
Nov 13 2021
- created kubelwagen_destroyed art 
- started working on a standardized container ai (vehicle wrecks will be containers)

verified that consumable eating ai works 
---------------------------------
Nov 11 2021
- gave human_ai the ability to eat consumables from inventory to gain health

was not able to find evidence that it is working, more play testing probably required 
might need to bump this action up over 10% health level that it is currently at
---------------------------------
Nov 10 2021
- more minor ai refactoring 

---------------------------------
Nov 08 2021
- more ai refactoring 

some changes this time , mostly removing some dead end behaviors and allowing other options to 
occur if the first option is not taken.

this opens up an opportunity for adding more idle activities later

---------------------------------
Nov 07 2021
- more ai refactoring

no behavior changes, just moving code around 

---------------------------------
Nov 06 2021
- refactored ai_human a bit to seperate out the grenade throw decision from the 
    gun engagement logic tree. This way grenades can be thrown if you don't have a gun 

starting to tackle a rewrite of ai_human as it had turned into a big cascading if/else statement that 
was getting increasingly difficult to manage.

I noticed that grenade kills result in inaccurate kill counts because multiple fragments can hit a 
dead object before it is removed (or at least i think that is what is happening)

at some point something changed with grenades and im seeing them appear to explode when a ai_human dies 
and they are auto-dropped - but only sometimes 

---------------------------------
Nov 01 2021
- added 'big_cheese' 
    unique civilian loadout. lots of cheese, mg34, 2x health 

---------------------------------
Oct 28 2021
- added inventory to ai_human 
- changed weapon adding code so that they are also added/removed from inventory
- changed add inventory event in ai_human to add unknown objects to the new inventory list 
    this removes previous code that would cause consumables to be eaten (giving health)
    for now this means no more healing until this function is added to the AI 
- changed ai_human death code so inventory items are dropped on death
- added new civilian with pistol spawn 

---------------------------------
Oct 27 2021
- started working on a civilian spawning method to enable different civilian equipement loadouts
---------------------------------
Oct 22 2021
- started tracking ownership for shrapnel so that bots can react to being hit by it better
    they now shoot back if they survive a grenade attack 
- added a wo_objects list and ui counter for civilians as they are kind of a faction now 
- added the ability to toggle the debug text readout from the debug menu as it was getting rather large 

I threw a grenade at a civilian and it didn't explode - i think they picked it up. 
that is a theoretically possible but probably very rare occurence that I have never 
seen before. the AI would have to be wanting to get a grenade, and able to pick it up 
before it explodes. If they threw it I think it would explode immediately. 

---------------------------------
Oct 13 2021
- made the game window a bit wider 
- added range stat for weapons
- changed human ai to use the new weapon ranges when deciding whether to fire or move closer to the target 
- cut the range of speeds for soldiers a bit. new range is 20-25 from 18-25 hopefully it will tighten up group movement 
- sped up squad from 18 to 25 so the squad center point will always be as fast as the fasted soldier
- slowed down fire rate of pistols and rifles. rifles especially needed to be nerfed
---------------------------------
Oct 12 2021
- adding airplane menu options (non functional at the moment)
- added confirmed kills (a hit that takes health down to <1)
- added probable kills ( a hit that takes health down to <10 but >0)
- added confirmed and probable kills stats to the menu text for humans 

I watched a group of 3 soviets that had picked up stg44s somewhere mow down about 8 germans 
in a running gun battle. I'm not sure what makes some bots so much more successful than others. 
the new kill stats may help track that a little. stg44s definitely help. They are one of the best 
weapons in the game at the moment (other than MGs)

The current human AI can lead to situations where one bot is 'closing with target' and the target 
just turns around (do they actually turn? not sure) and blasts them away with no return fire from 
the original bot. this has to do with the exact range at which close with target is satisfied vs 
what counts as ok for range in a new engagement.Need to find a way to make this more fuzzy and 
remove hard numbers from these decisions as it creates unnatural behavior 

i still get situations where bots seems to be stuck in a sleep mode. i think its a result of the rigid 
if/else waterfall that the current AI uses. need to make this code better deal with situations where the 
task end up wtih can't be accomplished otherwise they get stuck in a loop of trying the same thing over and 
over.

kind of frustrating but i think the human AI needs another full rewrite. relying on cascading if/else is too awkward and 
is getting harder and harder to add behaviors to 

---------------------------------
Oct 07 2021
- made some changes vehicle menu to split between internal/external menu based on 
    whether the player is in the vehicle or not 

---------------------------------
Oct 05 2021
- fixed a issue where player would be spawned twice. this affected american/german/russian starts 
probably for a long time, but only started affecting civilian spawns after civilian squads were setup.
this was causing a ton of weird bugs because there would be multiple instances of the player in the game 
- changed initial spawn for germans to west and russians to east.
- added north spawn for americans (not initialized previously)

I notice when i spawn in as american the count for americans is two - that will need looking into.
I'm guessing there is more doubling up going on in the code 

---------------------------------
September 27 2021
- moved the ai trigger for picking up a weapon to fix some edge cases with citizens who 
    start without a weapon 
- removed some of the console text print outs. going to keep this mostly for debug
    ingame text needs to use the onscreen system 
- added debug text for when the game tries to delete an object but its not in the master object list

confirmed that the weird mouse select bug that affects your characters after the first one dies still 
exists. interesting how it always selects a weapon when you click on the character 
---------------------------------
September 26 2021
- updated menu code so it is harder to accidentally close the death menu 
- rewrote the object selection code for mouse clicks to use the 
    newer circle collision. It was still using the mathematically wrong 
    box collision from earlier. This seems to have resolved some bugs
- removed zombie code. not needed or used anymore and not worth adding into the tactical AI system 
- added a faction!=None check to the ai_human collision event because some things that can shoot do 
    not have factions yet - like vehicles 

faction and squad code is becoming an issue. might need to rework so squad 
is optional or have the faction variable at the ai_human level. Also - do vehicles 
need squads or can the passengers just have the squad 

---------------------------------
September 23 2021
- modified the squad builder so it can handle unarmed humans 
- misc modifications required to get civilian squads working 
- fixed bug from yesterday with friendly fire check 
- made friendly fire check only for reporting to the squad so it doesn't 
    completely eliminate friendly fire 
- merged the human_ai code for civilians and soldiers together - there is no longer 
    a major distinction - will probably add back in some differences later 
- added some code to prevent a crash when a human dies and they are not in the 
    squad that they should be. need to debug this more 

---------------------------------
September 22 2021
- made bleeding more random 
- bleeding now causes blood spots to be generated 
- some small updates to make civilian squads functional 
- changed personal_enemies so that same faction objects aren't added
    this was to fix situations where a faction would wipe itself out due to 
    friendly fire 
---------------------------------
September 13 2021
- more work on gun and projectile variables 
- added more complex projectile pass through calculations based on projectile material 
- some changes to shrapnel clouds (grenades) and heat jet (panzerfaust) dispersion patterns 

---------------------------------
September 12 2021
- eating food (consumable) now stops bleeding
- more work on gun and projectile variables (not used yet)

---------------------------------
September 05 2021

- rewrote penetration_calculator to be a shared class from world instead of 
    importing it for every projectile 
- fixed the render range adjustment when zooming back in so that it works now 
- made it so you can't accidentally 'esc' or tilde out of the death menu 
- added bleeding 
- added bandage (b) option for player
---------------------------------
August 27 2021

- updated world.check_collision_bool 'CHECK_ALL' option to be humans+vehicles+buildings 
    this is in align with other collision code 
- updated panzerfaust code to do a CHECK_ALL collision check instead of CHECK_HUMANS so 
    it could theoretically actually hit a vehicle 
- disabled the center town for now as troubleshooting town combat is not the focus at the moment 
- created a new explosion pattern for the panzerfaust shaped charge that is in more of a line 
    than the starburst pattern used for grenades 
- fixed a text display bug with the death menu 
- added a couple different map pointer colors - to be used in the future 

I just noticed that spawning as something other than neutral will spawn you at the respective spawn point 
for that nation. that wasn't intentional - but it is a feature that I had planned on implementing anyways 

---------------------------------
August 24 2021

noticed that a soviet group hangs back in spawn and does not seem to get a squad objective 
this is because the soviets split into more groups and exhaust the squad objective 
assignment queue. 

- changed squad orders assignment to assign a random world_area if the objective 
queues are empty 


---------------------------------
August 23 2021

- reduced the random variation in bullet flight time slightly 
- moved bullet flight time variable to ai_gun (flight_time) - used to be a fixed 3.5
- bullet flight time changes 
    - old model = everything 3.5 seconds
    - new
        pistols : 1 second 
        submachine guns : 2 seconds 
        assault rifles : 2.5 seconds
        battle rifles : 3 seconds 
        machine guns : 3.5 seconds

Reducing bullet range was really necessary to reduce friendly fire, especially for the 
player who is limited to seeing what is on screen 

It was also really needed to provide more differentation between t he major weapon classes 

I witnessed a german mg gunner turn around and wipe out a whole german squad so team killing is still 
probably resulting in a fair amount of the combat deaths 

---------------------------------
August 22 2021

- more airplane related code 
- changed game text from blue to a red that i find easier to read
- added new vehicle text queue - only used by airplane at the moment 
- reduced the collision radius on the warehouse - i really just need to remove the warehouse
    non square objects do not work well with the current collision system 


noted that the ju88 moves faster than bullets 
bullets should probably have the speed of the thing they are in added to their 
speed when they start - will need to standardize how speed works between humans and vehicles first 

---------------------------------
August 21 2021

- started adding some code for airplane controls.

---------------------------------
August 12 2021
- started working on a death menu for when the player dies 
- added the option to respawn as one of the ai controlled bots on death 
- removed 'g' button action from the player when in vehicle as the vehicle 
    does not currently support throwing grenades 

---------------------------------
August 10 2021
- added view port scaling so everything that is more or less in the screen 
    is still rendered when you zoom out 

I was surprised to see a soldier driving a kubelwagen - i haven't seen 
this behavior recently and thought it had been squeezed out by some new behavior
limits in the AI code. The soldier may have been driving to town to re-stock ammo 
before driving back to my location and killing me. He stopped the car directly on 
me so a more fuzzy sense of arrival at destination is needed

---------------------------------
August 04 2021

- added scaling (zoom) with the '[' and ']' buttons

scaling took a lot of work to get right. the interaction between scaling 
and the screen space to world space transform was particularily tricky. 

one task left undone is fixing the rendering viewport. it needs to get 
bigger when scaling gets smaller and the opposite as well 

---------------------------------
August 02 2021

- added basic code to allow you to get into and control the ju88 
    - the code was just a copy of the vehicle code so it doesn't 
    'fly' or anything but its still kinda fun 
- gave the ju88 a mg34 for fun 

---------------------------------
July 28 2021

- added player world coords to the debug text on screen 
- added spawn locations to world. north/south/east/west/center 
- bumped squad speed from 10 to 18. solder speed is randomized from 18-25 at the moment 
    need to find a balance with squad speed. too slow and the squad almost never moves
    too fast and the soldiers cant keep up 
- slowed down civilians a little bit 

 Note that this update kills the fun map start where everyone is shooting at everything 
 Now the factions are starting on opposite ends of the map and it takes longer for them to 
 engage eachother 

 this will force me to take a look at fixing the ai_faction_tactical ai orders. 
 
 I did see a civilian drive a kubelwagen today so apparently in some instances that 
 does still trigger 

 the circle based collision is HORRIBLE for non square objects. This is especially 
 noticeable with building collision for the L shaped building. might remove this 
 building until a better collision option is available 

---------------------------------
July 22 2021

- changed some collision variables while debugging collision issues 
- realized that collisionSquare was implemented incorrectly. disabled 
    method and replaced it with a collisionCircle 
- messed with the building sorting a little but its still pretty far 
    from perfect - even now that we have good collision 

the new collisionCircle calculation is probably a good bit slower 
but it didn't seem to matter. i may look at more optimal options later 

The main thing this fixes is building collision for bullets - which was
 super messed up before.

---------------------------------
July 21 2021

- sort of added a 4th faction 'civilian' by adding a civilian tactical ai 
    by default I don't think the civilans will be squadded up - but it 
    allows the possibility of adding civilian squads in the future 
- added code to create a squad object for the player on game start 
    before this the player was not in a squad 
- squad ai now recognizes when the player is in the squad 
    - if player is in the squad then the squad follows the player instead 
    of trying to get to the squad destination 
- fixed a bug in world_menu where the menu options for human menu would never 
    work. 
- added a menu option to ask a human to join your squad. 
    - at the moment this doesn't do much that is useful. civilians don't 
        have the squad logic and solders don't seem to know what to do 
        because the squad won't necesarrily have the right enemies for them 

---------------------------------
July 16 2021

- code refactoring in world_builder to combine some functions 
- added panzerfaust to game 
    - this ended up taking a fair amount of code 
    - damage is like a grenade at the moment - this will change in the future 
        - will probably do contact damage not AOE in the future 
    - needs a smoke effect - but i do not have this yet 

note that 't' launches the panzerfaust 
---------------------------------
July 14 2021

- made some small tweaks to ai_human 
- bumped ai_squad speed up from 5 to 10 to make squad movement less start stop 
- some inital work on panzerfaust code 

forgot that the AI is coded not to pickup machine guns. 
the theory here is that the MGs are really crew served weapons and if 
anyone can pick one up it would be rather over powered. may change this 
in the future

sometimes the combat is great and sometimes the combat is terrible.
the biggest issue that im trying to fix is when a solider is calmy walking across 
the map seemingly unaware that a bunch of enemies are shooting streams of bullets at it 
this seems to be mostly an issue with how the squad hands out enemies

note that at the moment i haven't observed the AI taking cars anymore. 
I think civilians won't with their current rule set - but soldiers still 
should (maybe??) squad location may move to slow to trigger getting into a car 

---------------------------------
July 12 2021

- added distance from squad to the debug data that shows up when you click on a bot 
- adjusted civilian bored moved down from a random location up to 3000 away to up to
    1500 away. this puts it under the threshold where it will grab a car 
- decreased the speed that the squad position moves from 50 to 5
---------------------------------
July 09 2021 extras 

- added an ability for a soldier to add a personal enemy to the squad 
    enemy list, although it will only stay on there until the list refreshes (5 seconds)
- changed ai for ai_human to update destination coords periodically when trying to enter an object 
    this was an issue because vehicles move fast so sometimes bots would disappear by entering 
    vehicles that were no longer where they thought they were 
    - this will also mean the bot will have a hard time entering a moving vehicle 


---------------------------------
July 09 2021

- added 'enter object' routine to ai_human 
    - will be used for entering vehicles and maybe other things 
    in the future 
- added a distance check on 'moving' ai_state to see if 
    taking a vehicle would make more sense
    - this probably won't trigger often with the current AI setup
- rewrote the vehicle ai code so it can taking bots where they want 
    to go and droppign them off. 

the AI controlled vehicle code is pretty basic at the moment so a lot 
of funny stuff is happening. if i add vehicle collision its going to be 
really funny because they don't avoid anything. 

I probably need to restrict civilian vehicle access 

---------------------------------
July 06 2021

- added enough code to get the new map pointers working 

for now map pointers are toggleable from the debug menu (~)
- they are a green line that points in the direction of the 
    world areas (control points). currently these are clusters 
    of buildings. eventually more colors may be added to point 
    at other things 

---------------------------------
July 05 2021

- added new 'map pointer' object 
    - idea is it is a indicator pointing at a map feature like a town 

---------------------------------
July 03 2021

- fixed some incomplete variable inits in ai_gun 

---------------------------------
July 02 2021

- added art and basic code for new 'german mg ammo can' object 
    - based off of some pictures i found of german mg34 amo cans that 
    were designed to hold belts of 7.92 ammo 
- added the concept of 'container' which replaces 'crate' 

I'm playing around with the idea of adding a bunch of bullet parameters to 
ai_gun. the idea being these parameters will feed into a system to calculate 
penetration and damage eventually 

---------------------------------
June 29 2021

- added debug text to the menu for humans that shows ai_state and ai_goal
- bumped up range a which ai will re-engage a target
    - >850 == close with target 
    - <700 == engage 

distances that are used with the AI really need tweaking 
- need to figure out a good range for the guns 

---------------------------------
June 24 2021

- added a ai option for a soldier to pick up a grenade if they dont have one 
    - requires soldier to be in an idle state 
- added ai option to swap a pistol or rifle for a nearby submachine gun or assault rifle 
    - requires soldier to be in an idle state
    - required adding weapon types 
- swapped order of check enemies and check group proximit for solder ai to give a higher 
    priority to finding enemies 
    - hopefully resolving issue where soldiers walk past enemies 
- increased grenade speed a bit 


---------------------------------
June 22 2021

- added code so grenades are once again dropped on death 
- added ability for soldiers to throw grenades 
    - grenades can cause accidental team or self damage easily this may need 
    some tweaking but currently each soldier only gets one so it might not be
     that bad 
- ai_human now removes the object from the squad list on death 
    - this is more efficient then having the squad check health 
    - i didn't realize this wasn't done before now - may clear up some 
    AI oddities as the squad relies on the person at squad.members[0] for 
    some calculations 
- changed ai_gun so it isn't infinite ammo anymore 
    - however for the moment the bots can infinitely refill ammo from 
    their squad mates and other sources 
- added some more variables to track how many magazines you have for a gun 
    - will need to figure out some historical data for normal ammo loads 
    - current numbers are probably incorrect 
- added AI routine to replenish ammo from the closest ammo source 
    - currently this is nearby squad members or a building 
- updated mosin nagant magazine capacity from 2 to the correct 5 


weapon and ai changes over the last couple weeks have really upped the 
lethality of the game world. team damage is becoming enough of a problem 
that I will probably have to do something about it. 

Ammo is no longer unlimited but when the AI runs out it can replenish 
from a squad mate so it is still basically unlimited - there is just 
a short walk involved. This will probably change in the future 

The only way for the player to replenish ammo at the moment is to 
pickup a different weapon. this will change in the future

---------------------------------
June 19 2021

- hunting for uneven sized images to fix the occasional image rotation error 
    - fixed one of the cheeses that was 19x20
- removed inventory from world_object - it was creating duplication issues 
    - makes more sense for the AI class to handle this 
- gave the kubelwagen a mg34 because i realized it basically supports it 
    for player use with only a couple small tweaks 



---------------------------------
June 18 2021 - part 2

- minor misc code cleanup 
- implemented a function in world to return a random object 
- used the new function to change the gun spawn that can occur from get_closest_gun 
    to spawn the gun in a random building instead of just in a random location 
- changed up inital spawns a bit - eventually some of the clutter spawns will be handled by 
    world_ai 
- ai rewrite to introduce the concept of 'personal_enemies'
    - this is a list of personal enemies that the bot has made 
        - currently the bots add someone to the list if they get shot by them 
    - rewrite also focused on making code more common between civilians and soldiers 

This was one of my more interesting updates. 
'personal_enemies' and the new AI decision trees add a lot of interesting depth to 
the AI actions. 

For example if you shoot (but not kill) a civilian they will add you to their 
personal_enemies list and try to kill you. However first they will need a gun 
- and I find that they often die to cross fire before they find a gun and 
come back to kill you 

This also makes the soldier combat a bit better as they are slightly less likely 
to just sit there and get shot 

It is also possible that soldiers on the same side could end up targeting eachother 
if they get hit by friendly fire -  not sure if i will add a check for this or not 

---------------------------------
June 18 2021

- modified ai_human so updates happen on a else from 
    the death check - hopefully resolving an occasional 
    issue where bots would manage to fire a bullet after they disappear (die)
- made vehicles invulnerable for now 
    - will revisit this later when i think more about vehicle damage modeling 
- changed grenade so it stops collision checks after an initial collision 
    - this was to prevent it colliding with the same thing a ton of times 
        - other option would be to use ignore lists but the grenade only lasts 
        a second or so before exploding so this was fine 
- added AI behavior where getting hit by a grenade causes the AI to move in a 
    random direction. unfortunately they do not move fast enough to avoid the 
    grenade blast - but its a nice thought.
    - after some play testing I updated this behavior to be triggered by any 
        collision - making it kind of a stun lock. advantage to the AI is 
        it may cause dodging in flight projectile streams  
- added a little randomness to bullet flight time to make the dirt piles 
    left behind when bullets run out of flight time a little more random 
- accidentally changed grenade fragment lifetime randomness. so now its different 
- updated shrapnel so it is using copy.copy (bug i found a couple days ago in projectile)
- updated world_area creation to use copy.copy for world coords (probably didn't matter)
im not keeping up with the 'last_modified' string on the files at all. 
this was helpful to keep track of on small projects but is a bother on more active projects 

collision seems to have a bias to the right side. 
this suggests either i have a +/- flipped or the math is just wrong 
- if you fire from the left of the house the dirt will pile up mid house 
- if you fire from the right of the house the dirt piles up right of the house by a good bit 

---------------------------------
June 17 2021

- play testing to make sure fixes from yesterday worked 
- removed some un-needed debug messages 

---------------------------------
June 16 2021

- reorganized world_builder to put brass and blood_splatter under a spawn_sprite function
    sprite was a term from my old directx days that referred to a 2d effect 
- added a new dirt sprite 
- added event handling to building ai 
- added dirt spawn on collision event to buildings 
- added dirt spawn on bullet flight time expiration 
- changed bullet collision behavior so if it gets a pass through on an object 
    the object gets added to its ignore_list so it can't hit it again 
    - had to revert this because it causes invulnerabilitiy. idk why 

my change where i added pass through objects to the ignore list created an odd 
situation where the AI could no longer hit eachother after a certain point. 
I cannot figure out why this is happening 

two theories 
1. python 'in' operator cannot tell different objects of the same class apart 
    - this seems possible but if true i think bullets would not work at all 
    - 'in' is used heavily in collision detection as we use ignore lists to 
    keep friendly fire down 
2. something goofy with variable scope where somehow the ignore list is being shared 
    across multiple bullets - or it is getting reset when it shouldn't be 
    - i haven't been able to prove this yet 
The most interesting part of this is the bullets from the player are not effected at all 

After a lot more troubleshooting i changed the ignore list on ai_projectile to be a copy.copy 
- this seems to have resolved the issue - but more testing is needed. 

what this would indicate is that when i was appending objects to the ignore list I was 
possibly accidentally adding items to the squad list - which the ignore list may have 
accidentally been a pointer to 


- changed ai_projectile by adding an else so a bullet couldn't be removed for 
    timing out AND later be removed for hitting something (not sure what would happen)

- added human health to the menu that pops up when you click on a human to help with debug 

---------------------------------
June 14 2021

- changed bullet collision so it now checks vehicles and buildings in addition to humans 
- added a passthrough check that gives a chance for a bullet to pass through an object 

bullet collision changes mean that now being in a building will have decreased lethality 
because the building will block a percentage of the bullets 
- does not currently affect grenades 
- early testinng indicates that building collision may be messed up. the results are odd 

bullet pass through on humans will increase lethality against humans in the open 
- for now the percentage is low as lethality in the open is already super high 

i think there is a need for an effect to show passthrough when it happens 
- also need some sort of effect for when a bullet is stopped by something 
    - maybe similar to the blood spot only dust or something and make it temporary ? 

as a unintended side effect you can now kill vehicles as they process collision events like humans 

---------------------------------
June 13 2021

- updated image for shrapnel
- upped shrapnel speed and lowered lifetime to compensate 
- made panzerfaust projectile image 
- added more soldiers to the initial test spawn to keep things interesting 

thinking about collision/penetration for projectiles
- buildings may get a 50% chance to block bullets to make humans inside buildings harder to hit 
- a similar mechanic may be needed for going prone (need to add prone art and AI options )
    - may NOT add prone so i don't have to do the additional artwork 

---------------------------------
June 08 2021

- more db code 
- rewrote enter/exit vehicle from world_menu to fix teleporting
    - also changed vehicle update so that it updates passenger locations to 
        match the vehicle location. this may prevent some future issues with 
        squad AI 

played around with building sorting a bit but it is still hilariously terrible. 
I wish I could remember exactly how I've done this before - probably requires 
some actual thought. the current implementation was about 2 minutes of work 
I do think the placements it ends up with look nice - but the buildings overlap 
more than is acceptable 

---------------------------------
June 05 2021

- started working on sqlite integration for 
    save/load 

---------------------------------
June 03 2021

- small tweak to kubelwagen turn rate to make it not 
    extremely annoying 
- added ejected brass. initial tests suggest that it doesn't 
    have a performance impact so there seems to be no need 
    to have the objects expire 

git diff --stat
 change_log.txt               | 12 ++++++++++++
 code/ai/ai_gun.py            |  3 +++
 code/engine/world_builder.py | 14 +++++++++++++-
 3 files changed, 28 insertions(+), 1 deletion(-)
 
---------------------------------
June 02 2021

- added debug test to display what faction controls each 
    world_area 
- added support code for buildings so they can be more easily 
    interacted with.
- finally giving ai_faction_tactical some love. this class will 
     use squad destinations to move troops around the map to 
     attack/defend/reinforce world_areas 

pretty soon here we are going to get into a situation where all the 
action is going to be taking place around world_areas that are not near 
the initial spawn point. 
this is a bigger challenge for this game because it is 2d, so the field of view 
area is TINY. you basically have to get lucky to see anything happen 

part of a work around for this is battles really need to be slower 
to do this we need to implement cover mechanics and change the AI 
so they aren't just holding down the trigger all the time. 

ammo limits and an AI that understands them is also needed 

git diff --stat
 change_log.txt                    | 23 +++++++++++++
 code/ai/ai_faction_tactical.py    | 68 +++++++++++++++++++++++++++++++++++----
 code/engine/graphics_2d_pygame.py |  4 +++
 code/engine/world.py              | 12 ++++---
 code/engine/world_area.py         |  5 ++-
 code/engine/world_builder.py      | 15 ++++++---
 code/engine/world_object.py       |  1 +
 7 files changed, 112 insertions(+), 16 deletions(-)

---------------------------------
June 01 2021

- updated building ai so that it does the inside/outside 
    check immediately so they don't all change 5 seconds in 
- fixed zombie image rotation 
- gave civilian player spawn option a ppk and grenade becaues 
    starting unarmed is annoying 


---------------------------------
May 31 2021

- added a new building 'square_building'
- adde a poorly written sorting algo so that the building spawns 
    aren't all just clumped on top of eachother 
- fixed building spawn in world_menu 
- adjusted collision_radius on several objects 
- gave the player character image a black shirt and a bare head 
    to differentiate from NPCs

man my 2d art is .. awful. 
if this project ever takes off I will need to pay for some artwork

---------------------------------
May 28 2021

summary 
- more work on world_area system 
- rewrite of the graphics_2d rendering code 
- blurred the bullet graphic. looks a lot better now 

For whatever reason drawing 4-5 of the warehouses on screen was causing a severe 10 fps drop 
I'm honestly not sure what about this png is causing so much trouble.

I did some profiling and found out that the get_rotated_image was one of the 
highest time usage methods. This was getting called every render cycle for every object 
that was visible. It got the current image and rotated it.

To resolve this I did a rewrite of the rendering system. Now the rotated image is stored in 
the world_object. When the world_object changes its rotation it updates a bool to let 
graphics_engine know that a new image has to be generated. 

The new code has significantly speed up and smoothed out the game 

---------------------------------
May 26-27 2021

summary 
- started working on 'world_area' system - which are strategic points on a 
    map that the AI will seek to control 

Some thoughts on world_area types 
- exit_zone : possibly the 4 sides of the map. not sure if this will be a world_area or not 
- town : small clump of buildings 
- field_depot : supply dump / mechanical area 
- train_depot : 
- airport 

---------------------------------
May 24 2021

summary 
- added ability to exit vehicles. this was harder and 
    more ugly than initially expected. gotta rethink this code 
    at some point when vehicle stuff is more hashed out 


---------------------------------
May 22-23 2021

summary
- work on vehicle ai 
- worked on adding math for movement when all you have is a speed and angle (for human vehicle control)
- removed a lot of the debug print code as it was really getting excessive
- fixed kubelwagen png so it is now square - this was causing visual issuses and possibly crashes
- fixed warehouse png dimensions
- bumped up bullet speed a little. the idea is to make it hard to dodge but not impossible 


kubelwagen is now driveable - however you can't get out at the moment

movement in the kubel really shows the graphic jitter issue when you drive past things 
- i think this is related to the world coords -> screen coords translation. I'll need to look into it 

the guns/bullets/health in this game are a balance between realism and playability. 
the bullets need to be somewhat dodgeable and hits need to be somewhat survivable to keep 
this playable at all - otherwise everyone would be mowed down by the mg34 soldier in the first 
couple seconds (can happen anyways :D )

---------------------------------
May 21 2021

summary 
- started working on vehicle ai 

this may take awhile. its probably going to be patterned 
after human AI but i have do new movement code for player control. 

AI control will probably be the same movement as humans, but maybe 
need a concept of acceleration/deceleration 

---------------------------------
May 20 2021

summary 
- added a basic human menu (not much in it yet)
- adjusted several distance limits in ai_man 
    - seems to fix some of the worst behavior
- renamed ai_man to ai_human (for the ladies!)
- added a couple lines to ai_squad that basically kills squad movement if
    enemies are close. 
- added distance calculations to a couple menus to help judge relative distance 
    for fine tuning AI 
- added a generic 'get closest object' to world that the AI can use 
- added routines for the AI to get consumables (medical) or run away when hurt 


---------------------------------
May 17 2021

summary 
- bug fixes/code cleanup
- realized that you could no longer pickup grenades or cheese 
    - added two wo_object lists to cover these categories and added mouse select code 

The new squad generation system is up and running 
old system : you spawn a pre-defined squad (8 rifleman, 1 mg, 1 smg, etc )
new system : you create soldiers and then the code builds squads based on the solder type and availability 

the reason behind this is i want to eventually have a database that is keeping track of individual soldiers
i don't want to track squads so that will be generated 

---------------------------------
May 15 2021

summary 
- added spawn_soldier function to world_builder 
    - basically spawns a human + equipement in their inventory 

starting a rewrite of the squad system. I want the game to 
track individual humans and dynamically squad them when they are 
spawned. need some sort of template system for squads 

world_builder is getting absolutely massive. I may break 
some stuff off into a new file but i need to think of a 
way to break it off that makes sense 


---------------------------------
May 13 2021
- some debugging/playtesting. minor 

---------------------------------
May 11 2021

summary 
- added ppsh43 (35 round mag)
    - changed soviet player spawn to use ppsh43
    - changed soviet squad squad lead to ppsh43 from pistol 
- some bug fixes 
- moved mouse object select function to world.py as it will be 
    using object lists so that you can't accidentally select blood spots 
- started adding in basic code needed for future vehicle support


---------------------------------
May 10 2021

summary 
- realized i had a mosin nagant in game already and updated 
    the russian rifle squads to use only russian weapons 
- added a basic start menu where you can pick a faction 
    - civilians start without a weapon - usually you can find one pretty easily 
- if the player is killed it sends out a ring of frags 
    i did not intend this to happen, i think it must be a grenade in the 
    inventory being dropped (which sets it off?)
- created a known_issues.txt file. not sure if i will use it or not 
- increased bullet speed again. not sure how fast i want to get.
     they are still dodgeable at the moment 

the start menu is super low effort - it just uses the same code that in-game context 
menus use. that is fine for now 

---------------------------------
May 07 2021

summary 
- added bullet spread in an attempt to reduce lethality 
    - may have made bots more dangerous
- added a second russian team 
- made player german for now to test combat -- need to make a game entry point/menu 
- added a bool in 'world' that pauses the game 
    - may be used for a future entry point menu 

next big need seems to be a start menu for the game 

there is no reaction when the player dies - something needs to happen there 

---------------------------------
May 06 2021

summary 
- added a russian rifle squad so i could start bug testing combat ai 
- made a lot of changes to soldier ai but im still not happy with it 
- added code to make inventory drop when someone dies 

combat ai was super bad when i started work today. now its just bad
I fixed a lot of bugs and cut the wait on ai think down from a max of 5 to a max of 2.
I think the whole thing kind of needs a rewrite 

---------------------------------
May 05 2021

summary 
- testing random stuff after all the changes 
- some bug fixing 
- took civilians off of zombie AI. 
    -civilian ai needs to be fleshed out more. they will grab guns but don't 
    have the AI targeting code 
- soldiers have a odd AI behavior where they walk in a line sometimes.
    - might just have something to do with how the movement code works 

if you want a gun you have to grab one quick before the civilians scoop them up 
- currently if there are no guns and a bot wants one the game will spawn one 
    - if you watch for this you can grab it first 

I thought i had unique player art but apparently its the same as german_soldier. odd 
- will have to fix this in the future 

this update will probably get merged into master as it has no game breaking bugs (afaik)
---------------------------------
May 03 2021

summary 
- fixed most of the bugs/logic errors/syntax errors in the new code 

the AI is already behaving in ways that does not make sense to me at first glance 
so i think i am getting close to feature parity with my old 3d game that this is based on 

starting to rethink the recently implemented squad spawning. Instead of spawning pre-determined squads 
i think maybe the system will keep track of individual humans and sort them into squad sizes when 
spawned in map. this makes the main unit to keep track of in the future database the human (and vehicles i suppose)

that way i can keep track of stats 

note that the new 'civilians' are currently using zombie AI - i need to change that.
civilians get the soldier AI minus the ability to belong to a squad and to attack things

at the moment civilians don't get a faction and are therefore not targeted or noticed by the AI 

---------------------------------
April 30 2021

summary 
- more work on tactical ai code 

thinking about maps 
- need points of interest that should be attacked/defended for objectives 
- need to make more buildings and ground clutter 
- need building group generation code 
- in general i need code to procedurally generate maps with building clusters and points of interest 

soldier AI could use a 'engaging while moving' 

civilians do not currently have the ability to shoot things 
- may change this in the future 

---------------------------------
April 28 2021

summary 
- hacking together more ai code 
- added world lists for german/soviet/american factions 
- added squad mechanisms to update the squad position and near enemy list 
    - this may more or less complete squad ai 


the number of lists im keeping track of keeps growing 
     but - its an effective way of keeping searches fast 

Im at the point where i need to figure out if the americans and soviets
    are on the same side or not. of course they were in ww2 - but the 
    game is set in the late war and is only roughly historical. having 
    america and the soviets fight would be more interesting

---------------------------------
April 27 2021

summary
- renamed ai_group to ai_squad to better represent what it is 
    - initially thought civilians would use this as well but i think it 
        will be soldiers only 
- some work on ai_squad 
- world_builder squad spawning code 


---------------------------------
April 26 2021

summary 
- more work on the ai_man code 
- reworked world_builder code to return the object 
    - also added a bool as to whether it should be spawned in the world or not 
    - this was needed as prep for spawning soldiers with equipment pre-equipped 

did some reading on german squad Structure
- trying to figure out if i want to keep track of every man, or 
    every squad or what 
- i need to read up on soviet organization as well - i am less familiar 
    with it 


---------------------------------
April 23 2021

summary
-a bit more work on the ai system. 
- added get_closest_gun to world
    - required maintaining a gun list 
not functioning or tested atm 

---------------------------------
April 22 2021

working on the main ai state system for ai_man 
- quite a bit more work to do here. not functional at the moment 

---------------------------------
April 21 2021

summary 
- added weapons : mg34, kar98k, mosin nagant
- added a human civilian object 
    - just uses zombie AI at the moment. civilian AI coming 
- reorg of some code 

had a crash on the rotate image call in graphics_engine 
- first time this happened and it did not repeat
- possibly to do with a random starting rotation value being wrong?

---------------------------------
April 20 2021

thinking about AI. 
I think I will reimplement the main ai concept from 
my previous game where soldiers are in a group and basically just 
follow around the groups central location. the group itself then 
makes the decisions as far as where to go, etc 

the group gets marching orders from the faction tactical ai 

Factions 
- german : major faction, in the decline 
- russian : major faction, power is on the rise 
- america : major faction - starts as maybe two small isolated areas 
- civilian : true neutral 
- partisian : opposed to all major factions, poorly equipped 

General AI Structure 
ai_faction_strategic : strategic map decision (think axis and allies)
ai_faction_tactical : tactical map decision 
ai_group : unit (squad) ai 
ai_man : individual human ai 

---------------------------------
April 19 2021

summary 
- organized the images folder with some sub folders as the amount of 
    art continues to grow 
- minor change to menus to have them display the object name 
- added 4 different german cheese 'rations' - it gives you a massive health boost. just like in real life 

I want to add more small objects although the scale of the game would 
make them too tiny to see. the compromise is to make them slightly too large 

Overall scale in this game is kind of fuzzy 
---------------------------------
April 18 2021

summary 
- created ju88 art and added it as a static model 
- small tweaks to grenades and overall damage model
- tweaked fire rates for all guns 
- added dp28 and stg44
- added a run away behavior to zombies when < 50 health 
- also added health regen to zombies when < 50 health 
- added 'civilian man' art 

will probably build out state machine ai for civilian man soon. 
also need to add more random 'clutter' objects 

---------------------------------
April 15 2021

added grenades. this was more work than i initially thought

pick up grenade like a gun and then throw with 'g'

grenades collision detect in flight and will stop and 'bounce back' a bit 
if they hit something. If they explode to close you may get hurt 

when grenades explode they throw shrapnel. this has random 
trajectories but it ended up being more or less a circle around it 
-- idk why it isn't more random 

summary 
- created quick art for a german mod 24 stick grenade, and shrapnel
- shrapnel spawn code - basically the same as a projectile for now 
- grenade ai. combo of projectile code and weapon code 
- added a generic menu because i don't want to code a menu for every stupid thing 
- slowed down zombies so you have more time to experiment with them 

---------------------------------
April 13 2021

summary 
- added object code and spawns for a couple more weapons
- added rotation and changed spawn locations for weapons a bit for variety 
- added code to drop your current weapon if you pickup a new one 
- added code so that gun ai actually gets updates when equipped which fixed a timing bug with firing 

---------------------------------
April 11 2021

summary 
- added collision checking for projectiles 
- added collision handling for humanoids
- added blood splatter as a visual indication that you hit something 

ai_projectile
- added a max flight time so bullets despawn after awhile 
- ai.update now checks collision

ai_zombie 
- elimated class and moved the code to ai_man 

ai_man 
- added collision event handler
- added health. collision with projectile removes health 
- health<1 means the object is removed.. for now  

world 
- added a new object collection for humans 
    - part of keeping collision lists as small as possible 
- added a collision checker class 

general/misc
- lots of misc code cleanup to make things easier to use 

now that I can optionally draw collision circles I would say that collision appears to work pretty great.


---------------------------------
April 10 2021

graphics_2d_pygame
- added new 'debug_text_queue' with fps and other stats 
    - always on for now, but will probably toggle from the debug menu in the future
- added a bool to toggle drawing collision circles (very helpful for debug)

ai_man, ai_gun, ai_projectile, math_2d
- added a ton of code to support projectiles 
- the gun can now fire!! ( pick up gun then press f)

misc thoughts
- need to add expiration for projectiles and think about speed and other values 
- need to add collision for bullets and see what the performance impact is
---------------------------------
April 05 2021

ai_man 
- added logic to auto equip a weapon if one is picked up 
- should weapon just be a reference to something in the inventory, or should i 
    actually remove the weapon from inventory when it is equipped ?

removed 'time_passed' as a parameter from a bunch of functions. 
- passing it from function to function in long chains was getting ridiculous
- easier/cleaner to just reference it directly when needed from graphics_2d_pygame

graphics_2d_pygame
- added in max_fps value (pygame will limit to this max). set to 40 for now 
- added in line in update method to print fps - disabled for now 
    - game currently stays at about max until zombie count gets over several hundred 


---------------------------------
April 02 2021

thinking about guns and gun mags but haven't reached any conclusions 
on how to handle it yet. 
- i think i want to abstract mags, they would be too small to be 
    easily visible on the world map 
- one possibility is to have bandoleers/satchels/etc that dictate how many mags 
    you have 
- i kinda think that i want mags to be tossed on the ground when you reload 
    - and make them non-retrievable (as mags aren't modeled as their own objects)

need to think about whether the player needs their own AI class 
    - thinking it would make more sense to combine it with a ai_man class 
        - that way player could easily jump in and out of bots
    - decision was to go through with combining. 

- some work on building out functions for ai_gun and ai_man

---------------------------------
March 28 2021
- implemented image lists so object can animate/change appearance 
    - need to come up with standard image orders 
        - for example a human object would have the following  [standing,walking,shooting,dead]
        - a chest may have [closed,open]

- made some horrid art for a warehouse to use the new image system 
    - inside 
    - outside 

- implemented a warehouse object that utilizes the new image lists to show 
    a outside and inside view depending how close the player is. 
    this is kind of hacky for now. distance from the object doesn't work well with a 
    rectangular object as you just have to use a radius

- rethought render levels and added a couple levels 
        # render level kind of a 'z' layer
        # 0 - ground cover
        # 1 - man made ground cover (cement, building insides)
        # 2 - objects laying on the ground (weapons,etc)
        # 3 - objects walking on the ground (humans, animals, vehicles)
        # 4 - objects above ground (birds, planes, clouds, etc)


i suppose the object AI could just switch the image name instead of having a list and changing the index 
    but by having a list I can keep all the image names in world_builder so they are easy to swap out. 
    this keeps the AI code more reusable 
---------------------------------
March 25 2021
- fixed gun object so it is using ai_gun instead of ai_player

-----------------------------------------------------
March 24 2021
- fixing a lot of bugs introduced in the last couple updates

-----------------------------------------------------
March 22 2021
- realized there was no strong need for child classes from WorldObject and 
    rewrote code to just spawn WorldObject objects directly
    - under this design any code that makes the world_object unique will be in the AI sub class 
    - deleted wo_crate, wo_player, wo_vehicle, etc 
    - object creation code continues to be centralized in world_builder 

note 
- need to create a debug utility to dump a txt file with object details for every object in the world 

-----------------------------------------------------
March 17 2021
- thinking about inventory and weapons systems. started fleshing 
    out inventory functions in world_object 
    - added basic item pickup to gun menu 
-----------------------------------------------------
March 16 2021
- collapsed wo_zombie, wo_player, and wo_man all into wo_man and made
    world_builder the object constructor
    - I wasn't sure passing in a imported class as a variable would work but it did 
- 

-----------------------------------------------------
March 10 2021
- added some bools to world_object to identify whether something is a vehicle, player, or gun 
    these are the three main things you can interact with at the moment 
    long term this may not be a great system 
- worked on object menus for guns/crates/vehicles

-----------------------------------------------------
March 09 2021
- created vehicle class for kubelwagen

-----------------------------------------------------
March 08 2021
- crate object stuff 
    - some code cleanup in wo_crate to make it a usable object 
    - added wo_crate to world_builder
    - added spawn option to debug menu ( hit ~) 
    - i initially accidentally set the crate coords to a reference of the player , 
        resulting in the crate following me around
- kubelwagen 
    - started adding some base code for the kubelwagen as 
        implementing some rudimentary vehicles is on the near term 
        to do list 

graphics note 
- rendering seems to be better when im on my laptop and not hooked into my
    external 4k. rendering on the 4k monitor seems to have a slight chop or jitter

- the crate looks like vinyl flooring. maybe thats where i got the texture from 

-----------------------------------------------------
March 02 2021
- more work on world_menu (lots to do here)
    - added world_menu text_queue to display via graphics_2d_pygame 
    - implemented debug menu (~) 
    - fixed some logic errors
- disabled zombie spawning on start. you can now spawn them from the debug menu 

thoughts 
- graphics_2d_pygame could use a bit of a rewrite to make it cleaner and more isolated
    ideally it should be easy to replace with another graphics library
- desire to implement my cat intensifies 
-----------------------------------------------------
Feb 27 2021
- added a new to me 'islice' in graphics_2d_pygame to display the first three lines from the text queue 
- created a new zombie object to serve as a good test object 
    - quick zombie art 
    - moved speed randomization code to the init of the wo_zombie world object 
    - speed for other objects should probably be declared in init as well 
- repurposing world_builder as a static generator that will be used to generate ALL world objects 
    - can be referenced from any object, static file not a class, no state 
- added zombie and zombie horde generators to world_builder 

-----------------------------------------------------
Feb 03 2021
- added code to graphics_2d_game to push number key events to world_menu 
    for ingame menu usage 
- started on some world_menu code - got stuck on how this is being displayed
    probably need another text queue -- but do i really want all of these to be 
    stored in the graphics_2d_pygame class? maybe i need a text object game object 

- thought - why is world menu in the world class at all? 
    - I guess it needs to be somewhere 
-----------------------------------------------------
Jan 10 2021
- created crate.png art 
- code for crate image load 
- wo_crate object  

-----------------------------------------------------
December 29 2020
- moved project over to windows from mac
- minor code cleanup in graphics_2d_pygame.py 

-----------------------------------------------------
November 29 2020
- moved graphics_2d_pygame object creation into world class to solve clean up the init ordering
- moved init for world pointer in graphics_2d_game into the init function where it should logically be 
- created a class for the world_menu that will be used to interact with objects


-----------------------------------------------------
November 03 2020
- added a text queue and some basic text handling

-----------------------------------------------------
October 26 2020
- made a couple small changes to wo_gun so it could be added to the test world 

# issue notes
- hit box seems bad - at least when determining what is under the mouse cursor.
    it seems way to the left

-----------------------------------------------------
October 14 2020
- moved the world building stuff to a new world_builder file

-----------------------------------------------------
October 06 2020
- added another list to world class to track which objects can be collided with 
    this is useful to differentiate between objects that are just particles
- added a basic collision square function to math_2d 
- added selection of objects in the screen space with the mouse to graphics_2d_pygame 
    this is there instead of math_2d because its more specific to the graphics engine
    and specificaly the render lists and screen space coords 

-----------------------------------------------------
September 22 2020
- removed un-needed functions to add/remove objects in graphics_2d_pygame 
- started puzzling through map loading. not sure what code file will handle that yet
    - may not be a responsibility of 'world' class 
-----------------------------------------------------
September 14 2020
- created some place holder art for weapons and various soldier uniforms
-----------------------------------------------------
September 08 2020
- started fleshing out a gun object and gun_mag object 
    - started with a mp40 as per tradition
- added inventory to the base world_object class 
- fixed a confusing logic error in wo_man and wo_player where i wasn't triggering init of the 
    base class. it confuses me why this wasn't breaking anything. very odd
- some code formatting cleanup
-----------------------------------------------------
September 07 2020
- added in simple movement for the player 
- confirmed that ai zombie rotation code seems to work great
- confirmed that world coord to screen coord translation seems to work great 
- added in 'move to target' math
- tested engine with 500 'bob' zombies - everything was still fast
-----------------------------------------------------
September 06 2020

- blew off the dust on this project .. again :D 
- started working on the input handling - trying to keep it in
graphics_2d_pygame as much as possible.

-----------------------------------------------------
April 12 2020

- blew off the dust on this project 
- started moving pygame stuff from twe.py and world.py to graphics_2d_pygame.py 

-----------------------------------------------------
June 18 2016

- added image rotation
-the correct image orientation is apparently forward is 'up'
- confirmed that world transforms are behaving correctly.
- remember on screen coordinate y starts at zero and gets bigger as
it goes down
-----------------------------------------------------
June 18 2016

-created project
-worked on coordinate system and world->screen transforms
-moved to using tuples for coordinates from a dedicated class for simplicity
may change in the future.
-created man.png
-created kubelwagen.png
-----------------------------------------------------
